try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="cb78f267-a173-42f4-a712-e40386c07f5e",e._sentryDebugIdIdentifier="sentry-dbid-cb78f267-a173-42f4-a712-e40386c07f5e")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[12421],{18065:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ts});var i=a(80263),s=a(32981),n=a(72112),r=a(88712),l=a(97507),o=a(76196),d=a(53239),c=a(87494),u=a(73969),m=a(22891),p=a(37873),h=a(41273),x=a(86541),g=a(86549),f=a(16294),y=a(67850),v=a(24523),j=a(30659);async function b(e,t){let{projectRef:a}=e;if(!a)throw Error("Project ref is required");let{data:i,error:s}=await (0,v.Jt)("/platform/projects/{ref}/disk/custom-config",{params:{path:{ref:a}},signal:t});return s&&(0,v.H4)(s),i}let S=function(e){let{projectRef:t}=e,{enabled:a=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.I)({queryKey:j.n.diskAutoscaleConfig(t),queryFn:e=>{let{signal:a}=e;return b({projectRef:t},a)},enabled:a&&void 0!==t,...i})};var N=a(51355),w=a(80210);async function z(e){let{projectRef:t,growthPercent:a,maxSizeGb:i,minIncrementGb:s}=e;if(!t)throw Error("projectRef is required");let{data:n,error:r}=await (0,v.bE)("/platform/projects/{ref}/disk/custom-config",{params:{path:{ref:t}},body:{growth_percent:a,max_size_gb:i,min_increment_gb:s}});return r&&(0,v.H4)(r),n}let P=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,N.jE)();return(0,w.n)({mutationFn:e=>z(e),async onSuccess(t,a,s){let{projectRef:n}=a;await i.invalidateQueries({queryKey:j.n.diskAutoscaleConfig(n)}),await (null==e?void 0:e(t,a,s))},async onError(e,a,i){void 0===t?u.oR.error("Failed to update disk autoscale config: ".concat(e.message)):t(e,a,i)},...a})};async function _(e,t){let{projectRef:a}=e;if(!a)throw Error("Project ref is required");let{data:i,error:s}=await (0,v.Jt)("/platform/projects/{ref}/disk/util",{params:{path:{ref:a}},signal:t});return s&&(0,v.H4)(s),i}let k=function(e){let{projectRef:t}=e,{enabled:a=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.I)({queryKey:j.n.diskUtilization(t),queryFn:e=>{let{signal:a}=e;return _({projectRef:t},a)},enabled:a&&void 0!==t,...i})};var I=a(37115),D=a(63351),T=a(31805),M=a(78937),C=a(55139),V=a(49510),A=a(80090),O=a(84512),R=a(9620),F=a(85039),G=a(65887),B=a(75878),L=a(66755),E=a(80100),q=a(99779),Z=a(44725),Y=a(21650);let U=e=>{let{formState:t}=e;return(0,i.jsx)(r.N,{mode:"wait","data-sentry-element":"AnimatePresence","data-sentry-component":"FormFooterChangeBadge","data-sentry-source-file":"FormFooterChangeBadge.tsx",children:Object.keys(t.dirtyFields).length>0&&(0,i.jsx)(l.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2},children:(0,i.jsx)(l.P.div,{animate:{scale:[1,1.05,1],transition:{duration:.3}},children:(0,i.jsx)(Y.E,{variant:"default",children:(0,i.jsx)(l.P.span,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.1},className:"text-sm",children:1===Object.keys(t.dirtyFields).length?"1 change to review":"".concat(Object.keys(t.dirtyFields).length," changes to review")},Object.keys(t.dirtyFields).length)})})})})};var H=a(10663),X=a(63324),W=a(40029),$=a(28667);let J=H.Ik({storageType:H.k5(["io2","gp3"]).describe("Type of storage: io2 or gp3"),totalSize:H.ai().int("Value must be an integer").describe("Allocated disk size in GB"),provisionedIOPS:H.ai().describe("Provisioned IOPS for storage type"),throughput:H.ai().optional().describe("Throughput in MB/s for gp3"),computeSize:H.Ie(e=>!0).describe("Compute size"),growthPercent:H.ai().int("Value must be an integer").min(10,"Growth percent must be at least 10%").max(100,"Growth percent cannot exceed 100%").optional().nullable(),minIncrementGb:H.ai().int("Value must be an integer").min(1,"Minimum increment must be at least 1 GB").max(200,"Minimum increment cannot exceed 200 GB").optional().nullable(),maxSizeGb:H.ai().int("Value must be an integer").max(6e4,"Maximum size cannot exceed 60TB").optional().nullable()});var Q=a(49697),K=a(95137),ee=a(60793);let et=e=>{let{visible:t,title:a,description:s}=e;return(0,i.jsx)(r.N,{"data-sentry-element":"AnimatePresence","data-sentry-component":"DiskMangementRestartRequiredSection","data-sentry-source-file":"DiskManagementRestartRequiredSection.tsx",children:t&&(0,i.jsx)(l.P.div,{initial:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.15},className:"w-full",children:(0,i.jsxs)(K.OO,{className:"bg-surface-100 text-sm text-foreground-light flex items-center gap-4 relative w-full rounded-md border-spacing-0 border",children:[(0,i.jsx)("div",{className:"w-12 h-12",children:(0,i.jsxs)("div",{className:"relative w-10 h-10 m-1 bg-alternative text-foreground border rounded-full flex items-center justify-center",children:[(0,i.jsx)(Q.A,{strokeWidth:1}),(0,i.jsx)(ee.id,{className:"absolute -right-1.5 -top-1.5"})]})}),(0,i.jsxs)("div",{className:"flex flex-col gap-0 flex-grow",children:[(0,i.jsx)("p",{className:"text-sm text-foreground",children:a}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:s})]})]})})})};var ea=a(23729),ei=a(6436),es=a(78511),en=a(20033),er=a(30404);let el=e=>{let{beforePrice:t,afterPrice:a,show:s,tooltip:n,className:d,free:c}=e;return(0,i.jsx)(r.N,{"data-sentry-element":"AnimatePresence","data-sentry-component":"BillingChangeBadge","data-sentry-source-file":"BillingChangeBadge.tsx",children:void 0!==t&&void 0!==a&&s&&(0,i.jsx)(l.P.div,{initial:{opacity:0,x:-4,height:0},animate:{opacity:1,x:0,height:"auto"},exit:{opacity:0,x:-4,height:0},transition:{type:"spring",stiffness:800,damping:40,duration:.3},children:(0,i.jsx)(Y.E,{variant:"default",className:(0,E.cn)(c?"bg-violet-200 border-violet-900 text-violet-1100":"bg-alternative","bg-opacity-100 text-warning",d),children:(0,i.jsxs)(er.m_,{children:[(0,i.jsx)(er.k$,{asChild:!0,children:(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)("span",{className:"text-xs font-mono text-foreground-muted",translate:"no",children:(0,ei.vv)(t)}),(0,i.jsx)(o.A,{size:12,strokeWidth:2,className:"text-foreground-muted"}),(0,i.jsx)(l.P.span,{className:(0,E.cn)(c?"text-violet-1100":"text-foreground","text-xs font-mono"),animate:{scale:[1,1.1,1]},transition:{duration:.12},translate:"no",children:"".concat((0,ei.vv)(a),"/month")},a)]})}),void 0!==n&&(0,i.jsx)(er.ZI,{side:"bottom",children:n})]})})})})};var eo=a(22223),ed=a(67203),ec=a(22830),eu=a(48555);let em={timeRemaining:{label:"timeRemaining",color:"hsl(var(--warning-default))"},hand:{label:"hand",color:"hsl(var(--warning-default))"}},ep=e=>{let{progress:t}=e;return(0,i.jsxs)("div",{className:"relative w-12 h-12","data-sentry-component":"CountdownTimerRadial","data-sentry-source-file":"CountdownTimerRadial.tsx",children:[(0,i.jsx)(eu.at,{config:em,className:"absolute w-12 h-12","data-sentry-element":"ChartContainer","data-sentry-source-file":"CountdownTimerRadial.tsx",children:(0,i.jsxs)(eo.D,{data:[{timeRemaining:100,fill:"var(--color-timeRemaining)"}],startAngle:90,endAngle:90-360*t/100,innerRadius:21,outerRadius:14,"data-sentry-element":"RadialBarChart","data-sentry-source-file":"CountdownTimerRadial.tsx",children:[(0,i.jsx)(ed.z,{gridType:"circle",radialLines:!1,stroke:"none",className:"first:fill-foreground-muted/50 last:fill-background-200",polarRadius:[16,11],"data-sentry-element":"PolarGrid","data-sentry-source-file":"CountdownTimerRadial.tsx"}),(0,i.jsx)(ec.Z,{dataKey:"timeRemaining",cornerRadius:2,"data-sentry-element":"RadialBar","data-sentry-source-file":"CountdownTimerRadial.tsx"})]})}),(0,i.jsx)(eu.at,{config:em,className:"absolute top-1 left-1 w-10 h-10","data-sentry-element":"ChartContainer","data-sentry-source-file":"CountdownTimerRadial.tsx",children:(0,i.jsx)(eo.D,{data:[{hand:100,fill:"var(--color-hand)"}],startAngle:80-360*t/100,endAngle:140-360*t/100,innerRadius:14,outerRadius:5,"data-sentry-element":"RadialBarChart","data-sentry-source-file":"CountdownTimerRadial.tsx",children:(0,i.jsx)(ec.Z,{dataKey:"hand",cornerRadius:2,isAnimationActive:!0,"data-sentry-element":"RadialBar","data-sentry-source-file":"CountdownTimerRadial.tsx"})})})]})},eh=e=>{let{visible:t}=e,[a,s]=(0,d.useState)(100),[n,o]=(0,d.useState)(!1),[c,u]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{let e=()=>{o(!0),s(100);let t=setInterval(()=>{s(a=>a<=0?(clearInterval(t),u(!0),setTimeout(()=>{u(!1),s(100),e()},300),0):a-1)},100);return()=>clearInterval(t)},t=setTimeout(e,1e3);return()=>clearTimeout(t)},[]),(0,i.jsx)(r.N,{"data-sentry-element":"AnimatePresence","data-sentry-component":"DiskMangementCoolDownSection","data-sentry-source-file":"DiskManagementCoolDownSection.tsx",children:t&&(0,i.jsx)(l.P.div,{initial:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.15},className:"w-full",children:(0,i.jsxs)(K.OO,{className:"bg-surface-100 text-sm text-foreground-light flex items-center gap-4 relative w-full border rounded-md",children:[(0,i.jsx)("div",{className:"w-12 h-12",children:(0,i.jsx)(r.N,{children:n&&(0,i.jsx)(l.P.div,{initial:{scale:.8,opacity:0,y:-8},animate:{scale:c?1.2:1,opacity:1,y:c?-8:0},exit:{scale:.8,opacity:0,y:-8},transition:{duration:c?.3:.8,type:"spring",bounce:.6},children:(0,i.jsx)(ep,{progress:a})},"countdown-timer")})}),(0,i.jsxs)("div",{className:"flex flex-col gap-0 flex-grow",children:[(0,i.jsx)("p",{className:"text-sm text-foreground",children:"For 6 hours you will not be able to change any disk attributes."}),(0,i.jsx)("p",{className:"text-sm text-foreground-light",children:"There is a cooldown period enforced for any disk attribute modifications"})]})]})})})},ex=()=>(0,i.jsxs)(es.Hj,{"data-sentry-element":"TableRow","data-sentry-component":"TableHeaderRow","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,i.jsx)(es.nd,{className:"w-[140px] pl-5","data-sentry-element":"TableHead","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Disk attribute"}),(0,i.jsx)(es.nd,{className:"text-right","data-sentry-element":"TableHead","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"-"}),(0,i.jsx)(es.nd,{className:"w-[100px]","data-sentry-element":"TableHead","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Unit"}),(0,i.jsx)(es.nd,{className:"text-right pr-5","data-sentry-element":"TableHead","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Price Change"})]}),eg=e=>{let{attribute:t,defaultValue:a,newValue:s,unit:n,beforePrice:r,afterPrice:l,hidePrice:d=!1,priceTooltip:c,upgradeIncluded:u=!1}=e;return(0,i.jsxs)(es.Hj,{"data-sentry-element":"TableRow","data-sentry-component":"TableDataRow","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,i.jsx)(es.nA,{className:"pl-5","data-sentry-element":"TableCell","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:(0,i.jsx)("div",{className:"flex flex-row gap-2 items-center",children:(0,i.jsx)("span",{children:t})})}),(0,i.jsx)(es.nA,{className:"text-right font-mono","data-sentry-element":"TableCell","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:a!==s?(0,i.jsx)(Y.E,{variant:"default",className:"bg-alternative bg-opacity-100",children:(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[(0,i.jsx)("span",{className:"text-xs font-mono text-foreground-muted",children:a.toString()}),(0,i.jsx)(o.A,{size:12,strokeWidth:2,className:"text-foreground-muted"}),(0,i.jsx)("span",{className:"text-xs font-mono text-foreground",children:s.toString()})]})}):(0,i.jsxs)("span",{className:"text-xs font-mono",children:[(0,i.jsx)("span",{className:"text-foreground-muted"}),a]})}),(0,i.jsx)(es.nA,{className:"text-xs font-mono","data-sentry-element":"TableCell","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:n}),(0,i.jsx)(es.nA,{className:"text-right pr-5","data-sentry-element":"TableCell","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:!u&&d?(0,i.jsx)("span",{className:"text-xs font-mono",children:"-"}):r!==l||u?(0,i.jsx)(el,{show:!0,beforePrice:r,afterPrice:l,tooltip:c,free:u}):(0,i.jsx)("span",{className:"text-xs font-mono",translate:"no",children:(0,ei.vv)(r)})})]})},ef=e=>{var t,a,s,r,l,o,c,u,m,p,h,x,g,f,y,v,j,b,S,N,w,z,P,_,k,I,D,T,C,V,F,G,B,L,E,Z,Y,U,H,X,J,Q,ei,er;let{isDialogOpen:el,setIsDialogOpen:eo,disabled:ed,form:ec,numReplicas:eu,loading:em,onSubmit:ep,message:ef,buttonSize:ey="medium"}=e,{data:ev}=(0,R.YA)(),{data:ej}=(0,O.s)(),eb=(0,R.br)(),{formState:eS,getValues:eN}=ec,{can:ew}=(0,A.Qp)(n.aG.UPDATE,"projects",{resource:{project_id:null==ev?void 0:ev.id}}),{data:ez}=(0,M.Q)({projectRef:null==ev?void 0:ev.ref}),eP=null!=(F=null==ej?void 0:ej.plan.id)?F:"free",e_=!!Object.keys(ec.formState.dirtyFields).length,ek="Price change includes primary database and ".concat(eu," replica").concat(eu>1?"s":""),eI=(0,d.useMemo)(()=>{var e;return null!=(e=null==ez?void 0:ez.available_addons)?e:[]},[ez]),eD=(0,d.useMemo)(()=>(0,W.$C)(eI,null==ev?void 0:ev.cloud_provider),[eI,null==ev?void 0:ev.cloud_provider]),eT=(0,W.Uk)({availableOptions:eD,oldComputeSize:(null==(t=ec.formState.defaultValues)?void 0:t.computeSize)||"ci_micro",newComputeSize:ec.getValues("computeSize"),plan:null!=(G=null==ej?void 0:ej.plan.id)?G:"free"}),eM=(0,W.WC)({planId:eP,oldSize:(null==(a=eS.defaultValues)?void 0:a.totalSize)||0,oldStorageType:null==(s=eS.defaultValues)?void 0:s.storageType,newSize:eN("totalSize"),newStorageType:eN("storageType"),numReplicas:eu}),eC=(0,W.t5)({oldStorageType:null==(r=ec.formState.defaultValues)?void 0:r.storageType,oldProvisionedIOPS:(null==(l=ec.formState.defaultValues)?void 0:l.provisionedIOPS)||0,newStorageType:ec.getValues("storageType"),newProvisionedIOPS:ec.getValues("provisionedIOPS"),numReplicas:eu}),eV=(0,W.ou)({storageType:ec.getValues("storageType"),newThroughput:ec.getValues("throughput")||0,oldThroughput:(null==(o=ec.formState.defaultValues)?void 0:o.throughput)||0,numReplicas:eu}),eA=(null==(c=ec.formState.defaultValues)?void 0:c.computeSize)!==ec.getValues("computeSize"),eO=!eb&&(null==(u=ec.formState.defaultValues)?void 0:u.totalSize)!==ec.getValues("totalSize"),eR=!eb&&(null==(m=ec.formState.defaultValues)?void 0:m.storageType)!==ec.getValues("storageType"),eF=!eb&&(null==(p=ec.formState.defaultValues)?void 0:p.throughput)!==ec.getValues("throughput"),eG=!eb&&(null==(h=ec.formState.defaultValues)?void 0:h.provisionedIOPS)!==ec.getValues("provisionedIOPS"),eB=!eb&&(null==(x=ec.formState.defaultValues)?void 0:x.growthPercent)!==ec.getValues("growthPercent"),eL=!eb&&(null==(g=ec.formState.defaultValues)?void 0:g.minIncrementGb)!==ec.getValues("minIncrementGb"),eE=!eb&&(null==(f=ec.formState.defaultValues)?void 0:f.maxSizeGb)!==ec.getValues("maxSizeGb"),eq=eG||eF&&"gp3"===ec.getValues("storageType")||eO;return(0,i.jsxs)(K.lG,{open:el,onOpenChange:eo,"data-sentry-element":"Dialog","data-sentry-component":"DiskManagementReviewAndSubmitDialog","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,i.jsx)(K.zM,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:(0,i.jsx)(ea.G,{size:ey,htmlType:"submit",type:"primary",onClick:async e=>{e.preventDefault(),await ec.trigger()&&eo(!0)},disabled:ed||!e_,tooltip:{content:{side:"bottom",text:ew?ed?"Current form values are invalid":void 0:"You need additional permissions to update disk configuration"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Review changes"})}),(0,i.jsxs)(K.Cf,{className:"min-w-[620px]","data-sentry-element":"DialogContent","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,i.jsxs)(K.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,i.jsx)(K.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Review changes"}),(0,i.jsx)(K.rr,{"data-sentry-element":"DialogDescription","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Changes will be applied shortly once confirmed."})]}),(0,i.jsx)(K.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx"}),(eA||eq)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex flex-col gap-2 p-5",children:[(0,i.jsx)(et,{visible:eA,title:"Resizing your Compute will trigger a project restart",description:"Project will restart automatically on confirmation."}),(0,i.jsx)(eh,{visible:eq})]}),(0,i.jsx)(K.pf,{})]}),(0,i.jsxs)(es.XI,{"data-sentry-element":"Table","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,i.jsx)(es.A0,{className:"font-mono uppercase text-xs [&_th]:h-auto [&_th]:pb-2 [&_th]:pt-4","data-sentry-element":"TableHeader","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:(0,i.jsx)(ex,{"data-sentry-element":"TableHeaderRow","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx"})}),(0,i.jsxs)(es.BF,{className:"[&_td]:py-0 [&_tr]:h-[50px] [&_tr]:border-dotted","data-sentry-element":"TableBody","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[eA&&(0,i.jsx)(eg,{attribute:"Compute size",defaultValue:(0,W.ku)(null!=(B=null==(y=ec.formState.defaultValues)?void 0:y.computeSize)?B:"ci_nano"),newValue:(0,W.ku)(ec.getValues("computeSize")),unit:"-",beforePrice:Number(eT.oldPrice),afterPrice:Number(eT.newPrice),upgradeIncluded:(null==ej?void 0:ej.plan.id)!=="free"&&(null==ev?void 0:ev.infra_compute_size)==="nano"&&"ci_micro"===ec.getValues("computeSize")}),eR&&(0,i.jsx)(eg,{hidePrice:!0,attribute:"Storage Type",defaultValue:null!=(L=null==(v=ec.formState.defaultValues)?void 0:v.storageType)?L:"",newValue:ec.getValues("storageType"),unit:"-",beforePrice:0,afterPrice:0}),(eG||eR)&&(0,i.jsx)(eg,{attribute:"IOPS",defaultValue:null!=(E=null==(b=ec.formState.defaultValues)||null==(j=b.provisionedIOPS)?void 0:j.toLocaleString())?E:0,newValue:null==(S=ec.getValues("provisionedIOPS"))?void 0:S.toLocaleString(),unit:"IOPS",beforePrice:Number(eC.oldPrice),afterPrice:Number(eC.newPrice),priceTooltip:eu>0?ek:void 0}),"gp3"===ec.getValues("storageType")&&eF&&(0,i.jsx)(eg,{attribute:"Throughput",defaultValue:null!=(Z=null==(w=ec.formState.defaultValues)||null==(N=w.throughput)?void 0:N.toLocaleString())?Z:0,newValue:null!=(Y=null==(z=ec.getValues("throughput"))?void 0:z.toLocaleString())?Y:0,unit:"MB/s",beforePrice:Number(eV.oldPrice),afterPrice:Number(eV.newPrice),priceTooltip:eu>0?ek:void 0}),(eO||eR)&&(0,i.jsx)(eg,{attribute:"Disk size",defaultValue:null!=(U=null==(_=ec.formState.defaultValues)||null==(P=_.totalSize)?void 0:P.toLocaleString())?U:0,newValue:null==(k=ec.getValues("totalSize"))?void 0:k.toLocaleString(),unit:"GB",beforePrice:Number(eM.oldPrice),afterPrice:Number(eM.newPrice),priceTooltip:eu>0?ek:void 0}),eB&&(0,i.jsx)(eg,{attribute:"Growth percent",defaultValue:null!=(H=null==(I=ec.formState.defaultValues)?void 0:I.growthPercent)?H:$.SZ.growthPercent,newValue:null!=(X=ec.getValues("growthPercent"))?X:$.SZ.growthPercent,unit:"%",beforePrice:0,afterPrice:0}),eL&&(0,i.jsx)(eg,{attribute:"Min increment",defaultValue:null!=(J=null==(D=ec.formState.defaultValues)?void 0:D.minIncrementGb)?J:$.SZ.minIncrementSize,newValue:null!=(Q=ec.getValues("minIncrementGb"))?Q:$.SZ.minIncrementSize,unit:"GB",beforePrice:0,afterPrice:0}),eE&&(0,i.jsx)(eg,{attribute:"Max disk size",defaultValue:null!=(ei=null==(C=ec.formState.defaultValues)||null==(T=C.maxSizeGb)?void 0:T.toLocaleString())?ei:$.SZ.maxSizeGb,newValue:null!=(er=null==(V=ec.getValues("maxSizeGb"))?void 0:V.toLocaleString())?er:$.SZ.maxSizeGb,unit:"GB",beforePrice:0,afterPrice:0})]})]}),eu>0&&(0,i.jsx)("div",{className:"border-t px-4 py-2 text-sm text-foreground-lighter",children:ek}),(0,i.jsxs)(K.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,i.jsx)(q.$,{block:!0,size:"large",type:"default",onClick:()=>eo(!1),"data-sentry-element":"Button","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Cancel"}),(0,i.jsx)(q.$,{block:!0,type:"warning",size:"large",htmlType:"submit",loading:em,onClick:async()=>{await ep(ec.getValues())},"data-sentry-element":"Button","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Confirm changes"})]}),ef&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(K.pf,{}),(0,i.jsx)(K.OO,{children:(0,i.jsxs)(en.Fc,{variant:"error"===ef.type?"destructive":"default",className:"",children:[(0,i.jsx)(ee.id,{}),(0,i.jsx)(en.XL,{children:ef.message})]})})]})]})]})};var ey=a(27371),ev=a(73640),ej=a(44053);let eb=function(e){let{message:t="error",type:a,children:s}=e;return(0,i.jsx)(r.N,{"data-sentry-element":"AnimatePresence","data-sentry-component":"FormMessage","data-sentry-source-file":"FormMessage.tsx",children:t&&(0,i.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:(0,i.jsx)(Z.Z,{type:"error"===a?"destructive":"default",className:"mt-2",title:t,children:s})})})},eS=(0,d.forwardRef)((e,t)=>{let{children:a,label:s}=e;return(0,i.jsxs)("div",{ref:t,className:"flex -space-x-px",children:[a,(0,i.jsx)("div",{className:"border border-strong bg-surface-300 rounded-r-md px-3 flex items-center justify-center",children:(0,i.jsx)("span",{className:"text-foreground-lighter text-xs font-mono",children:s})})]})});eS.displayName="InputPostTab";let eN=e=>{let{form:t}=e,{ref:a}=(0,m.g)(),{control:s,setValue:n,formState:{errors:r}}=t,{totalSize:l,growthPercent:o,maxSizeGb:d,minIncrementGb:c}=t.watch(),{error:u,isLoading:p,isError:h}=S({projectRef:a}),x=null!=o?o:$.SZ.growthPercent,g=null!=c?c:$.SZ.minIncrementSize,f=r.maxSizeGb?$.SZ.maxSizeGb:null!=d?d:$.SZ.maxSizeGb,y=Math.floor(x/100*l),v=Math.min(Math.max(Math.floor(l*x/100),g),200)+l,j=v<f?v:f,b=j-l;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(G.zB,{name:"growthPercent",control:s,render:e=>{var t;let{field:a}=e;return(0,i.jsxs)(ej.M,{layout:"horizontal",label:"Autoscale growth percent",id:a.name,labelOptional:"Percentage of current disk size to grow",description:r.growthPercent?void 0:"This amounts to ".concat(y," GB based on the current disk size of ").concat(l," GB"),className:"[&>div>span]:text-foreground-lighter",children:[(0,i.jsx)(eS,{label:"%",children:p?(0,i.jsx)("div",{className:(0,E.cn)((0,ey.L)({size:"small"}),"w-32 font-mono rounded-r-none"),children:(0,i.jsx)(ev.E,{className:"w-10 h-4"})}):(0,i.jsx)(G.MJ,{children:(0,i.jsx)(ey.p,{...a,type:"number",className:"flex-grow font-mono rounded-r-none max-w-20",value:null!=(t=a.value)?t:void 0,disabled:h,onChange:e=>{n("growthPercent",""===e.target.value?null:e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0})},placeholder:String($.SZ.growthPercent)})})}),u&&(0,i.jsx)(eb,{type:"error",message:u.message})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"AutoScaleFields.tsx"}),(0,i.jsx)(G.zB,{name:"minIncrementGb",control:s,render:e=>{var t;let{field:a}=e;return(0,i.jsxs)(ej.M,{layout:"horizontal",label:"Minimum increment",id:a.name,labelOptional:"Minimum value to autoscale disk size by",description:c&&c>y&&!r.minIncrementGb?"This value takes precedence as the minimum increment is larger than the growth percent":void 0,className:"[&>div>span]:text-foreground-lighter",children:[(0,i.jsx)(eS,{label:"GB",children:p?(0,i.jsx)("div",{className:(0,E.cn)((0,ey.L)({size:"small"}),"w-32 font-mono rounded-r-none"),children:(0,i.jsx)(ev.E,{className:"w-10 h-4"})}):(0,i.jsx)(G.MJ,{children:(0,i.jsx)(ey.p,{...a,type:"number",className:"flex-grow font-mono rounded-r-none max-w-32",value:null!=(t=a.value)?t:void 0,disabled:h,onChange:e=>{n("minIncrementGb",""===e.target.value?null:e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0})},placeholder:String($.SZ.minIncrementSize)})})}),u&&(0,i.jsx)(eb,{type:"error",message:u.message})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"AutoScaleFields.tsx"}),(0,i.jsx)(G.zB,{name:"maxSizeGb",control:s,render:e=>{var t;let{field:a}=e;return(0,i.jsxs)(ej.M,{layout:"horizontal",label:"Maximum disk size",id:a.name,labelOptional:"Maximum size that the disk can grow to",className:"[&>div>span]:text-foreground-lighter",children:[(0,i.jsx)(eS,{label:"GB",children:p?(0,i.jsx)("div",{className:(0,E.cn)((0,ey.L)({size:"small"}),"w-32 font-mono rounded-r-none"),children:(0,i.jsx)(ev.E,{className:"w-10 h-4"})}):(0,i.jsx)(G.MJ,{children:(0,i.jsx)(ey.p,{...a,type:"number",className:"flex-grow font-mono rounded-r-none max-w-32",value:null!=(t=a.value)?t:void 0,disabled:h,onChange:e=>{n("maxSizeGb",""===e.target.value?null:e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0})},placeholder:String($.SZ.maxSizeGb)})})}),u&&(0,i.jsx)(eb,{type:"error",message:u.message})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"AutoScaleFields.tsx"}),(0,i.jsxs)(Z.Z,{type:"default",showIcon:!1,className:"[&>div]:text-foreground-light",children:["Disk size will automatically be expanded by"," ",(0,i.jsxs)("span",{className:"text-foreground",children:[String(b).length>4?b.toFixed(2):b," ","GB"]})," ","to a total of ",(0,i.jsxs)("span",{className:"text-foreground",children:[j," GB"]})," ","when the database reaches 90% of the disk size"]})]})};var ew=a(11743),ez=a(25422),eP=a(82270),e_=a(27695),ek=a(10723),eI=a(2657),eD=a(56217),eT=a(21290),eM=a(6538),eC=a(12487);function eV(e){var t,a,s;let{form:r,disabled:l}=e,{ref:o}=(0,m.g)(),{data:c}=(0,O.s)(),{data:u,isLoading:p}=(0,R.YA)(),{hasAccess:x,isLoading:g}=(0,V.e)("instances.compute_update_available_sizes"),f=(0,eI.x)("project_addons:show_compute_price"),{computeSize:y,storageType:v}=r.watch(),{data:j,isLoading:b,error:S}=(0,M.Q)({projectRef:o}),N=p||b||g,{control:w,formState:z,setValue:P,trigger:_}=r,k=(0,d.useMemo)(()=>{var e;return null!=(e=null==j?void 0:j.available_addons)?e:[]},[j]),I=(0,d.useMemo)(()=>(0,W.$C)(k,null==u?void 0:u.cloud_provider),[k,null==u?void 0:u.cloud_provider]),D=null==j?void 0:j.selected_addons.find(e=>"pitr"===e.type),T=(0,W.Uk)({availableOptions:I,oldComputeSize:(null==(t=r.formState.defaultValues)?void 0:t.computeSize)||"ci_micro",newComputeSize:r.getValues("computeSize"),plan:null!=(a=null==c?void 0:c.plan.id)?a:"free"}),C=null!=(s=null==u?void 0:u.infra_compute_size)?s:"nano",A=x&&"nano"===C;return(0,i.jsx)(G.zB,{name:"computeSize",control:w,render:e=>{let{field:t}=e;return(0,i.jsx)(eT.p,{...t,onValueChange:e=>{P("computeSize",e,{shouldDirty:!0,shouldValidate:!0}),_("provisionedIOPS"),_("throughput")},defaultValue:t.value,disabled:l,children:(0,i.jsx)(ej.M,{layout:"horizontal",label:"Compute size",id:t.name,className:"gap-5",labelOptional:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(el,{className:"mb-2",show:z.isDirty&&z.dirtyFields.computeSize&&!z.errors.computeSize,beforePrice:Number(T.oldPrice),afterPrice:Number(T.newPrice),free:!!A&&"ci_micro"===y}),(0,i.jsx)("p",{className:"text-foreground-lighter",children:"Hardware resources allocated to your Postgres database"}),(0,i.jsx)("div",{className:"mt-3",children:(0,i.jsx)(h.A,{abbrev:!1,href:"".concat(F.aq,"/guides/platform/compute-and-disk")})}),(0,i.jsx)(eC.Y,{showIcon:!1,type:"default",className:"mt-3 border-violet-900 bg-violet-200 [&_h5]:text-violet-1100",visible:A&&"ci_nano"===r.watch("computeSize"),title:"Upgrade to Micro Compute",description:"This Project is already paying for Micro Compute. You can upgrade to Micro Compute at any time when convenient."})]}),children:(0,i.jsx)("div",{className:S?"":"grid gap-4 grid-cols-[repeat(auto-fit,minmax(min(100%,13em),1fr))]",children:N?Array(10).fill(0).map((e,t)=>(0,i.jsx)(ev.E,{className:"w-full h-[110px] rounded-md"},t)):S?(0,i.jsx)(eb,{message:"Failed to load Compute size options",type:"error",children:(0,i.jsx)("p",{children:null==S?void 0:S.message})}):(0,i.jsxs)(i.Fragment,{children:[I.map(e=>{var t,a,s,n,r,o;let d=(0,eD.g)(null==u?void 0:u.cloud_provider),m="ci_micro"===e.identifier&&!!D,p=(null==c?void 0:c.plan.id)!=="free"&&(null==u?void 0:u.infra_compute_size)!=="nano"&&"ci_nano"===e.identifier||m,h=(null==c?void 0:c.plan.id)!=="free"&&(null==u?void 0:u.infra_compute_size)==="nano"&&"ci_nano"===e.identifier?null==(t=I.find(e=>"ci_micro"===e.identifier))?void 0:t.price:e.price;return(0,i.jsx)(eT.e,{showIndicator:!1,id:e.identifier,value:e.identifier,className:(0,E.cn)("relative text-sm text-left flex flex-col gap-0 px-0 py-3 [&_label]:w-full group] w-full h-[110px]",p&&"opacity-50"),disabled:l||p,label:(0,i.jsxs)(er.m_,{children:[(0,i.jsx)(er.k$,{asChild:!0,children:(0,i.jsxs)("div",{children:[A&&"ci_micro"===e.identifier&&(0,i.jsx)("div",{className:"absolute -top-4 -right-3 text-violet-1100 flex items-center gap-1 bg-surface-75 py-0.5 px-2 rounded-full border border-violet-900",children:(0,i.jsx)("span",{children:"No additional charge"})}),(0,i.jsxs)("div",{className:"w-full flex flex-col gap-3 justify-between",children:[(0,i.jsxs)("div",{className:"relative px-3 opacity-50 group-data-[state=checked]:opacity-100 flex justify-between",children:[(0,i.jsx)(eM.R,{className:"inline-flex font-semibold",infraComputeSize:e.name}),(0,i.jsx)("div",{className:"flex items-center space-x-1",children:p?(0,i.jsx)("div",{className:"bg border rounded-lg h-7 w-7 flex items-center justify-center",children:(0,i.jsx)(ew.A,{size:14})}):f&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("span",{className:"text-foreground text-sm font-semibold",translate:"no",children:["$",h]}),(0,i.jsxs)("span",{className:"text-foreground-light translate-y-[1px]",children:[" ","/"," ","monthly"===e.price_interval?"month":"hour"]})]})})]}),(0,i.jsx)("div",{className:"w-full",children:(0,i.jsxs)("div",{className:"px-3 text-sm flex flex-col gap-1",children:[(0,i.jsxs)("div",{className:"text-foreground-light flex gap-2 items-center",children:[(0,i.jsx)(ez.A,{strokeWidth:1,size:14,className:"text-foreground-lighter"}),(0,i.jsxs)("span",{children:["ci_nano"===e.identifier&&"Up to ",null!=(r=null==(a=e.meta)?void 0:a.memory_gb)?r:0," GB memory"]})]}),(0,i.jsxs)("div",{className:"text-foreground-light flex gap-2 items-center",children:[(0,i.jsx)(eP.A,{strokeWidth:1,size:14,className:"text-foreground-lighter"}),(0,i.jsxs)("span",{children:[null!=(o=null==(s=e.meta)?void 0:s.cpu_cores)?o:0,(null==(n=e.meta)?void 0:n.cpu_cores)!=="Shared"&&"-core ".concat(d)," ","CPU"]})]})]})})]})]})}),m&&(0,i.jsxs)(er.ZI,{side:"bottom",className:"w-64 text-center",children:["Project has PITR enabled which requires a minimum of Small compute. Please"," ",(0,i.jsx)(ek.g,{href:"/project/_/settings/addons?panel=pitr",children:"disable PITR"})," ","first before selecting Micro"]})]})},e.identifier)}),(0,i.jsx)(eT.e,{id:"larger-compute",showIndicator:!1,value:"larger-compute",onClick:e=>e.preventDefault(),className:(0,E.cn)("relative text-sm text-left flex flex-col gap-0 px-0 py-3 [&_label]:w-full group] w-full h-[110px]"),label:(0,i.jsx)(e_.Y,{queryParams:{projectRef:o,category:n.S.SALES_ENQUIRY,subject:"Enquiry about larger instance sizes"},children:(0,i.jsxs)("div",{className:"w-full flex flex-col gap-3 justify-between",children:[(0,i.jsxs)("div",{className:"relative px-3 flex justify-between",children:[(0,i.jsx)(eM.R,{infraComputeSize:">16XL"}),(0,i.jsx)("div",{className:"flex items-center space-x-1 opacity-50 ",children:(0,i.jsx)("span",{className:"text-foreground-light text-sm",children:"Contact Us"})})]}),(0,i.jsx)("div",{className:"w-full",children:(0,i.jsxs)("div",{className:"px-3 text-sm flex flex-col gap-1",children:[(0,i.jsxs)("div",{className:"text-foreground-light flex gap-2 items-center",children:[(0,i.jsx)(ez.A,{strokeWidth:1,size:14,className:"text-foreground-lighter"}),(0,i.jsx)("span",{children:"Custom memory"})]}),(0,i.jsxs)("div",{className:"text-foreground-light flex gap-2 items-center",children:[(0,i.jsx)(eP.A,{strokeWidth:1,size:14,className:"text-foreground-lighter"}),(0,i.jsx)("span",{children:"Custom CPU"})]})]})})]})})},"larger-compute")]})})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-component":"ComputeSizeField","data-sentry-source-file":"ComputeSizeField.tsx"})}var eA=a(53434),eO=a.n(eA),eR=a(59129);let eF=e=>{var t,a;let{isDirty:s,totalSize:n,usedSize:o,newTotalSize:d,oldStorageType:c,newStorageType:u}=e,{ref:p}=(0,m.g)(),{data:h}=(0,D.Vh)({projectRef:p}),x=(null!=h?h:[]).filter(e=>e.identifier!==p),g=n*(null==(t=$.zN[c])?void 0:t.storage),f=d*(null==(a=$.zN[u])?void 0:a.storage);return 0===x.length?null:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(r.N,{"data-sentry-element":"AnimatePresence","data-sentry-source-file":"DiskManagementReadReplicas.tsx",children:s&&(0,i.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:(0,i.jsxs)(en.Fc,{variant:"default",className:"bg-transparent",children:[(0,i.jsx)(ee.mo,{}),(0,i.jsx)(en.XL,{children:"Read replicas are provisioned with extra 25% disk size to account for WAL files"}),(0,i.jsxs)(en.TN,{children:["Each replica will have a disk size of ",d,"GB, and are billed separately",(0,i.jsx)("ul",{className:"list-disc pl-4 my-3 flex flex-col gap-2",children:x.map((e,t)=>(0,i.jsx)("li",{className:"marker:text-foreground-light",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)("span",{children:["ID: ",(0,eR.s)(e.identifier)," (",e.region,"):"]}),(0,i.jsx)(el,{show:!0,beforePrice:g,afterPrice:f})]})},t))})]})]})})})})},eG=e=>{var t,a,s,n;let{isDirty:o,oldIOPS:d,newIOPS:c,oldStorageType:u,newStorageType:p}=e,{ref:h}=(0,m.g)(),{data:x}=(0,D.Vh)({projectRef:h}),g=(null!=x?x:[]).filter(e=>e.identifier!==h),f=(d-(null==(t=$.No[u])?void 0:t.includedIops))*(null==(a=$.zN[u])?void 0:a.iops),y=(c-(null==(s=$.No[p])?void 0:s.includedIops))*(null==(n=$.zN[p])?void 0:n.iops);return 0===g.length?null:(0,i.jsx)(r.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-component":"DiskManagementIOPSReadReplicas","data-sentry-source-file":"DiskManagementReadReplicas.tsx",children:o&&(0,i.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:(0,i.jsxs)(en.Fc,{variant:"default",className:"bg-transparent",children:[(0,i.jsx)(ee.mo,{}),(0,i.jsx)(en.XL,{children:"Read replica IOPS will also be updated to the same value"}),(0,i.jsx)(en.TN,{children:(0,i.jsx)("ul",{className:"list-disc pl-4 my-3 flex flex-col gap-2",children:g.map((e,t)=>(0,i.jsx)("li",{className:"marker:text-foreground-light",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)("span",{children:["ID: ",(0,eR.s)(e.identifier)," (",e.region,"):"]}),(0,i.jsx)(el,{show:!0,beforePrice:f,afterPrice:y})]})},t))})})]})})})},eB=e=>{var t,a;let{isDirty:s,oldThroughput:n,newThroughput:o,oldStorageType:d,newStorageType:c}=e,{ref:u}=(0,m.g)(),{data:p}=(0,D.Vh)({projectRef:u}),h=(null!=p?p:[]).filter(e=>e.identifier!==u),x=d===$.y6.GP3?(n-$.No[d].includedThroughput)*(null==(t=$.zN[d])?void 0:t.throughput):0,g=c===$.y6.GP3?(o-$.No[c].includedThroughput)*(null==(a=$.zN[c])?void 0:a.throughput):0;return 0===h.length?null:(0,i.jsx)(r.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-component":"DiskManagementThroughputReadReplicas","data-sentry-source-file":"DiskManagementReadReplicas.tsx",children:s&&(0,i.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:(0,i.jsxs)(en.Fc,{variant:"default",className:"bg-transparent",children:[(0,i.jsx)(ee.mo,{}),(0,i.jsx)(en.XL,{children:"Read replica throughput will also be updated to the same value"}),(0,i.jsx)(en.TN,{children:(0,i.jsx)("ul",{className:"list-disc pl-4 my-3 flex flex-col gap-2",children:h.map((e,t)=>(0,i.jsx)("li",{className:"marker:text-foreground-light",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsxs)("span",{children:["ID: ",(0,eR.s)(e.identifier)," (",e.region,"):"]}),(0,i.jsx)(el,{show:!0,beforePrice:x,afterPrice:g})]})},t))})})]})})})};var eL=a(79050),eE=a(80356),eq=a(796),eZ=a(59356);async function eY(e,t){let{projectRef:a,connectionString:i}=e;if(!a)throw Error("Project ref is required");if(!i)throw Error("Connection string is required");let{result:s}=await (0,eZ.E)({projectRef:a,connectionString:i,sql:"\n    SELECT\n  (\n    SELECT\n      SUM(pg_database_size(pg_database.datname)) AS db_size_bytes\n    FROM\n      pg_database\n  ),\n  (\n    SELECT SUM(size)\n    FROM\n      pg_ls_waldir()\n  ) AS wal_size_bytes"},t);return s[0]}let eU=function(e){let{projectRef:t,connectionString:a}=e,{enabled:i=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.I)({queryKey:j.n.diskBreakdown(t),queryFn:e=>{let{signal:i}=e;return eY({projectRef:t,connectionString:a},i)},enabled:i&&void 0!==t,...s})},eH=e=>{var t,a,s,n,o;let{form:c}=e,{ref:u}=(0,m.g)(),{resolvedTheme:p}=(0,eq.D)(),{formState:h,watch:x}=c,g=null==p?void 0:p.includes("dark"),{data:f}=(0,R.YA)(),{data:y}=k({projectRef:u}),{data:v}=eU({projectRef:u,connectionString:null==f?void 0:f.connectionString}),j=(0,d.useMemo)(()=>{var e,t,a,i,s,n,r;return{availableBytes:null!=(e=null==y?void 0:y.metrics.fs_avail_bytes)?e:0,totalUsedBytes:null!=(t=null==y?void 0:y.metrics.fs_used_bytes)?t:0,totalDiskSizeBytes:null==y?void 0:y.metrics.fs_size_bytes,dbSizeBytes:Math.max(0,null!=(a=null==v?void 0:v.db_size_bytes)?a:0),walSizeBytes:Math.max(0,null!=(i=null==v?void 0:v.wal_size_bytes)?i:0),systemBytes:Math.max(0,(null!=(s=null==y?void 0:y.metrics.fs_used_bytes)?s:0)-(null!=(n=null==v?void 0:v.db_size_bytes)?n:0)-(null!=(r=null==v?void 0:v.wal_size_bytes)?r:0))}},[y,v]),b=void 0!==h.dirtyFields.totalSize&&v,S=x("totalSize"),N=(null==(t=h.defaultValues)?void 0:t.totalSize)||0,w=Math.round((null!=(a=null==j?void 0:j.totalUsedBytes)?a:0)/F.GB*100)/100,z=Math.min(w/N*100,100),P=Math.round((null!=(s=null==j?void 0:j.dbSizeBytes)?s:0)/F.GB*100)/100,_=0===N?0:Math.min(P/N*100,100),I=Math.min(P/S*100,100),D=Math.round((null!=(n=null==j?void 0:j.walSizeBytes)?n:0)/F.GB*100)/100,T=0===N?0:Math.min(D/N*100,100),M=Math.min(D/S*100,100),C=Math.round((null!=(o=null==j?void 0:j.systemBytes)?o:0)/F.GB*100)/100,V=0===N?0:Math.min(C/N*100,100),A=Math.min(C/S*100,100),O=100*$.nU,G=100*$.nU;return(0,i.jsxs)("div",{className:"flex flex-col gap-2","data-sentry-component":"DiskSpaceBar","data-sentry-source-file":"DiskSpaceBar.tsx",children:[(0,i.jsx)("div",{className:"flex items-center h-6 gap-3",children:(0,i.jsxs)("span",{className:"text-foreground-light text-sm font-mono flex items-center gap-2",children:[w.toFixed(2),(0,i.jsx)("span",{children:"GB used of "}),(0,i.jsx)("span",{className:"text-foreground font-semibold -mt-[2px]",children:(0,i.jsx)(eL.Ay,{value:S,style:{lineHeight:.8},className:"font-mono","data-sentry-element":"MotionNumber","data-sentry-source-file":"DiskSpaceBar.tsx"})})," ","GB"]})}),(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsxs)("div",{className:(0,E.cn)("h-[35px] relative border rounded-sm w-full transition",b?"bg-selection border border-brand":"bg-surface-300"),children:[(0,i.jsx)(r.N,{"data-sentry-element":"AnimatePresence","data-sentry-source-file":"DiskSpaceBar.tsx",children:(0,i.jsx)(l.P.div,{initial:{rotateY:90,zIndex:2},animate:{rotateY:0,zIndex:1},exit:{rotateY:-90,zIndex:2},transition:{duration:.3},style:{transformOrigin:"left center",backfaceVisibility:"hidden"},className:"absolute inset-0 rounded-sm overflow-hidden","data-sentry-element":"motion.div","data-sentry-source-file":"DiskSpaceBar.tsx",children:(0,i.jsxs)("div",{className:"h-full flex",children:[(0,i.jsx)("div",{className:"relative overflow-hidden transition-all duration-500 ease-in-out bg-foreground",style:{width:"".concat(b?I:_,"%")},children:(0,i.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"repeating-linear-gradient(\n                            -45deg,\n                            ".concat(g?"rgba(0,0,0,0.1)":"rgba(255,255,255,0.1)",",\n                            ").concat(g?"rgba(0,0,0,0.1) 1px":"rgba(255,255,255,0.1) 1px",",\n                            transparent 1px,\n                            transparent 4px\n                          )")}})}),(0,i.jsx)("div",{className:"relative overflow-hidden transition-all duration-500 ease-in-out bg-_secondary",style:{width:"".concat(b?M:T,"%")}}),(0,i.jsx)("div",{className:"relative overflow-hidden transition-all duration-500 ease-in-out bg-destructive-500",style:{width:"".concat(b?A:V,"%")}}),!b&&(0,i.jsx)("div",{className:"bg-transparent-800 border-r transition-all duration-500 ease-in-out",style:{width:"".concat(O-z<=0?0:O-z,"%")}})]})},"currentBar")}),(0,i.jsx)(r.N,{"data-sentry-element":"AnimatePresence","data-sentry-source-file":"DiskSpaceBar.tsx",children:b&&(0,i.jsx)(l.P.span,{initial:{opacity:0,x:4},animate:{opacity:1,x:0},exit:{opacity:0,x:4},transition:{duration:.12,delay:.12},className:(0,E.cn)((0,Y.e)({variant:"success"}),"absolute right-1 top-[5px]"),children:"New disk size"})})]}),(0,i.jsx)(r.N,{initial:!0,"data-sentry-element":"AnimatePresence","data-sentry-source-file":"DiskSpaceBar.tsx",children:!b&&(0,i.jsx)(l.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.1},className:"absolute h-8 w-full -mx-[2px]",children:(0,i.jsxs)("div",{className:"absolute top-0 -left-0 h-full flex items-center transition-all duration-500 ease-in-out",style:{left:"".concat(b?G:O,"%")},children:[(0,i.jsxs)(er.m_,{children:[(0,i.jsx)(er.k$,{asChild:!0,children:(0,i.jsxs)("div",{className:"absolute right-full bottom-0 border mr-2 px-2 py-1 bg-surface-400 rounded text-xs text-foreground-light whitespace-nowrap flex items-center gap-x-1",children:["Autoscaling ",(0,i.jsx)(eE.A,{size:12})]})}),(0,i.jsxs)(er.ZI,{side:"bottom",className:"w-[310px] flex flex-col gap-y-1",children:[(0,i.jsx)("p",{children:"Supabase expands your disk storage automatically when the database reached 90% of the disk size. However, any disk modifications, including auto-scaling, can only take place once every 6 hours."}),(0,i.jsxs)("p",{children:["If within those 6 hours you reach 95% of the disk space, your project"," ",(0,i.jsx)("span",{className:"text-destructive-600",children:"will enter read-only mode."})]})]})]}),(0,i.jsx)("div",{className:"w-px h-full bg-border"})]})},"currentSize")})]}),!b&&(0,i.jsxs)("div",{className:"flex items-center space-x-3 text-xs text-foreground-lighter",children:[(0,i.jsx)(eX,{name:"Database",size:j.dbSizeBytes,color:"bg-foreground",description:"Total space on disk used by your database (tables, indexes, data, ...)."}),(0,i.jsx)(eX,{name:"WAL",size:j.walSizeBytes,color:"bg-_secondary",description:"Total space on disk used by the write-ahead log."}),(0,i.jsx)(eX,{name:"System",size:j.systemBytes,color:"bg-destructive-500",description:"Reserved space for the system to ensure your database runs smoothly. You cannot modify this."}),(0,i.jsx)(eX,{name:"Available space",size:j.availableBytes,color:"bg-border",description:"Total available space on the disk left."})]}),(0,i.jsxs)("p",{className:"text-xs text-foreground-lighter my-4",children:[(0,i.jsx)("span",{className:"font-semibold",children:"Note:"})," Disk Size refers to the total space your project occupies on disk, including the database itself (currently"," ",(0,i.jsx)("span",{children:(0,ei.z3)(null==j?void 0:j.dbSizeBytes,2,"GB")}),"), additional files like the write-ahead log (currently"," ",(0,i.jsx)("span",{children:(0,ei.z3)(null==j?void 0:j.walSizeBytes,2,"GB")}),"), and other system resources (currently ",(0,i.jsx)("span",{children:(0,ei.z3)(null==j?void 0:j.systemBytes,2,"GB")}),"). Data can take 5 minutes to refresh."]})]})},eX=e=>{let{name:t,description:a,color:s,size:n}=e;return(0,i.jsxs)(er.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"LegendItem","data-sentry-source-file":"DiskSpaceBar.tsx",children:[(0,i.jsx)(er.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"DiskSpaceBar.tsx",children:(0,i.jsxs)("div",{className:"flex items-center hover:cursor-help z-10",children:[(0,i.jsx)("div",{className:(0,E.cn)("w-2 h-2 rounded-full mr-2",s)}),(0,i.jsx)("span",{children:t})]})}),(0,i.jsxs)(er.ZI,{side:"bottom",className:"flex flex-col gap-y-1 max-w-xs","data-sentry-element":"TooltipContent","data-sentry-source-file":"DiskSpaceBar.tsx",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:(0,E.cn)("w-2 h-2 rounded-full mr-2",s)}),(0,i.jsxs)("span",{children:[t," - ",(0,ei.z3)(n,2,"GB")]})]}),(0,i.jsx)("p",{children:a})]})]})};function eW(e){let{actions:t,form:a}=e,{watch:s}=a,n=s("totalSize"),o=s("storageType")===$.y6.GP3&&n>$.No[$.y6.GP3].maxStorage,d=$.EH.find(e=>e.type===$.y6.IO2);return(0,i.jsx)(r.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-component":"DiskTypeRecommendationSection","data-sentry-source-file":"DiskTypeRecommendationSection.tsx",children:o&&(0,i.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.15},children:(0,i.jsx)(Z.Z,{type:"default",title:"You will need to use ".concat(null==d?void 0:d.name," to use a larger Disk size"),children:(0,i.jsx)("div",{className:"flex flex-col gap-2",children:t&&(0,i.jsx)("div",{children:t})})})})})}function e$(e){let{isDirty:t,onClick:a}=e;return(0,i.jsx)(r.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-component":"InputResetButton","data-sentry-source-file":"InputResetButton.tsx",children:t&&(0,i.jsx)(l.P.div,{initial:{opacity:0,scale:.95,x:-2},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.95,x:-2},transition:{duration:.12},children:(0,i.jsx)(q.$,{htmlType:"button",type:"default",size:"small",className:"px-2 text-foreground-light",onClick:a,children:(0,i.jsx)(Q.A,{className:"h-4 w-4","aria-hidden":"true"})})},"reset-disksize")})}function eJ(e){var t,a,s,n,r,l,o;let{form:d,disableInput:c,setAdvancedSettingsOpenState:u}=e,{ref:p}=(0,m.g)(),{control:x,formState:f,setValue:y,trigger:v,getValues:j,resetField:b,watch:S}=d,{data:N}=(0,O.s)(),{data:w}=(0,R.YA)(),{isLoading:z,error:P,isError:_}=(0,g.Gc)({projectRef:p},{enabled:w&&"FLY"!==w.cloud_provider}),{data:I,error:D,isError:T}=k({projectRef:p},{enabled:w&&"FLY"!==w.cloud_provider}),M=D||P,C=T||_,V=10>eO().utc().diff(eO().utc(null==w?void 0:w.inserted_at),"minute")||(null==w?void 0:w.status)==="COMING_UP",A=S("storageType"),B=S("totalSize"),L=null!=(r=null==N?void 0:N.plan.id)?r:"free",{includedDiskGB:Z}=null!=(l=null===$.Jh||void 0===$.Jh?void 0:$.Jh[L])?l:{},Y=Z[A],U=(0,W.WC)({planId:L,oldSize:(null==(t=f.defaultValues)?void 0:t.totalSize)||0,oldStorageType:null==(a=f.defaultValues)?void 0:a.storageType,newSize:j("totalSize"),newStorageType:j("storageType")}),H=!!f.dirtyFields.totalSize,X=Math.round((null!=(o=null==I?void 0:I.metrics.fs_used_bytes)?o:0)/F.GB*100)/100;return(0,i.jsxs)("div",{id:"disk-size",className:"grid @xl:grid-cols-12 gap-5","data-sentry-component":"DiskSizeField","data-sentry-source-file":"DiskSizeField.tsx",children:[(0,i.jsxs)("div",{className:"col-span-4",children:[(0,i.jsx)(G.zB,{name:"totalSize",control:x,render:e=>{let{field:t}=e;return(0,i.jsx)(ej.M,{label:"Disk Size",layout:"vertical",id:t.name,children:(0,i.jsxs)("div",{className:"relative flex gap-2 items-center",children:[(0,i.jsx)(eS,{label:"GB",children:z?(0,i.jsx)("div",{className:(0,E.cn)((0,ey.L)({size:"small"}),"w-32 font-mono rounded-r-none"),children:(0,i.jsx)(ev.E,{className:"w-10 h-4"})}):(0,i.jsx)(G.MJ,{children:(0,i.jsx)(ey.p,{type:"number",id:t.name,...t,disabled:c||C,className:"w-32 font-mono rounded-r-none",onWheel:e=>e.currentTarget.blur(),onChange:e=>{y("totalSize",e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0}),v("provisionedIOPS"),v("throughput")},min:Y})})}),(0,i.jsx)(e$,{isDirty:H,onClick:()=>{b("totalSize"),v("provisionedIOPS")}})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DiskSizeField.tsx"}),(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsx)(el,{className:"mt-1",beforePrice:Number(U.oldPrice),afterPrice:Number(U.newPrice),show:f.isDirty&&!f.errors.totalSize&&U.oldPrice!==U.newPrice,"data-sentry-element":"BillingChangeBadge","data-sentry-source-file":"DiskSizeField.tsx"}),(0,i.jsxs)("span",{className:"text-foreground-lighter text-sm",children:[Y>0&&(null==N?void 0:N.plan.id)&&"Your plan includes ".concat(Y," GB of disk size for ").concat(A,"."),(0,i.jsx)("div",{className:"mt-3",children:(0,i.jsx)(h.A,{abbrev:!1,href:"".concat(F.aq,"/guides/platform/database-size"),"data-sentry-element":"DocsButton","data-sentry-source-file":"DiskSizeField.tsx"})})]}),(0,i.jsx)(eW,{form:d,actions:(0,i.jsx)(q.$,{type:"default",onClick:()=>{y("storageType","io2"),v("provisionedIOPS"),v("totalSize"),u(!0)},children:"Change to High Performance SSD"}),"data-sentry-element":"DiskTypeRecommendationSection","data-sentry-source-file":"DiskSizeField.tsx"})]})]}),(0,i.jsxs)("div",{className:"col-span-8",children:[(0,i.jsx)(eH,{form:d,"data-sentry-element":"DiskSpaceBar","data-sentry-source-file":"DiskSizeField.tsx"}),V?(0,i.jsx)(eb,{message:"Disk size data is not available for ~10 minutes after project creation",type:"error"}):M&&(0,i.jsx)(eb,{message:"Failed to load disk size data",type:"error",children:null==M?void 0:M.message}),(0,i.jsx)(eF,{isDirty:void 0!==f.dirtyFields.totalSize,totalSize:1.25*((null==(s=f.defaultValues)?void 0:s.totalSize)||0),usedSize:X,newTotalSize:1.25*B,oldStorageType:null==(n=f.defaultValues)?void 0:n.storageType,newStorageType:j("storageType"),"data-sentry-element":"DiskManagementDiskSizeReadReplicas","data-sentry-source-file":"DiskSizeField.tsx"})]})]})}function eQ(e){let{actions:t,form:a}=e,{watch:s}=a,n=s("computeSize"),o=s("provisionedIOPS"),d=(0,W.u1)(o),c=o>(0,W.T2)(null!=n?n:"ci_micro")&&!$.JM.includes(n);return(0,i.jsx)(r.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-component":"ComputeSizeRecommendationSection","data-sentry-source-file":"ComputeSizeRecommendationSection.tsx",children:c&&(0,i.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.15},children:(0,i.jsx)(Z.Z,{type:"default",title:"Your Compute size can only support a baseline IOPS of ".concat($.QL[n]),children:(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsx)("div",{children:(0,i.jsxs)("p",{className:"text-sm text-foreground-light",children:["To achieve sustained IOPS performance we recommend using the"," ",(0,i.jsx)("span",{className:"text-foreground",children:(0,W.ku)(d)})," ","compute size."]})}),t&&(0,i.jsx)("div",{children:t})]})})})})}function eK(e){var t,a,s;let{form:n,disableInput:r}=e,{ref:l}=(0,m.g)(),{control:o,formState:d,setValue:c,trigger:u,getValues:p,watch:h}=n,x=h("storageType"),f=h("computeSize"),y=null!=(s=h("provisionedIOPS"))?s:0,{isLoading:v,error:j,isError:b}=(0,g.Gc)({projectRef:l}),S=(0,W.t5)({oldStorageType:null==(t=d.defaultValues)?void 0:t.storageType,oldProvisionedIOPS:(null==(a=d.defaultValues)?void 0:a.provisionedIOPS)||0,newStorageType:p("storageType"),newProvisionedIOPS:p("provisionedIOPS")}),N=$.JM.includes(f)&&"gp3"===x;return(0,i.jsx)(G.zB,{control:o,name:"provisionedIOPS",render:e=>{var t,a,s,l,o;let{field:m}=e,h=(0,W.u1)(y);return(0,i.jsxs)(ej.M,{layout:"horizontal",label:"IOPS",id:m.name,description:(0,i.jsxs)("span",{className:"flex flex-col gap-y-2",children:[(0,i.jsx)("p",{children:"Use higher IOPS for high-throughput apps."}),(0,i.jsx)(eQ,{form:n,actions:(0,i.jsxs)(q.$,{type:"default",onClick:()=>{c("computeSize",null!=h?h:"ci_nano"),u("provisionedIOPS")},children:["Update to ",(0,W.ku)(h)]})}),!d.errors.provisionedIOPS&&(0,i.jsx)(eG,{isDirty:void 0!==d.dirtyFields.provisionedIOPS,oldIOPS:null!=(o=null==(t=d.defaultValues)?void 0:t.provisionedIOPS)?o:0,newIOPS:m.value,oldStorageType:null==(a=d.defaultValues)?void 0:a.storageType,newStorageType:p("storageType")})]}),labelOptional:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(el,{show:(x!==(null==(s=d.defaultValues)?void 0:s.storageType)||"gp3"===x&&m.value!==(null==(l=d.defaultValues)?void 0:l.provisionedIOPS))&&!d.errors.provisionedIOPS&&!N,beforePrice:Number(S.oldPrice),afterPrice:Number(S.newPrice),className:"mb-2"}),(0,i.jsx)("p",{className:"text-foreground-lighter",children:"Input/output operations per second."})]}),children:[(0,i.jsx)(eS,{label:"IOPS",children:v?(0,i.jsx)("div",{className:(0,E.cn)((0,ey.L)({size:"small"}),"w-32 font-mono rounded-r-none"),children:(0,i.jsx)(ev.E,{className:"w-10 h-4"})}):(0,i.jsx)(G.MJ,{children:(0,i.jsx)(ey.p,{type:"number",className:"flex-grow font-mono rounded-r-none max-w-32",...m,value:m.value,disabled:r||N||b,onChange:e=>{c("provisionedIOPS",e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0})}})})}),j&&(0,i.jsx)(eb,{type:"error",message:j.message})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-component":"IOPSField","data-sentry-source-file":"IOPSField.tsx"})}var e0=a(66329);let e1=["ap-east-1","ap-northeast-1","ap-northeast-2","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","eu-central-1","eu-north-1","eu-west-1","eu-west-2","us-east-1","us-east-2","us-west-1","us-west-2"];function e2(e){var t;let{form:a,disableInput:s}=e,{control:n,trigger:r}=a,{data:l}=(0,R.YA)(),{ref:o}=(0,m.g)(),d=e1.includes(null!=(t=null==l?void 0:l.region)?t:""),{isLoading:c,error:u,isError:p}=(0,g.Gc)({projectRef:o});return(0,i.jsx)(G.zB,{name:"storageType",control:n,render:e=>{let{field:t}=e;return(0,i.jsxs)(ej.M,{layout:"horizontal",label:"Storage type",children:[(0,i.jsxs)(e0.l6,{...t,onValueChange:async e=>{t.onChange(e),"gp3"===e?!a.getFieldState("provisionedIOPS").isDirty&&(!a.getValues("provisionedIOPS")||a.getValues("provisionedIOPS")<$.No[$.y6.GP3].minIops)&&a.setValue("provisionedIOPS",$.No[$.y6.GP3].minIops):!a.getFieldState("provisionedIOPS").isDirty&&(!a.getValues("provisionedIOPS")||a.getValues("provisionedIOPS")<$.No[$.y6.IO2].minIops)&&a.setValue("provisionedIOPS",$.No[$.y6.IO2].minIops),await r("provisionedIOPS"),await r("totalSize")},defaultValue:t.value,disabled:s||p,children:[c?(0,i.jsx)(ev.E,{className:(0,E.cn)((0,q.r)({size:"small"}),"h-14 min-w-[420px] duration-[2s]")}):(0,i.jsx)(G.MJ,{children:(0,i.jsx)(e0.bq,{className:"h-14 max-w-[420px]",children:(0,i.jsx)(e0.yv,{})})}),(0,i.jsx)(e0.gC,{children:(0,i.jsx)(i.Fragment,{children:$.EH.map(e=>{let t="io2"===e.type&&!d;return(0,i.jsxs)(er.m_,{children:[(0,i.jsx)(er.k$,{asChild:!0,children:(0,i.jsx)(e0.eb,{disabled:s||t,value:e.type,className:(0,E.cn)(t&&"!pointer-events-auto"),children:(0,i.jsxs)("div",{className:"flex flex-col gap-0 items-start",children:[(0,i.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,i.jsx)("span",{className:"text-sm text-foreground",children:e.name})," ",(0,i.jsx)("div",{children:(0,i.jsx)(Y.E,{variant:"outline",className:"font-mono bg-alternative bg-opacity-100",children:e.type})})]}),(0,i.jsx)("p",{className:"text-foreground-light",children:e.description})]})},e.type)}),t&&(0,i.jsxs)(er.ZI,{side:"right",className:"w-64",children:["IO2 Volume Type is not available in your project's region (",null==l?void 0:l.region,"). More information available"," ",(0,i.jsx)(ek.g,{href:"https://docs.aws.amazon.com/ebs/latest/userguide/provisioned-iops.html#io2-bx-considerations",children:"here"}),"."]})]},e.type)})})})]}),u&&(0,i.jsx)(eb,{type:"error",message:u.message})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-component":"StorageTypeField","data-sentry-source-file":"StorageTypeField.tsx"})}function e3(e){var t,a;let{form:s,disableInput:n}=e,{ref:o}=(0,m.g)(),{control:c,formState:u,setValue:p,getValues:h,watch:x}=s,f=x("storageType"),y=x("totalSize"),v=x("computeSize"),j=null==(t=u.defaultValues)?void 0:t.throughput,{isLoading:b,error:S}=(0,g.Gc)({projectRef:o}),N=(0,W.ou)({storageType:s.getValues("storageType"),newThroughput:s.getValues("throughput")||0,oldThroughput:(null==(a=s.formState.defaultValues)?void 0:a.throughput)||0}),w=$.JM.includes(v)&&"gp3"===f;return(0,d.useEffect)(()=>{if("io2"===f)p("throughput",void 0);else if("gp3"===f){let e=s.getValues("throughput"),{minThroughput:t,maxThroughput:a}=$.No[$.y6.GP3];(!e||e<t||e>a)&&p("throughput",t)}},[f,y,p,s]),(0,i.jsx)(r.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-component":"ThroughputField","data-sentry-source-file":"ThroughputField.tsx",children:"gp3"===h("storageType")&&(0,i.jsx)(l.P.div,{initial:{opacity:0,x:-4,height:0},animate:{opacity:1,x:0,height:"auto"},exit:{opacity:0,x:-4,height:0},transition:{duration:.1},style:{overflow:"hidden"},children:(0,i.jsx)(G.zB,{name:"throughput",control:c,render:e=>{var t,a;let{field:s}=e;return(0,i.jsxs)(ej.M,{label:"Throughput",layout:"horizontal",description:(0,i.jsxs)("span",{className:"flex flex-col gap-y-2",children:[(0,i.jsx)("p",{children:"Higher throughput suits applications with high data transfer needs."}),!u.errors.throughput&&(0,i.jsx)(eB,{isDirty:void 0!==u.dirtyFields.throughput,oldThroughput:null!=j?j:0,newThroughput:null!=(a=s.value)?a:0,oldStorageType:null==(t=u.defaultValues)?void 0:t.storageType,newStorageType:h("storageType")})]}),labelOptional:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(el,{show:u.isDirty&&u.dirtyFields.throughput&&!u.errors.throughput,beforePrice:Number(N.oldPrice),afterPrice:Number(N.newPrice),className:"mb-2"}),(0,i.jsx)("p",{className:"text-foreground-lighter",children:"Amount of data read/written per second."})]}),children:[(0,i.jsx)(eS,{label:"MB/s",children:b?(0,i.jsx)("div",{className:(0,E.cn)((0,ey.L)({size:"small"}),"w-32 font-mono rounded-r-none"),children:(0,i.jsx)(ev.E,{className:"w-10 h-4"})}):(0,i.jsx)(G.MJ,{children:(0,i.jsx)(ey.p,{type:"number",...s,value:s.value,onChange:e=>{p("throughput",e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0})},className:"flex-grow font-mono rounded-r-none max-w-32",disabled:n||w||"io2"===f})})}),S&&(0,i.jsx)(eb,{type:"error",message:S.message})]})}})},"throughPutContainer")})}let e4=e=>{let{seconds:t}=e,a=Math.floor(t/3600),s=Math.floor(t%3600/60),n={minimumIntegerDigits:2},r=e=>e.toString().padStart(2,"0");return(0,i.jsxs)("span",{className:"inline-flex gap-2","data-sentry-component":"CountdownTimerSpan","data-sentry-source-file":"CountdownTimerSpan.tsx",children:[(0,i.jsx)("span",{className:"text-foreground-lighter text-sm p-0",children:"Time remaining: "}),(0,i.jsxs)("span",{className:"text-foreground text-sm font-mono flex items-center gap-0",children:[(0,i.jsx)(eL.Ay,{format:n,value:Number(r(a)),"data-sentry-element":"MotionNumber","data-sentry-source-file":"CountdownTimerSpan.tsx"}),"hr",(0,i.jsx)(eL.Ay,{format:n,value:Number(r(s)),"data-sentry-element":"MotionNumber","data-sentry-source-file":"CountdownTimerSpan.tsx"}),"m",(0,i.jsx)(eL.Ay,{format:n,value:Number(r(t%60)),"data-sentry-element":"MotionNumber","data-sentry-source-file":"CountdownTimerSpan.tsx"})]})]})};var e5=a(78039);function e6(){let{ref:e}=(0,m.g)(),[t,a]=(0,d.useState)(0),{remainingDuration:s,error:n,isSuccess:o}=(0,g.Zj)({projectRef:e}),c=t/f.Xz*100;return(0,d.useEffect)(()=>{s>0&&a(s)},[s]),(0,d.useEffect)(()=>{if(t<=0)return;let e=setInterval(()=>{a(Math.max(0,t-1))},1e3);return()=>clearInterval(e)},[t]),(0,i.jsxs)(r.N,{"data-sentry-element":"AnimatePresence","data-sentry-component":"DiskCountdownRadial","data-sentry-source-file":"DiskCountdownRadial.tsx",children:[t>0&&o&&(0,i.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:(0,i.jsx)(e5.Zp,{className:"px-2 rounded bg-surface-100",children:(0,i.jsxs)(e5.Wu,{className:"py-3 flex gap-3 px-3 items-start",children:[(0,i.jsx)(ep,{progress:c}),(0,i.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("p",{className:"text-foreground text-sm p-0",children:"6-hour cooldown period is in progress"}),(0,i.jsx)("p",{className:"text-foreground-lighter text-sm p-0",children:"You can't modify your disk configuration again until the 6-hour cool down period ends."})]}),(0,i.jsx)(e4,{seconds:t})]})]})})}),n&&(0,i.jsx)(eb,{message:n.message,type:"error"})]})}var e8=a(52555),e7=a.n(e8);function e9(){let{data:e}=(0,O.s)(),{data:t}=(0,R.YA)(),a=(null==e?void 0:e.plan.id)!=="free"&&!(null==e?void 0:e.usage_billing_enabled)&&(null==t?void 0:t.cloud_provider)!=="FLY";return(0,i.jsx)(r.N,{"data-sentry-element":"AnimatePresence","data-sentry-component":"SpendCapDisabledSection","data-sentry-source-file":"SpendCapDisabledSection.tsx",children:a&&(0,i.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:(0,i.jsxs)(Z.Z,{type:"default",children:[(0,i.jsx)(en.XL,{children:"Disable spend cap to manage Disk configuration"}),(0,i.jsx)(en.TN,{children:"To access disk management features, you need to disable your spend cap. These features offer more flexibility and control over your database disk size."}),(0,i.jsx)("div",{className:"mt-3",children:(0,i.jsx)(e7(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=costControl"),className:(0,E.cn)((0,q.r)({type:"default",size:"tiny"})),children:"Disable spend cap"})})]})})})}function te(){var e,t,a,y;let{ref:v}=(0,m.g)(),{data:j}=(0,R.YA)(),{data:b}=(0,O.s)(),{setProjectStatus:N}=(0,I.l1)(),{data:w}=(0,C.p)({ref:v}),z=null==(e=null!=w?w:[])?void 0:e.find(e=>e.project===(null==j?void 0:j.ref)),_=null==z?void 0:z.is_readonly_mode_enabled,Y=(0,R.lh)(),H=(0,R.BA)(),Q=(0,R.br)(),{can:K,isSuccess:ee}=(0,A.Qp)(n.aG.UPDATE,"projects",{resource:{project_id:null==j?void 0:j.id}}),{hasAccess:ea,isSuccess:ei}=(0,V.e)("instances.compute_update_available_sizes"),[es,en]=(0,d.useState)(!1),[er,el]=(0,d.useState)(!1),[eo,ed]=(0,d.useState)(null),[ec,eu]=(0,d.useState)(!1),{data:em,isSuccess:ep}=(0,D.Vh)({projectRef:v}),{data:eh,isSuccess:ex}=(0,g.Gc)({projectRef:v},{refetchInterval:er,refetchOnWindowFocus:!1,enabled:null!=j&&Y}),{isSuccess:eg}=(0,M.Q)({projectRef:v}),{isWithinCooldownWindow:ey,isSuccess:ev}=(0,g.Zj)({projectRef:v,enabled:null!=j&&Y}),{data:ej,isSuccess:eb}=k({projectRef:v},{enabled:null!=j&&Y}),{data:eS,isSuccess:ew}=S({projectRef:v},{enabled:null!=j&&Y}),ez=(null==j?void 0:j.infra_compute_size)?(0,W.$6)(null==j?void 0:j.infra_compute_size):void 0,{type:eP,iops:e_,throughput_mbps:ek,size_gb:eI}=null!=(a=null==eh?void 0:eh.attributes)?a:{size_gb:0,iops:0},{growth_percent:eD,max_size_gb:eT,min_increment_gb:eM}=null!=eS?eS:{},eA={storageType:null!=eP?eP:$.y6.GP3,provisionedIOPS:e_,throughput:ek,totalSize:eI,computeSize:ez,growthPercent:eD,minIncrementGb:eM,maxSizeGb:eT},eO=(0,c.mN)({resolver:(0,s.u)((e=>{let{defaultTotalSize:t,cloudProvider:a}=e,i="FLY"!==a&&"AWS_NIMBUS"!==a;return J.superRefine((e,a)=>{let{storageType:s,totalSize:n,provisionedIOPS:r,throughput:l,maxSizeGb:o}=e;if(i&&n<8&&a.addIssue({code:X.eq.custom,message:"Allocated disk size must be at least 8 GB.",path:["totalSize"]}),i&&n<t&&a.addIssue({code:X.eq.custom,message:"Disk size cannot be reduced in size. Reduce your database size and then head to the Infrastructure settings and go through a Postgres version upgrade to right-size your disk.",path:["totalSize"]}),i&&o&&o<n&&a.addIssue({code:X.eq.custom,message:"Max disk size cannot be lower than the current disk size. Must be at least ".concat((0,W.ZV)(n)," GB."),path:["maxSizeGb"]}),i&&"io2"===s){r>$.No[$.y6.IO2].maxIops&&a.addIssue({code:X.eq.custom,message:"IOPS can not exceed ".concat((0,W.ZV)($.No[$.y6.IO2].maxIops)," for io2 Disk type. Please reach out to support if you need higher IOPS than this."),path:["provisionedIOPS"]});let e=(0,W.Fu)(n);if(r<$.No[$.y6.IO2].minIops)a.addIssue({code:X.eq.custom,message:"Provisioned IOPS must be at least ".concat((0,W.ZV)($.No[$.y6.IO2].minIops)),path:["provisionedIOPS"]});else if(r>e)if(n>=8){let t=(0,W.it)(r);t>n&&a.addIssue({code:X.eq.custom,message:"Larger Disk size of at least ".concat((0,W.ZV)(t)," GB required. Current max is ").concat((0,W.ZV)(e)," IOPS."),path:["provisionedIOPS"]})}else a.addIssue({code:X.eq.custom,message:"Invalid IOPS value due to small disk size",path:["provisionedIOPS"]});void 0!==l&&a.addIssue({code:X.eq.custom,message:"Throughput is not configurable for io2.",path:["throughput"]}),n>$.No[$.y6.IO2].maxStorage&&a.addIssue({code:X.eq.custom,message:"Allocated disksize must not exceed ".concat((0,W.ZV)($.No[$.y6.IO2].maxStorage)," GB "),path:["totalSize"]})}if(i&&"gp3"===s){let e=(0,W.HE)(n);if(r>$.No[$.y6.GP3].maxIops&&a.addIssue({code:X.eq.custom,message:"IOPS can not exceed ".concat((0,W.ZV)($.No[$.y6.GP3].maxIops)," for GP3 Disk. Change the Disk type to io2 for higher IOPS support."),path:["provisionedIOPS"]}),r<$.No[$.y6.GP3].minIops)a.addIssue({code:X.eq.custom,message:"IOPS must be at least ".concat((0,W.ZV)($.No[$.y6.GP3].minIops)),path:["provisionedIOPS"]});else if(r>e)if(n>=8){let t=(0,W.CQ)(r);a.addIssue({code:X.eq.custom,message:"Larger Disk size of at least ".concat((0,W.ZV)(t)," GB required. Current max is ").concat((0,W.ZV)(e)," IOPS."),path:["provisionedIOPS"]})}else a.addIssue({code:X.eq.custom,message:"Invalid IOPS value due to invalid disk size",path:["provisionedIOPS"]});if(void 0!==l){let e=Math.min(.25*r,1e3);if(l>$.No.gp3.maxThroughput&&a.addIssue({code:X.eq.custom,message:"Throughput can not exceed ".concat((0,W.ZV)(e)," MB/s"),path:["throughput"]}),l>e){let e=(0,W.a6)(l);a.addIssue({code:X.eq.custom,message:"Need at least ".concat((0,W.ZV)(e)," IOPS to support ").concat((0,W.ZV)(l)," MB/s."),path:["throughput"]})}l<$.No[$.y6.GP3].minThroughput&&a.addIssue({code:X.eq.custom,message:"Throughput must be at least ".concat((0,W.ZV)($.No[$.y6.GP3].minThroughput)," MB/s"),path:["throughput"]})}n>$.No[$.y6.GP3].maxStorage&&a.addIssue({code:X.eq.custom,message:"Allocated disksize must not exceed ".concat((0,W.ZV)($.No[$.y6.GP3].maxStorage)," GB"),path:["totalSize"]})}})})({defaultTotalSize:eA.totalSize,cloudProvider:null==j?void 0:j.cloud_provider})),defaultValues:eA,mode:"onBlur",reValidateMode:"onChange"});(0,d.useEffect)(()=>{var e;if(!ex)return;let{type:t,iops:a,throughput_mbps:i,size_gb:s}=null!=(e=null==eh?void 0:eh.attributes)?e:{size_gb:0};"requested_modification"in eh?el(2e3):!1!==er&&(eO.reset({storageType:t,provisionedIOPS:a,throughput:i,totalSize:s}),el(!1),u.oR.success("Disk configuration changes have been successfully applied!"))},[eh,ex,eO,er]);let{computeSize:eR}=eO.watch();(0,d.useEffect)(()=>{eR&&(null==j?void 0:j.infra_compute_size)&&es&&$.eQ.includes(eR)&&(eO.setValue("storageType",$.y6.GP3),eO.setValue("throughput",$.No.gp3.minThroughput),eO.setValue("provisionedIOPS",$.No.gp3.minIops))},[eR,es,j]);let eF=eg&&ex&&eb&&ep&&ew&&ev,eG=(null==eh?void 0:eh.requested_modification)!==void 0,eB=(null!=em?em:[]).filter(e=>e.identifier!==v),eL=!ea,{formState:eE}=eO,eq=Math.round((null!=(y=null==ej?void 0:ej.metrics.fs_used_bytes)?y:0)/F.GB*100)/100,eZ=(null==(t=eE.defaultValues)?void 0:t.totalSize)||0,eY=$.eQ.includes(eO.watch("computeSize"))&&!ea,eU=(null==j?void 0:j.parent_project_ref)!==void 0,eH=eG||eL||ey||!K||!Y,eX=!!Object.keys(eO.formState.dirtyFields).length,eW=(null==j?void 0:j.status)===F.BU.RESIZING,e$=eG&&!eW,eQ=ee&&!K,{mutateAsync:e0,isPending:e1}=(0,f._J)({onError:()=>{},onSuccess:()=>el(2e3)}),{mutateAsync:e4,isPending:e5}=(0,T.F)({onError:()=>{},onSuccess:()=>{v&&N({ref:v,status:F.BU.RESIZING})}}),{mutateAsync:e8,isPending:e7}=P({onError:()=>{}}),te=async e=>{let t=!1;ed(null);try{var a,i,s,n,r,l,o,d;Q||e.storageType===(null==(a=eO.formState.defaultValues)?void 0:a.storageType)&&e.provisionedIOPS===(null==(i=eO.formState.defaultValues)?void 0:i.provisionedIOPS)&&e.throughput===(null==(s=eO.formState.defaultValues)?void 0:s.throughput)&&e.totalSize===(null==(n=eO.formState.defaultValues)?void 0:n.totalSize)||(t=!0,await e0({ref:v,provisionedIOPS:e.provisionedIOPS,storageType:e.storageType,totalSize:e.totalSize,throughput:e.throughput})),Q||e.growthPercent===(null==(r=eO.formState.defaultValues)?void 0:r.growthPercent)&&e.minIncrementGb===(null==(l=eO.formState.defaultValues)?void 0:l.minIncrementGb)&&e.maxSizeGb===(null==(o=eO.formState.defaultValues)?void 0:o.maxSizeGb)||await e8({projectRef:v,growthPercent:e.growthPercent,minIncrementGb:e.minIncrementGb,maxSizeGb:e.maxSizeGb}),e.computeSize!==(null==(d=eO.formState.defaultValues)?void 0:d.computeSize)&&await e4({projectRef:v,variant:e.computeSize,type:"compute_instance",suppressToast:!0}),en(!1),eO.reset(e),u.oR.success("Successfully updated disk settings!".concat(t?" The requested changes will be applied to your disk shortly.":""))}catch(e){ed({message:e instanceof Error?e.message:"An unknown error occurred",type:"error"})}};return(0,d.useEffect)(()=>{(ex||eF)&&eO.reset(eA,{})},[eF,ex]),(0,i.jsx)(G.lV,{...eO,"data-sentry-element":"Form_Shadcn_","data-sentry-component":"DiskManagementForm","data-sentry-source-file":"DiskManagementForm.tsx",children:(0,i.jsxs)("form",{onSubmit:eO.handleSubmit(te),className:"flex flex-col gap-8",children:[(0,i.jsxs)(p.eh,{className:"relative flex flex-col gap-10",bottomPadding:!0,"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"DiskManagementForm.tsx",children:[(0,i.jsx)(eC.Y,{type:"default",visible:ei&&!ea,title:"Compute and Disk configuration is not available on the Free Plan",actions:(0,i.jsx)(x.I,{source:"diskManagementConfigure",plan:"Pro"}),description:"You will need to upgrade to at least the Pro Plan to configure compute and disk","data-sentry-element":"NoticeBar","data-sentry-source-file":"DiskManagementForm.tsx"}),eW||e$||eQ?(0,i.jsxs)("div",{className:"relative flex flex-col gap-10",children:[(0,i.jsx)(et,{visible:eW,title:"Your project will now automatically restart.",description:"Your project will be unavailable for up to 2 mins."}),(0,i.jsx)(eC.Y,{type:"default",visible:e$,title:"Disk configuration changes have been requested",description:"The requested changes will be applied to your disk shortly"}),(0,i.jsx)(eC.Y,{type:"default",visible:eQ,title:"You do not have permission to update disk configuration",description:"Please contact your organization administrator to update your disk configuration"})]}):null,(0,i.jsx)(B.w,{"data-sentry-element":"Separator","data-sentry-source-file":"DiskManagementForm.tsx"}),(0,i.jsx)(eV,{form:eO,disabled:eL,"data-sentry-element":"ComputeSizeField","data-sentry-source-file":"DiskManagementForm.tsx"}),!(Y||Q)&&(0,i.jsx)(B.w,{}),(0,i.jsx)(e9,{"data-sentry-element":"SpendCapDisabledSection","data-sentry-source-file":"DiskManagementForm.tsx"}),(0,i.jsx)(eC.Y,{type:"default",visible:!(Y||Q),title:"Disk configuration is only available for projects in the AWS cloud provider",description:H?"Configuring your disk for AWS (Revamped) projects is unavailable for now.":eU?"Delete and recreate your Preview Branch to configure disk size. It was deployed on an older branching infrastructure.":"The Fly Postgres offering is deprecated - please migrate your instance to the AWS cloud prov to configure your disk.","data-sentry-element":"NoticeBar","data-sentry-source-file":"DiskManagementForm.tsx"}),Y&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,i.jsx)(e6,{}),!_&&eq/eZ*100>=90&&ey&&(0,i.jsx)(Z.Z,{type:"destructive",title:"Database size is currently over 90% of disk size",description:"Your project will enter read-only mode once you reach 95% of the disk space to prevent your database from exceeding the disk limitations",children:(0,i.jsx)(h.A,{abbrev:!1,className:"mt-2",href:"".concat(F.aq,"/guides/platform/database-size#read-only-mode")})}),_&&(0,i.jsx)(Z.Z,{type:"destructive",title:"Project is currently in read-only mode",description:"You will need to manually override read-only mode and reduce the database size to below 95% of the disk size",children:(0,i.jsx)(h.A,{abbrev:!1,className:"mt-2",href:"".concat(F.aq,"/guides/platform/database-size#disabling-read-only-mode")})})]}),(0,i.jsx)(eJ,{form:eO,disableInput:eH,setAdvancedSettingsOpenState:eu}),(0,i.jsx)(B.w,{}),(0,i.jsxs)(L.Nt,{className:"-space-y-px",open:ec,onOpenChange:()=>eu(e=>!e),children:[(0,i.jsxs)(L.R6,{className:"px-8 py-3 w-full border flex items-center gap-6 rounded-t data-[state=closed]:rounded-b group justify-between",children:[(0,i.jsxs)("div",{className:"flex flex-col items-start",children:[(0,i.jsx)("span",{className:"text-sm text-foreground",children:"Advanced disk settings"}),(0,i.jsx)("span",{className:"text-sm text-foreground-light text-left",children:"Specify additional settings for your disk, including autoscaling configuration, IOPS, throughput, and disk type."})]}),(0,i.jsx)(o.A,{size:16,className:"text-foreground-light transition-all group-data-[state=open]:rotate-90",strokeWidth:1})]}),(0,i.jsxs)(L.Ke,{className:(0,E.cn)("flex flex-col gap-8 py-8 transition-all","data-[state=open]:border data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down"),children:[(0,i.jsx)("div",{className:"px-8 flex flex-col gap-y-8",children:(0,i.jsx)(eN,{form:eO})}),(0,i.jsx)(B.w,{}),(0,i.jsxs)("div",{className:"px-8 flex flex-col gap-y-8",children:[(0,i.jsx)(eC.Y,{type:"default",visible:eY,title:"Adjusting disk configuration requires LARGE Compute size or above",description:"Increase your compute size to adjust your disk's storage type, ".concat("gp3"===eO.getValues("storageType")?"IOPS, ":""," and throughput"),actions:(0,i.jsx)(q.$,{type:"default",onClick:()=>{eO.setValue("computeSize","ci_large")},children:"Change to LARGE Compute"})}),(0,i.jsx)(e2,{form:eO,disableInput:eY||eH}),(0,i.jsx)(eK,{form:eO,disableInput:eY||eH}),(0,i.jsx)(e3,{form:eO,disableInput:eY||eH})]})]})]})]})]}),(0,i.jsx)(r.N,{"data-sentry-element":"AnimatePresence","data-sentry-source-file":"DiskManagementForm.tsx",children:eX?(0,i.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.1,delay:.2},className:"z-10 w-full left-0 right-0 sticky bottom-0 bg-surface-100 border-t h-16 items-center flex",children:(0,i.jsxs)("div",{className:(0,E.cn)(p.bV,p.BS,"flex items-center gap-3 justify-end"),children:[(0,i.jsx)(U,{formState:eE}),(0,i.jsx)(q.$,{type:"default",onClick:()=>eO.reset(),disabled:!eX,size:"medium",children:"Cancel"}),(0,i.jsx)(ef,{loading:e1||e5||e7,disabled:eQ,form:eO,numReplicas:eB.length,isDialogOpen:es,onSubmit:te,setIsDialogOpen:en,message:eo})]})}):null})]})})}var tt=a(10508),ta=a(43479);let ti=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"compute-and-disk.tsx",children:(0,i.jsxs)(p.Uw,{"data-sentry-element":"ScaffoldHeader","data-sentry-source-file":"compute-and-disk.tsx",children:[(0,i.jsx)(p.Dm,{"data-sentry-element":"ScaffoldTitle","data-sentry-source-file":"compute-and-disk.tsx",children:"Compute and Disk"}),(0,i.jsx)(p.dX,{"data-sentry-element":"ScaffoldDescription","data-sentry-source-file":"compute-and-disk.tsx",children:"Configure the compute and disk settings for your project."})]})}),(0,i.jsx)(te,{"data-sentry-element":"DiskManagementForm","data-sentry-source-file":"compute-and-disk.tsx"})]});ti.getLayout=e=>(0,i.jsx)(tt.A,{children:(0,i.jsx)(ta.A,{children:e})});let ts=ti},21290:(e,t,a)=>{"use strict";a.d(t,{e:()=>d,p:()=>o});var i=a(80263),s=a(10115),n=a(37724),r=a(53239),l=a(80100);let o=r.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,i.jsx)(s.bL,{className:(0,l.cn)("grid gap-2",a),...n,ref:t})});o.displayName=s.bL.displayName;let d=r.forwardRef((e,t)=>{let{image:a,label:r,showIndicator:o=!0,...d}=e;return(0,i.jsxs)(s.q7,{ref:t,...d,className:(0,l.cn)("flex flex-col gap-2","w-48","bg-overlay","rounded-md","border","p-2","hover:border-foreground-muted","hover:z-[1] focus-visible:z-[1]","data-[state=checked]:z-[1]","data-[state=checked]:ring-2 data-[state=checked]:ring-border","data-[state=checked]:bg-surface-200 dark:data-[state=checked]:bg-surface-300","data-[state=checked]:border-foreground/50","transition-colors","group",d.className),children:[d.children,(0,i.jsxs)("label",{className:"flex gap-2 w-full",id:d.id,htmlFor:d.value,children:[o&&(0,i.jsx)("div",{className:" aspect-square h-4 w-4  rounded-full border group-data-[state=checked]:border-foreground-muted group-focus:border-foreground-muted group-hover:border-foreground-muted ring-offset-background  group-focus:outline-none  group-focus-visible:ring-2 group-focus-visible:ring-ring group-focus-visible:ring-offset-2  group-disabled:cursor-not-allowed group-disabled:opacity-50 flex items-center justify-center transition ",children:(0,i.jsx)(s.C1,{className:"flex items-center justify-center",children:(0,i.jsx)(n.A,{className:"h-2.5 w-2.5 fill-current text-current"})})}),(0,i.jsx)("div",{className:(0,l.cn)("w-full","text-xs transition-colors text-left","text-light","group-hover:text-foreground group-data-[state=checked]:text-foreground",d.disabled?"cursor-not-allowed":"cursor-pointer"),children:r})]})]})});d.displayName=s.q7.displayName},40029:(e,t,a)=>{"use strict";a.d(t,{$6:()=>f,$C:()=>d,CQ:()=>u,Fu:()=>m,HE:()=>c,T2:()=>x,Uk:()=>r,WC:()=>n,ZV:()=>v,a6:()=>h,it:()=>p,ku:()=>y,ou:()=>o,t5:()=>l,u1:()=>g});var i=a(85039),s=a(28667);let n=e=>{var t,a,i,n;let{planId:r,oldSize:l,oldStorageType:o,newSize:d,newStorageType:c,numReplicas:u=0}=e,m=null!=(i=null==(t=s.zN[o])?void 0:t.storage)?i:0,p=null!=(n=null==(a=s.zN[c])?void 0:a.storage)?n:0,{includedDiskGB:h}=null===s.Jh||void 0===s.Jh?void 0:s.Jh[r],x=Math.max(l-h[o],0)*m,g=Math.max(d-h[c],0)*p;return{oldPrice:(x+1.25*l*m*u).toFixed(2),newPrice:(g+1.25*d*p*u).toFixed(2)}},r=e=>{var t,a,i,s;let{availableOptions:n,oldComputeSize:r,newComputeSize:l,plan:o}=e,d=r;"free"!==o&&"ci_nano"===r&&(d="ci_micro");let c=null!=(i=null==n||null==(t=n.find(e=>e.identifier===d))?void 0:t.price)?i:0,u=null!=(s=null==n||null==(a=n.find(e=>e.identifier===l))?void 0:a.price)?s:0;return{oldPrice:(720*c).toFixed(2),newPrice:(720*u).toFixed(2)}},l=e=>{var t,a,i,n,r,l,o,d;let{oldStorageType:c,oldProvisionedIOPS:u,newStorageType:m,newProvisionedIOPS:p,numReplicas:h=0}=e;if(m===s.y6.GP3){let e=Math.max(0,u-s.No[s.y6.GP3].includedIops),r=Math.max(0,p-s.No[s.y6.GP3].includedIops),l=e*(null!=(i=null==(t=s.zN[c])?void 0:t.iops)?i:0),o=r*(null!=(n=null==(a=s.zN[m])?void 0:a.iops)?n:0);return{oldPrice:(l*(1+h)).toFixed(2),newPrice:(o*(1+h)).toFixed(2)}}{let e="gp3"===c?(u-s.No[c].includedIops)*s.zN[c].iops:u*(null!=(o=null==(r=s.zN[c])?void 0:r.iops)?o:0),t=p*(null!=(d=null==(l=s.zN[m])?void 0:l.iops)?d:0);return{oldPrice:(e*(1+h)).toFixed(2),newPrice:(t*(1+h)).toFixed(2)}}},o=e=>{let{storageType:t,newThroughput:a,oldThroughput:i,numReplicas:n=0}=e;if(t===s.y6.GP3&&a){let e=Math.max(0,i-s.No[s.y6.GP3].includedThroughput),t=Math.max(0,a-s.No[s.y6.GP3].includedThroughput),r=e*s.zN[s.y6.GP3].throughput,l=t*s.zN[s.y6.GP3].throughput;return{oldPrice:(r*(1+n)).toFixed(2),newPrice:(l*(1+n)).toFixed(2)}}return{oldPrice:"0.00",newPrice:"0.00"}};function d(e,t){var a,s;let n=null!=(s=null==(a=e.find(e=>"compute_instance"===e.type))?void 0:a.variants.filter(e=>{if(!t)return!0;let a=e.meta;return!a.supported_cloud_providers||a.supported_cloud_providers.includes(t)}))?s:[];return n.unshift({identifier:"ci_nano",name:"Nano",price_description:"$0/hour (~$0/month)",price:0,price_interval:"hourly",price_type:"usage",meta:{cpu_cores:i.kC.cpu_cores,cpu_dedicated:i.kC.cpu_dedicated,memory_gb:i.kC.memory_gb,baseline_disk_io_mbs:i.kC.baseline_disk_io_mbs,max_disk_io_mbs:i.kC.max_disk_io_mbs,connections_direct:i.kC.connections_direct,connections_pooler:i.kC.connections_pooler}}),n}let c=e=>Math.min(3e3*e,16e3),u=e=>Math.max(1,Math.ceil(e/500)),m=e=>Math.min(500*e,256e3),p=e=>Math.max(4,Math.ceil(e/1e3)),h=e=>Math.max(125,Math.ceil(e/.256)),x=e=>s.QL[e]||0,g=e=>{let t=Object.entries(s.QL).sort((e,t)=>e[1]-t[1]);for(let[a,i]of t)if(e<=i)return a;return t[t.length-1][0]},f=e=>({pico:"ci_pico",nano:"ci_nano",micro:"ci_micro",small:"ci_small",medium:"ci_medium",large:"ci_large",xlarge:"ci_xlarge","2xlarge":"ci_2xlarge","4xlarge":"ci_4xlarge","8xlarge":"ci_8xlarge","12xlarge":"ci_12xlarge","16xlarge":"ci_16xlarge","24xlarge":"ci_24xlarge","24xlarge_optimized_memory":"ci_24xlarge_optimized_memory","24xlarge_optimized_cpu":"ci_24xlarge_optimized_cpu","24xlarge_high_memory":"ci_24xlarge_high_memory","48xlarge":"ci_48xlarge","48xlarge_optimized_memory":"ci_48xlarge_optimized_memory","48xlarge_optimized_cpu":"ci_48xlarge_optimized_cpu","48xlarge_high_memory":"ci_48xlarge_high_memory"})[null!=e?e:"nano"],y=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ci_nano";return({ci_nano:"Nano",ci_micro:"Micro",ci_small:"Small",ci_medium:"Medium",ci_large:"Large",ci_xlarge:"XL",ci_2xlarge:"2XL",ci_4xlarge:"4XL",ci_8xlarge:"8XL",ci_12xlarge:"12XL",ci_16xlarge:"16XL",ci_24xlarge:"24XL",ci_24xlarge_optimized_memory:"24XL - Optimized Memory",ci_24xlarge_optimized_cpu:"24XL - Optimized CPU",ci_24xlarge_high_memory:"24XL - High Memory",ci_48xlarge:"48XL",ci_48xlarge_optimized_memory:"48XL - Optimized Memory",ci_48xlarge_optimized_cpu:"48XL - Optimized CPU",ci_48xlarge_high_memory:"48XL - High Memory"})[e]},v=e=>e.toLocaleString("en-US")},74713:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/settings/compute-and-disk",function(){return a(18065)}])}},e=>{e.O(0,[60858,15599,16110,27764,36538,44033,47992,36159,76984,72391,35035,40545,596,10508,48340,75187,29471,66169,90636,46593,38792],()=>e(e.s=74713)),_N_E=e.O()}]);