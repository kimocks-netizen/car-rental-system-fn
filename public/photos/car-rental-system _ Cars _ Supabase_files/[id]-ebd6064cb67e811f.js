try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="08c1aae6-1fde-4ea5-9320-e1a7e5da61e7",e._sentryDebugIdIdentifier="sentry-dbid-08c1aae6-1fde-4ea5-9320-e1a7e5da61e7")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[48340,73835],{1155:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var a=n(80263),l=n(86510),o=n(52555),r=n.n(o),s=n(73969),i=n(41591),c=n(20426),d=n(51355),u=n(80210),m=n(76984),f=n(59356),x=n(99842),p=n(13693),h=n(6843),g=n(90188);async function y(e){let{projectRef:t,connectionString:n,table:a,filters:l,roleImpersonationState:o}=e,r=(0,x.Nf)(function(e){var t;let{table:n,filters:a}=e,l=new m.Query().from(n.name,null!=(t=n.schema)?t:void 0).delete();return a.filter(e=>e.value&&""!==e.value).forEach(e=>{let t=(0,g.b)(n,e);l=l.filter(e.column,e.operator,t)}),l.toSql()}({table:a,filters:l}),o),{result:s}=await (0,f.E)({projectRef:t,connectionString:n,sql:r,isRoleImpersonationEnabled:(0,p._c)(null==o?void 0:o.role)});return s}let v=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,d.jE)();return(0,u.n)({mutationFn:e=>y(e),async onSuccess(t,n,l){let{projectRef:o,table:r}=n;await a.invalidateQueries({queryKey:h.j.tableRowsAndCount(o,r.id)}),await (null==e?void 0:e(t,n,l))},async onError(e,n,a){void 0===t?s.oR.error("Failed to delete all table rows: ".concat(e.message)):t(e,n,a)},...n})};var b=n(29445),j=n(41273),w=n(85039);async function C(e){let{projectRef:t,connectionString:n,table:a,rows:l,roleImpersonationState:o}=e,r=(0,x.Nf)(function(e){var t;let{table:n,rows:a}=e,{primaryKeys:l,error:o}=(0,g.j)({table:n});if(o)throw o;let r=new m.Query().from(n.name,null!=(t=n.schema)?t:void 0).delete();return null==l||l.forEach(e=>{let t=a.map(t=>t[e]);r=r.filter(e,"in",t)}),r.toSql()}({table:a,rows:l}),o),{result:s}=await (0,f.E)({projectRef:t,connectionString:n,sql:r,isRoleImpersonationEnabled:(0,p._c)(null==o?void 0:o.role)});return s}let N=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,d.jE)();return(0,u.n)({mutationFn:e=>C(e),async onSuccess(t,n,a){let{projectRef:o,table:r}=n;await l.invalidateQueries({queryKey:h.j.tableRowsAndCount(o,r.id)}),await (null==e?void 0:e(t,n,a))},async onError(e,n,l){if(void 0===t){let{table:t,rows:l}=n,o=e.message.includes("Please add a primary key column"),r=e.message.includes("violates foreign key constraint"),i=l.length>1;if(r){let n=t.name,l=e.message.split("on table ")[2].replaceAll('"',""),o=e.message.split("foreign key constraint")[1].split("on table")[0].replaceAll('"',""),r=i?"Unable to delete rows as one of them is currently referenced by a foreign key constraint from the table `".concat(l,"`."):"Unable to delete row as it is currently referenced by a foreign key constraint from the table `".concat(l,"`."),c="Set an on delete behavior on the foreign key relation `".concat(o,"` in the `").concat(l,"` table to automatically respond when row(s) are being deleted in the `").concat(n,"` table.");(0,s.oR)(r,{description:(0,a.jsx)(b.o,{content:c,className:"[&>p]:m-0"}),action:(0,a.jsx)("div",{className:"w-full flex gap-x-2 !mx-0 mt-3",children:(0,a.jsx)(j.A,{href:"".concat(w.aq,"/guides/database/postgres/cascade-deletes")})})})}else o?(0,s.oR)("Unable to delete row(s) as table has no primary keys",{description:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Add a primary key column to your table first to serve as a unique identifier for each row before updating or deleting the row."}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(j.A,{href:"".concat(w.aq,"/guides/database/tables#primary-keys")})})]})}):s.oR.error("Failed to delete table row: ".concat(e.message))}else t(e,n,l)},...n})};async function S(e){let{projectRef:t,connectionString:n,table:a}=e,l=function(e){var t;let{table:n}=e;return new m.Query().from(n.name,null!=(t=n.schema)?t:void 0).truncate().toSql()}({table:a}),{result:o}=await (0,f.E)({projectRef:t,connectionString:n,sql:l});return o}let k=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,d.jE)();return(0,u.n)({mutationFn:e=>S(e),async onSuccess(t,n,l){let{projectRef:o,table:r}=n;await a.invalidateQueries({queryKey:h.j.tableRowsAndCount(o,r.id)}),await (null==e?void 0:e(t,n,l))},async onError(e,n,a){void 0===t?s.oR.error("Failed to truncate table row: ".concat(e.message)):t(e,n,a)},...n})};var E=n(31582),D=n(9620),R=n(71344),A=n(98357),T=n(20033),I=n(99779),P=n(68421);let _=e=>{var t,n,o,d,u,m,f,x,h;let{selectedTable:g,onTableDeleted:y}=e,{data:b}=(0,D.YA)(),j=(0,R.ap)(),{filters:w,onApplyFilters:C}=(0,i.M)(),{mutate:S}=(0,c.T)({onSuccess:()=>{var e;if((null==(e=j.confirmationDialog)?void 0:e.type)!=="column")return;let t=j.confirmationDialog.column;(e=>{let{columnName:t}=e;C(w.filter(e=>e.column!==t))})({columnName:t.name}),s.oR.success('Successfully deleted column "'.concat(t.name,'"'))},onError:e=>{var t;if((null==(t=j.confirmationDialog)?void 0:t.type)!=="column")return;let n=j.confirmationDialog.column;s.oR.error("Failed to delete ".concat(n.name,": ").concat(e.message))},onSettled:()=>{j.closeConfirmationDialog()}}),{mutate:_}=(0,E.A)({onSuccess:async()=>{s.oR.success('Successfully deleted table "'.concat(null==g?void 0:g.name,'"')),null==y||y()},onError:e=>{s.oR.error("Failed to delete ".concat(null==g?void 0:g.name,": ").concat(e.message))},onSettled:()=>{j.closeConfirmationDialog()}}),{mutate:L,isPending:M}=N({onSuccess:()=>{var e,t,n;(null==(e=j.confirmationDialog)?void 0:e.type)==="row"&&(null==(t=(n=j.confirmationDialog).callback)||t.call(n)),s.oR.success("Successfully deleted selected row(s)")},onSettled:()=>{j.closeConfirmationDialog()}}),{mutate:z,isPending:F}=v({onSuccess:()=>{var e,t,n;(null==(e=j.confirmationDialog)?void 0:e.type)==="row"&&(null==(t=(n=j.confirmationDialog).callback)||t.call(n)),s.oR.success("Successfully deleted selected rows")},onError:e=>{s.oR.error("Failed to delete rows: ".concat(e.message))},onSettled:()=>{j.closeConfirmationDialog()}}),{mutate:O,isPending:q}=k({onSuccess:()=>{var e,t,n;(null==(e=j.confirmationDialog)?void 0:e.type)==="row"&&(null==(t=(n=j.confirmationDialog).callback)||t.call(n)),s.oR.success("Successfully deleted all rows from table")},onError:e=>{s.oR.error("Failed to delete rows: ".concat(e.message))},onSettled:()=>{j.closeConfirmationDialog()}}),G=(null==(t=j.confirmationDialog)?void 0:t.type)==="row"&&j.confirmationDialog.allRowsSelected,Q=(null==(n=j.confirmationDialog)?void 0:n.type)==="row"?j.confirmationDialog.allRowsSelected?null!=(h=j.confirmationDialog.numRows)?h:0:j.confirmationDialog.rows.length:0,V=((null==(o=j.confirmationDialog)?void 0:o.type)==="column"||(null==(d=j.confirmationDialog)?void 0:d.type)==="table")&&j.confirmationDialog.isDeleteWithCascade,$=async()=>{var e;if((null==(e=j.confirmationDialog)?void 0:e.type)!=="column"||void 0===b)return;let t=j.confirmationDialog.column;void 0!==t&&S({column:t,cascade:V,projectRef:b.ref,connectionString:null==b?void 0:b.connectionString})},K=async()=>{var e;(null==(e=j.confirmationDialog)?void 0:e.type)==="table"&&void 0!==g&&_({projectRef:null==b?void 0:b.ref,connectionString:null==b?void 0:b.connectionString,id:g.id,name:g.name,schema:g.schema,cascade:V})},W=(0,p.Qj)(),U=async()=>{var e;if(!b)return console.error("Project ref is required");if(!g)return console.error("Selected table required");if((null==(e=j.confirmationDialog)?void 0:e.type)!=="row")return;let t=j.confirmationDialog.rows;if(j.confirmationDialog.allRowsSelected)if(0===w.length){if(void 0!==W().role)return j.closeConfirmationDialog(),s.oR.error("Table truncation is not supported when impersonating a role");O({projectRef:b.ref,connectionString:b.connectionString,table:g})}else z({projectRef:b.ref,connectionString:b.connectionString,table:g,filters:w,roleImpersonationState:W()});else L({projectRef:b.ref,connectionString:b.connectionString,table:g,rows:t,roleImpersonationState:W()})};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.A,{variant:"destructive",size:"small",visible:(null==(u=j.confirmationDialog)?void 0:u.type)==="column",title:'Confirm deletion of column "'.concat((null==(m=j.confirmationDialog)?void 0:m.type)==="column"&&j.confirmationDialog.column.name,'"'),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>{j.closeConfirmationDialog()},onConfirm:$,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to delete the selected column? This action cannot be undone."}),(0,a.jsx)(A.A,{label:"Drop column with cascade?",description:"Deletes the column and its dependent objects",checked:V,onChange:()=>j.toggleConfirmationIsWithCascade(),"data-sentry-element":"Checkbox","data-sentry-source-file":"DeleteConfirmationDialogs.tsx"}),V&&(0,a.jsxs)(T.Fc,{variant:"warning",title:"Warning: Dropping with cascade may result in unintended consequences",children:[(0,a.jsx)(T.XL,{children:"All dependent objects will be removed, as will any objects that depend on them, recursively."}),(0,a.jsx)(T.TN,{children:(0,a.jsx)(I.$,{asChild:!0,size:"tiny",type:"default",icon:(0,a.jsx)(l.A,{}),children:(0,a.jsx)(r(),{href:"https://www.postgresql.org/docs/current/ddl-depend.html",target:"_blank",rel:"noreferrer",children:"About dependency tracking"})})})]})]})}),(0,a.jsx)(P.A,{variant:"destructive",size:"small",visible:(null==(f=j.confirmationDialog)?void 0:f.type)==="table",title:(0,a.jsx)("span",{className:"break-words",children:'Confirm deletion of table "'.concat(null==g?void 0:g.name,'"')}),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>{j.closeConfirmationDialog()},onConfirm:K,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,a.jsxs)("div",{"data-testid":"confirm-delete-table-modal",className:"space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Are you sure you want to delete the selected table? This action cannot be undone."}),(0,a.jsx)(A.A,{label:"Drop table with cascade?",description:"Deletes the table and its dependent objects",checked:V,onChange:()=>j.toggleConfirmationIsWithCascade(!V),"data-sentry-element":"Checkbox","data-sentry-source-file":"DeleteConfirmationDialogs.tsx"}),V&&(0,a.jsxs)(T.Fc,{variant:"warning",children:[(0,a.jsx)(T.XL,{children:"Warning: Dropping with cascade may result in unintended consequences"}),(0,a.jsx)(T.TN,{children:"All dependent objects will be removed, as will any objects that depend on them, recursively."}),(0,a.jsx)(T.TN,{className:"mt-4",children:(0,a.jsx)(I.$,{asChild:!0,size:"tiny",type:"default",icon:(0,a.jsx)(l.A,{}),children:(0,a.jsx)(r(),{href:"https://www.postgresql.org/docs/current/ddl-depend.html",target:"_blank",rel:"noreferrer",children:"About dependency tracking"})})})]})]})}),(0,a.jsx)(P.A,{variant:"destructive",size:"small",visible:(null==(x=j.confirmationDialog)?void 0:x.type)==="row",title:(0,a.jsxs)("p",{className:"break-words",children:[(0,a.jsx)("span",{children:"Confirm to delete the selected row"}),(0,a.jsx)("span",{children:Q>1&&"s"})]}),confirmLabel:"Delete",confirmLabelLoading:"Deleting",onCancel:()=>j.closeConfirmationDialog(),onConfirm:()=>U(),loading:q||M||F,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"DeleteConfirmationDialogs.tsx",children:(0,a.jsx)("div",{className:"space-y-4",children:(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:[(0,a.jsx)("span",{children:"Are you sure you want to delete "}),(0,a.jsxs)("span",{children:[G?"all":"the selected"," "]}),(0,a.jsx)("span",{children:Q>1&&"".concat(Q," ")}),(0,a.jsx)("span",{children:"row"}),(0,a.jsx)("span",{children:Q>1&&"s"}),(0,a.jsx)("span",{children:"? This action cannot be undone."})]})})})]})}},15471:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(80263);n(53239);var l=n(7981),o=n(12123);let r={tiny:14,small:16,medium:20,large:24,xlarge:32};function s(e){let{style:t,size:n="medium"}=e,s=(0,l.A)("inputErrorIcon");return(0,a.jsx)("div",{className:s.base,style:t,"data-sentry-component":"InputErrorIcon","data-sentry-source-file":"InputErrorIcon.tsx",children:(0,a.jsx)(o.A,{size:r[n],strokeWidth:2,"data-sentry-element":"AlertCircle","data-sentry-source-file":"InputErrorIcon.tsx"})})}},50298:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(80263);n(53239);var l=n(7981),o=n(80100);function r(e){let{icon:t,className:n,size:r}=e,s=(0,l.A)("inputIconContainer");return(0,a.jsx)("div",{className:(0,o.cn)(s.base,s.size[r],n),"data-sentry-component":"InputIconContainer","data-sentry-source-file":"InputIconContainer.tsx",children:t})}},57855:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>e0});var a=n(80263),l=n(53239),o=n(22891),r=n(72112),s=n(52555),i=n.n(s),c=n(80814),d=n(77395),u=n(22745),m=n(37034),f=n(52641),x=n(75204),p=n(36289),h=n(13693),g=n(71344),y=n(10247);function v(e,t){return e.indexOf(t)>=0}function b(e){let{gridRef:t,rows:n}=e,a=(0,y.Ir)(),o=(0,l.useMemo)(()=>{var e,t;return"windows"==((null==(e=navigator)?void 0:e.appVersion.indexOf("Win"))!==-1?"windows":(null==(t=navigator)?void 0:t.appVersion.indexOf("Mac"))!==-1?"macos":"unknown")?"Control":"Command"},[]);return!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],[a,o]=l.useState(),r=a=>{var l;if(!e||v(t,a.target.nodeName)||v(n,a.target.className))return;let r=(l=a).metaKey&&l.shiftKey?"Command+Shift+".concat(l.key):l.metaKey?"Command+".concat(l.key):l.shiftKey&&"Enter"===l.key?"Shift+".concat(l.key):l.ctrlKey&&l.key?"Control+".concat(l.key):l.key;e[r]&&(r.includes("+")?(a.preventDefault(),e[r](a),o(null)):(o(a.key),a.preventDefault()))},s=t=>{e&&e[t.key]&&a===t.key&&(t.preventDefault(),e[t.key](t),o(null))};l.useEffect(()=>(window.addEventListener("keydown",r),window.addEventListener("keyup",s),()=>{window.removeEventListener("keydown",r),window.removeEventListener("keyup",s)}))}({["".concat(o,"+ArrowUp")]:e=>{if(e.stopPropagation(),a.selectedCellPosition){var n,l;let e={idx:null!=(l=null==(n=a.selectedCellPosition)?void 0:n.idx)?l:0,rowIdx:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(0)})},["".concat(o,"+ArrowDown")]:e=>{if(e.stopPropagation(),a.selectedCellPosition){var l,o;let e={idx:null!=(o=null==(l=a.selectedCellPosition)?void 0:l.idx)?o:0,rowIdx:n.length>1?n.length-1:0};t.current.selectCell(e)}else t.current.scrollToCell({rowIdx:Number(n.length)})},["".concat(o,"+ArrowLeft")]:e=>{var n,l;e.stopPropagation();let o={idx:a.gridColumns.filter(e=>e.frozen).length,rowIdx:null!=(l=null==(n=a.selectedCellPosition)?void 0:n.rowIdx)?l:0};t.current.selectCell(o)},["".concat(o,"+ArrowRight")]:e=>{var n,l,o;e.stopPropagation(),null==(l=t.current)||l.selectCell({idx:a.gridColumns.length-2,rowIdx:null!=(o=null==(n=a.selectedCellPosition)?void 0:n.rowIdx)?o:0})}},["INPUT","TEXTAREA","SELECT"]),null}var j=n(92333),w=n(44705),C=n(57648),N=n(9620),S=n(79918),k=n(57672),E=n(47165),D=n(74310),R=n(73886),A=n(62284),T=n(41591),I=n(53005),P=n(80646),_=n(99779),L=n(30404),M=n(64758),z=n(68421),F=n(47773),O=n(87432);let q=[{value:100,label:"100 rows"},{value:500,label:"500 rows"},{value:1e3,label:"1000 rows"}],G=e=>{let{onRowsPerPageChange:t}=e,n=(0,g.ap)();return(0,a.jsx)(F.X,{options:q,onSelect:t,side:"top",align:"start","data-sentry-element":"DropdownControl","data-sentry-component":"RowCountSelector","data-sentry-source-file":"Pagination.tsx",children:(0,a.jsx)(_.$,{asChild:!0,type:"outline",style:{padding:"3px 10px"},"data-sentry-element":"Button","data-sentry-source-file":"Pagination.tsx",children:(0,a.jsx)("span",{children:"".concat(n.rowsPerPage," rows")})})})},Q=e=>{var t,n;let{enableForeignRowsQuery:r=!0}=e,{id:s}=(0,o.g)(),i=s?Number(s):void 0,{sorts:c}=(0,I.G)(),{filters:d}=(0,T.M)(),{data:u}=(0,N.YA)(),m=(0,g.ap)(),p=(0,y.Ir)(),v=(0,h.RY)(),{data:b}=(0,C.Pk)({projectRef:null==u?void 0:u.ref,connectionString:null==u?void 0:u.connectionString,id:i}),j=(0,f.bL)(b),w=p.page,S=(0,f.bI)(b)?b.live_rows_estimate:null,[F,q]=(0,l.useState)(w.toString()),[Q,V]=(0,l.useState)(!1),[$,K]=(0,l.useState)(!1),[W,U]=(0,l.useState)(!1),{data:Y,isLoading:H,isSuccess:B,isError:Z,isFetching:X,error:J}=(0,P.gt)({projectRef:null==u?void 0:u.ref,connectionString:null==u?void 0:u.connectionString,tableId:p.table.id,filters:d,enforceExactCount:p.enforceExactCount,roleImpersonationState:v},{keepPreviousData:!0,enabled:!j}),ee=null!=(t=null==Y?void 0:Y.count)?t:0,et=(null==Y?void 0:Y.is_estimate)?(0,O.j)(ee):ee.toLocaleString(),en=Math.ceil(ee/m.rowsPerPage),ea=ee>0?en:1,{data:el,isLoading:eo}=(0,x.vs)({projectRef:null==u?void 0:u.ref,connectionString:null==u?void 0:u.connectionString,tableId:i,sorts:c,filters:d,page:p.page,limit:m.rowsPerPage,roleImpersonationState:v},{enabled:j&&r}),er=(null!=(n=null==el?void 0:el.rows)?n:[]).length<m.rowsPerPage,es=()=>{w>1&&(p.selectedRows.size>=1?K(!0):ei())},ei=()=>{let e=w-1;p.setPage(e)},ec=()=>{let e=w+1;p.setPage(e)},ed=e=>{let t=e>en?en:e;p.setPage(t||1)},eu=e=>{let t=Number(e);m.setRowsPerPage(isNaN(t)?100:t)};return((0,l.useEffect)(()=>{q(String(w))},[w]),(0,l.useEffect)(()=>{!j&&w&&w>ea&&p.setPage(ea)},[j,w,ea]),(0,l.useEffect)(()=>{void 0!==i&&p.setEnforceExactCount(null!==S&&S<=k.k)},[i]),(0,l.useEffect)(()=>{Z&&p.enforceExactCount&&(null==J?void 0:J.code)===408&&p.setEnforceExactCount(!1)},[Z,p.enforceExactCount,null==J?void 0:J.code]),j)?(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsx)(_.$,{"aria-label":"Previous page",icon:(0,a.jsx)(E.A,{}),type:"outline",className:"px-1.5",disabled:w<=1,onClick:es}),(0,a.jsx)("p",{className:"text-xs text-foreground-light",children:"Page"}),(0,a.jsx)(M.p,{size:"tiny",className:"w-10",min:1,value:F,onChange:e=>q(e.target.value),onKeyDown:e=>{let t=Number(F);("Enter"===e.code||"NumpadEnter"===e.code)&&!Number.isNaN(t)&&t>=1&&ed(t)}}),(0,a.jsx)(_.$,{"aria-label":"Next page",icon:(0,a.jsx)(D.A,{}),type:"outline",className:"px-1.5",disabled:er||!r,loading:eo&&r,onClick:ec}),(0,a.jsx)(G,{onRowsPerPageChange:eu})]}):(0,a.jsxs)("div",{className:"flex items-center gap-x-4","data-sentry-component":"Pagination","data-sentry-source-file":"Pagination.tsx",children:[H&&(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsx)(R.A,{size:12,className:"animate-spin"}),(0,a.jsx)("p",{className:"text-xs text-foreground-light",children:"Loading records count..."})]}),B&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsx)(_.$,{"aria-label":"Previous page",icon:(0,a.jsx)(E.A,{}),type:"outline",className:"px-1.5",disabled:w<=1||H,onClick:es}),(0,a.jsx)("p",{className:"text-xs text-foreground-light",children:"Page"}),(0,a.jsx)(M.p,{className:"w-12",size:"tiny",min:1,max:en,value:F,onChange:e=>q(e.target.value),onKeyDown:e=>{let t=Number(F);("Enter"===e.code||"NumpadEnter"===e.code)&&!Number.isNaN(t)&&t>=1&&t<=en&&ed(t)}}),(0,a.jsxs)("p",{className:"text-xs text-foreground-light",children:["of ",ea.toLocaleString()]}),(0,a.jsx)(_.$,{"aria-label":"Next page",icon:(0,a.jsx)(D.A,{}),type:"outline",className:"px-1.5",disabled:w>=en||H,onClick:()=>{w<en&&(p.selectedRows.size>=1?V(!0):ec())}}),(0,a.jsx)(G,{onRowsPerPageChange:eu})]}),!j&&(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsxs)("p",{className:"text-xs text-foreground-light",children:["".concat(et," ").concat(0===ee||ee>1?"records":"record")," ",Y.is_estimate?"(estimated)":""]}),Y.is_estimate&&(0,a.jsxs)(L.m_,{children:[(0,a.jsx)(L.k$,{asChild:!0,children:(0,a.jsx)(_.$,{size:"tiny",type:"text",className:"px-1.5",loading:X,icon:(0,a.jsx)(A.A,{}),onClick:()=>{null===S||ee>k.k?U(!0):p.setEnforceExactCount(!0)}})}),(0,a.jsxs)(L.ZI,{side:"top",className:"w-72",children:["This is an estimated value as your table has more than"," ",k.k.toLocaleString()," rows. ",(0,a.jsx)("br",{}),(0,a.jsx)("span",{className:"text-brand",children:"Click to retrieve the exact count of the table."})]})]})]})]}),Z&&(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Error fetching records count. Please refresh the page."}),(0,a.jsx)(z.A,{visible:$,title:"Confirm moving to previous page",confirmLabel:"Confirm",onCancel:()=>K(!1),onConfirm:()=>{ei()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,a.jsx)(z.A,{visible:Q,title:"Confirm moving to next page",confirmLabel:"Confirm",onCancel:()=>V(!1),onConfirm:()=>{ec()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"The currently selected lines will be deselected, do you want to proceed?"})}),(0,a.jsx)(z.A,{variant:"warning",visible:W,title:"Confirm to fetch exact count for table",confirmLabel:"Retrieve exact count",onCancel:()=>U(!1),onConfirm:()=>{p.setEnforceExactCount(!0),U(!1)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Pagination.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:null===S?"If your table has a row count of greater than ".concat(k.k.toLocaleString()," rows,\n          retrieving the exact count of the table may cause performance issues on your database."):"Your table has a row count of greater than ".concat(k.k.toLocaleString()," rows, and\n          retrieving the exact count of the table may cause performance issues on your database.")})})]})},V=e=>{let{enableForeignRowsQuery:t=!0}=e,{id:n}=(0,o.g)(),l=n?Number(n):void 0,{data:r}=(0,N.YA)(),{data:s}=(0,C.Pk)({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString,id:l}),[{view:i="data"},c]=(0,S.W)(),d=(0,f.b4)(s),u=(0,f.KO)(s);return(0,a.jsxs)(j.C,{"data-sentry-element":"GridFooter","data-sentry-component":"Footer","data-sentry-source-file":"Footer.tsx",children:["data"===i&&(0,a.jsx)(Q,{enableForeignRowsQuery:t}),(0,a.jsx)("div",{className:"ml-auto flex items-center gap-x-2",children:(d||u)&&(0,a.jsx)(w.A,{width:75,options:["definition","data"],activeOption:i,borderOverride:"border",onClickOption:e=>{"data"===e?c({view:void 0}):c({view:e})}})})]})};var $=n(24560),K=n(56028),W=n(89388),U=n(30881),Y=n(48564),H=n(11018),B=n(36261),Z=n(84512),X=n(50523),J=n(80100),ee=n(16488),et=n(51355),en=n(73969),ea=n(55108),el=n(41273),eo=n(6843),er=n(76422),es=n(85039),ei=n(44168),ec=n(10723),ed=n(44725);let eu=e=>{var t,n,l,o;let{error:r}=e,{filters:s}=(0,T.M)(),{sorts:i}=(0,I.G)(),c=(null==(t=(0,y.Ir)().originalTable)?void 0:t.entity_type)===H.z.FOREIGN_TABLE&&(null==r||null==(n=r.message)?void 0:n.includes("query vault failed")),d=s.length>0&&(null==r||null==(l=r.message)?void 0:l.includes("invalid input syntax")),u=i.length>0&&(null==r||null==(o=r.message)?void 0:o.includes("identify an ordering operator"));return c?(0,a.jsx)(em,{}):d?(0,a.jsx)(ef,{error:r}):u?(0,a.jsx)(ex,{error:r}):(0,a.jsx)(ep,{error:r,"data-sentry-element":"GeneralError","data-sentry-component":"GridError","data-sentry-source-file":"GridError.tsx"})},em=()=>{let{ref:e}=(0,o.g)(),{data:t}=(0,N.YA)(),n=(null==t?void 0:t.parent_project_ref)!==void 0;return(0,a.jsxs)(ed.Z,{type:"warning",className:"pointer-events-auto",title:"Failed to retrieve rows from foreign table","data-sentry-element":"Admonition","data-sentry-component":"ForeignTableMissingVaultKeyError","data-sentry-source-file":"GridError.tsx",children:[(0,a.jsxs)("p",{children:["The key that's used to retrieve data from your foreign table is either incorrect or missing. Verify the key in your"," ",(0,a.jsx)(ec.g,{href:"/project/".concat(e,"/integrations?category=wrapper"),"data-sentry-element":"InlineLink","data-sentry-source-file":"GridError.tsx",children:"wrapper's settings"})," ","or in ",(0,a.jsx)(ec.g,{href:"/project/".concat(e,"/integrations/vault/overview"),"data-sentry-element":"InlineLink","data-sentry-source-file":"GridError.tsx",children:"Vault"}),"."]}),n&&(0,a.jsxs)("p",{children:["Note: Vault keys from the main project do not sync to branches. You may add them manually into ",(0,a.jsx)(ec.g,{href:"/project/".concat(e,"/integrations/vault/overview"),children:"Vault"})," ","if you want to query foreign tables while on a branch."]})]})},ef=e=>{let{error:t}=e,{onApplyFilters:n}=(0,T.M)();return(0,a.jsxs)(ed.Z,{type:"warning",className:"pointer-events-auto",title:"Invalid input syntax provided in filter value(s)","data-sentry-element":"Admonition","data-sentry-component":"InvalidSyntaxError","data-sentry-source-file":"GridError.tsx",children:[(0,a.jsx)("p",{className:"!mb-0",children:"Unable to retrieve results as the provided value in your filter(s) doesn't match it's column data type."}),(0,a.jsx)("p",{className:"!mb-2",children:"Verify that your filter values are correct before applying the filters again."}),(0,a.jsxs)("p",{className:"text-sm text-foreground-lighter prose max-w-full !mb-4",children:["Error: ",(0,a.jsx)("code",{className:"text-xs",children:t.message})]}),(0,a.jsx)(_.$,{type:"default",onClick:()=>n([]),"data-sentry-element":"Button","data-sentry-source-file":"GridError.tsx",children:"Remove filters"})]})},ex=e=>{var t;let{error:n}=e,{sorts:l,onApplySorts:o}=(0,I.G)(),r=(null!=(t=null==n?void 0:n.message)?t:"").split("type ").pop(),s=r.includes("json")?r.toUpperCase():r;return(0,a.jsxs)(ed.Z,{type:"warning",className:"pointer-events-auto",title:"Sorting is not supporting on ".concat(l.length>1?"one of the selected columns":"the selected column"),"data-sentry-element":"Admonition","data-sentry-component":"InvalidOrderingOperatorError","data-sentry-source-file":"GridError.tsx",children:[(0,a.jsxs)("p",{className:"!mb-0",children:["Unable to retrieve results as sorting is not supported on"," ",l.length>1?"one of the selected columns":"the selected column"," due to its data type. (",s,")"]}),(0,a.jsxs)("p",{className:"!mb-2",children:["Remove any sorts on columns with the data type ",s," applying the sorts again."]}),(0,a.jsxs)("p",{className:"text-sm text-foreground-lighter prose max-w-full !mb-4",children:["Error: ",(0,a.jsx)("code",{className:"text-xs",children:n.message})]}),(0,a.jsx)(_.$,{type:"default",onClick:()=>o([]),"data-sentry-element":"Button","data-sentry-source-file":"GridError.tsx",children:"Remove sorts"})]})},ep=e=>{let{error:t}=e,{filters:n}=(0,T.M)();return(0,a.jsx)(ei.A,{className:"pointer-events-auto",error:t,subject:"Failed to retrieve rows from table","data-sentry-element":"AlertError","data-sentry-component":"GeneralError","data-sentry-source-file":"GridError.tsx",children:n.length>0&&(0,a.jsx)("p",{children:"Verify that the filter values are correct, as the error may stem from an incorrectly applied filter"})})};var eh=n(9711),eg=n(89034);function ey(e,t){let{show:n}=(0,eh.EF)();return(0,a.jsx)($.fI,{...t,onContextMenu:function(e){n(e,{id:eg.JY,props:{rowIdx:t.rowIdx}})},"data-sentry-element":"Row","data-sentry-component":"RowRenderer","data-sentry-source-file":"RowRenderer.tsx"},e)}let ev=e=>{var t;return null!=(t=null==e?void 0:e.idx)?t:-1},eb=(0,l.memo)((0,l.forwardRef)((e,t)=>{var n,o;let{width:r,height:s,containerClass:i,gridClass:c,rowClass:d,rows:u,error:m,isDisabled:x=!1,isLoading:p,isSuccess:v,isError:b,filters:j,onApplyFilters:w}=e,C=(0,g.ap)(),S=(0,y.Ir)(),{data:k}=(0,Z.s)(),{data:E}=(0,N.YA)(),D=function(e){let t=(0,et.jE)(),{data:n}=(0,N.YA)(),o=(0,y.Ir)(),r=(0,h.Qj)(),{mutate:s}=(0,er.oG)({async onMutate(e){let{projectRef:n,table:a,configuration:l,payload:o}=e,r=new Set(Object.keys(l.identifiers)),s=eo.j.tableRows(n,{table:{id:a.id}});await t.cancelQueries({queryKey:s});let i=t.getQueriesData({queryKey:s});return t.setQueriesData({queryKey:s},e=>{var t;return{rows:null!=(t=null==e?void 0:e.rows.map(e=>Object.entries(e).filter(e=>{let[t]=e;return r.has(t)}).every(e=>{let[t,n]=e;return n===l.identifiers[t]})?{...e,...o}:e))?t:[]}}),{previousRowsQueries:i}},onError(e,n,a){var l;let{previousRowsQueries:o}=a;o.forEach(e=>{let[n,a]=e;a&&t.setQueriesData({queryKey:n},a),t.invalidateQueries({queryKey:n})}),en.oR.error(null!=(l=null==e?void 0:e.message)?l:e)}});return(0,l.useCallback)((t,l)=>{var i;if(!n)return;let c=t[l.indexes[0]],d=e.find(e=>e.idx==c.idx),u=Object.keys(c).find(e=>c[e]!==d[e]);if(!d||!u)return;let m={[u]:c[u]},x=null==(i=o.originalTable.columns)?void 0:i.filter(e=>{var t;return(null!=(t=null==e?void 0:e.enums)?t:[]).length>0&&"array"===e.data_type.toLowerCase()}).map(e=>e.name),p={};if((0,f.KO)(o.originalTable)&&o.originalTable.primary_keys.forEach(e=>{let t=o.originalTable.columns.find(t=>t.name===e.name);p[e.name]=(null==t?void 0:t.format)==="bytea"?(0,ea.ds)(d[e.name]):d[e.name]}),0===Object.keys(p).length)return(0,en.oR)("Unable to update row as table has no primary keys",{description:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Add a primary key column to your table first to serve as a unique identifier for each row before updating or deleting the row."}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)(el.A,{href:"".concat(es.aq,"/guides/database/tables#primary-keys")})})]})});s({projectRef:n.ref,connectionString:n.connectionString,table:o.originalTable,configuration:{identifiers:p},payload:m,enumArrayColumns:x,roleImpersonationState:r()})},[r,s,n,e,o.originalTable])}(u),R=(0,l.useRef)(null),A=S.page,T=S.table,I=null==(n=S.originalTable)?void 0:n.entity_type,P=I===H.z.FOREIGN_TABLE,L=0===(null!=u?u:[]).length,{mutate:M}=(0,B.h)(),{isValidFile:z,isDraggedOver:F,onDragOver:O,onFileDrop:q}=function(e){let{enabled:t,onFileDropped:n,onTelemetryEvent:a}=e,[o,r]=(0,l.useState)(!1),[s,i]=(0,l.useState)(!1),c=(0,l.useCallback)(e=>{if(!t)return;let[n]=e.dataTransfer.items;n&&"file"!==n.kind||("dragover"!==e.type||o?("dragleave"===e.type||"drop"===e.type)&&(r(!1),i(!1)):(r(!0),i("text/csv"===n.type)),e.stopPropagation(),e.preventDefault())},[t,o,s]),d=(0,l.useCallback)(e=>{if(!t)return;c(e);let[l]=e.dataTransfer.files,[o]=e.dataTransfer.items;(!o||"file"===o.kind)&&((0,X.Pz)(l)||(n(l),null==a||a("import_data_dropzone_file_added")))},[t,c,n,a]);return{isValidFile:s&&o,isDraggedOver:o,onDragOver:c,onFileDrop:d}}({enabled:L&&!P,onFileDropped:e=>C.onImportData((0,K.KR)(e)),onTelemetryEvent:e=>{var t,n;M({action:e,groups:{project:null!=(t=null==E?void 0:E.ref)?t:"Unknown",organization:null!=(n=null==k?void 0:k.slug)?n:"Unknown"}})}}),{data:G}=(0,Y.Hw)({projectRef:null==E?void 0:E.ref,connectionString:null==E?void 0:E.connectionString,schema:null!=(o=null==T?void 0:T.schema)?o:void 0});return(0,a.jsxs)("div",{className:(0,J.cn)("flex flex-col relative transition-colors",i),style:{width:r||"100%",height:s||"50vh"},children:[0===(null!=u?u:[]).length&&(0,a.jsxs)("div",{className:(0,J.cn)("absolute top-9 p-2 w-full z-[1] pointer-events-none",L&&F&&"border-2 border-dashed",z?"border-brand-600":"border-destructive-600"),style:{height:"calc(100% - 35px)"},onDragOver:O,onDragLeave:O,onDrop:q,children:[p&&!x&&(0,a.jsx)(ee.yV,{}),b&&(0,a.jsx)(eu,{error:m}),v&&(0,a.jsx)(a.Fragment,{children:A>1?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center col-span-full h-full",children:[(0,a.jsx)("p",{className:"text-sm text-light",children:"This page does not have any data"}),(0,a.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:(0,a.jsx)(_.$,{type:"default",className:"pointer-events-auto",onClick:()=>S.setPage(1),children:"Head back to first page"})})]}):0===(null!=j?j:[]).length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center col-span-full h-full",children:[(0,a.jsx)("p",{className:"text-sm text-light pointer-events-auto",children:F?z?"Drop your CSV file here":(0,a.jsx)("span",{className:"text-destructive",children:"Only CSV files are accepted"}):"This table is empty"}),I===H.z.FOREIGN_TABLE?(0,a.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:(0,a.jsx)("p",{className:"text-sm text-light pointer-events-auto",children:"This table is a foreign table. Add data to the connected source to get started."})}):!F&&(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 mt-4",children:[(0,a.jsx)(_.$,{type:"default",className:"pointer-events-auto",onClick:()=>{var e,t;C.onImportData(),M({action:"import_data_button_clicked",properties:{tableType:"Existing Table"},groups:{project:null!=(e=null==E?void 0:E.ref)?e:"Unknown",organization:null!=(t=null==k?void 0:k.slug)?t:"Unknown"}})},children:"Import data from CSV"}),(0,a.jsx)("p",{className:"text-xs text-foreground-light pointer-events-auto",children:"or drag and drop a CSV file here"})]})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center col-span-full h-full",children:[(0,a.jsx)("p",{className:"text-sm text-light pointer-events-auto",children:"The filters applied have returned no results from this table"}),(0,a.jsx)("div",{className:"flex items-center space-x-2 mt-4",children:(0,a.jsx)(_.$,{type:"default",className:"pointer-events-auto",onClick:()=>w([]),children:"Remove all filters"})})]})})]}),(0,a.jsx)($.Ay,{ref:t,className:"".concat(c," flex-grow"),rowClass:d,columns:S.gridColumns,rows:null!=u?u:[],renderers:{renderRow:ey},rowKeyGetter:ev,selectedRows:S.selectedRows,onColumnResize:S.updateColumnSize,onRowsChange:D,onSelectedCellChange:function(e){R.current=e,S.setSelectedCellPosition({idx:e.column.idx,rowIdx:e.rowIdx})},onSelectedRowsChange:function(e){S.setSelectedRows(e)},onCellDoubleClick:e=>(function(e,t){let n=function(e){var t,n;let{targetTableSchema:a,targetTableName:l,targetColumnName:o}=null!=(n=null==T||null==(t=T.columns.find(t=>t.name==e))?void 0:t.foreignKey)?n:{},r=null==G?void 0:G.find(t=>t.source_schema===(null==T?void 0:T.schema)&&t.source_table===(null==T?void 0:T.name)&&t.source_columns.includes(e)&&t.target_schema===a&&t.target_table===l&&t.target_columns.includes(null!=o?o:""));return void 0!==r?(0,U.C)([r])[0]:void 0}(t.name);n&&C.onEditForeignKeyColumnValue({foreignKey:n,row:e,column:t})})(e.row,e.column),onCellKeyDown:W.GL})]})}));var ej=n(99894),ew=n(9753),eC=n(3225),eN=n(33922),eS=n(38904),ek=n(95137),eE=n(54706);let eD=e=>{let{rows:t}=e,n=(0,g.ap)(),o=(0,y.Ir)(),r=(0,l.useCallback)(e=>{let{props:n}=e;if(!o.selectedCellPosition||!n)return;let{rowIdx:a}=n,l=t[a][o.gridColumns[o.selectedCellPosition.idx].key],r=(0,eE.x)(l);(0,eS.l)(r),en.oR.success("Copied cell value to clipboard")},[t,o.gridColumns,o.selectedCellPosition]),s=(0,l.useCallback)(e=>{let{props:n}=e,{rowIdx:a}=n,l=t[a];(0,eS.l)(JSON.stringify(l)),en.oR.success("Copied row to clipboard")},[t]);return(0,a.jsxs)(eh.W1,{id:eg.JY,animation:!1,className:"!min-w-36","data-sentry-element":"Menu","data-sentry-component":"RowContextMenu","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,a.jsxs)(eh.q7,{onClick:r,"data-sentry-element":"Item","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,a.jsx)(ew.A,{size:12,"data-sentry-element":"Copy","data-sentry-source-file":"RowContextMenu.tsx"}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Copy cell"})]}),(0,a.jsxs)(eh.q7,{onClick:s,"data-sentry-element":"Item","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,a.jsx)(ew.A,{size:12,"data-sentry-element":"Copy","data-sentry-source-file":"RowContextMenu.tsx"}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Copy row"})]}),o.editable&&(0,a.jsx)(ek.pf,{className:"my-1.5"}),(0,a.jsxs)(eh.q7,{onClick:function(e){let{props:a}=e,{rowIdx:l}=a,o=t[l];n.onEditRow(o)},hidden:!o.editable,data:"edit","data-sentry-element":"Item","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,a.jsx)(eC.A,{size:12,"data-sentry-element":"Edit","data-sentry-source-file":"RowContextMenu.tsx"}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Edit row"})]}),o.editable&&(0,a.jsx)(ek.pf,{className:"my-1.5"}),(0,a.jsxs)(eh.q7,{onClick:function(e){let{props:a}=e,{rowIdx:l}=a,o=t[l];o&&n.onDeleteRows([o])},hidden:!o.editable,data:"delete","data-sentry-element":"Item","data-sentry-source-file":"RowContextMenu.tsx",children:[(0,a.jsx)(eN.A,{size:12,"data-sentry-element":"Trash","data-sentry-source-file":"RowContextMenu.tsx"}),(0,a.jsx)("span",{className:"ml-2 text-xs",children:"Delete row"})]})]})},eR=e=>{let{title:t,children:n}=e;return(0,a.jsx)("div",{className:"mt-2 px-3 pb-2","data-sentry-component":"MsSqlAdmonition","data-sentry-source-file":"MsSqlValidation.tsx",children:(0,a.jsx)(ed.Z,{type:"warning",title:t,description:n,"data-sentry-element":"Admonition","data-sentry-source-file":"MsSqlValidation.tsx"})})},eA=()=>(0,a.jsx)(eR,{title:"Cannot sort by filtered column","data-sentry-element":"MsSqlAdmonition","data-sentry-component":"MsSqlSortWarningAdmonition","data-sentry-source-file":"MsSqlValidation.tsx",children:'Sorting only by columns filtered with "=" or "is" doesn\'t work on MSSQL tables. Pick a different sorting column, or add a column not in your filter.'}),eT=()=>(0,a.jsx)(eR,{title:"No valid sort column remaining","data-sentry-element":"MsSqlAdmonition","data-sentry-component":"MsSqlNoValidSortAdmonition","data-sentry-source-file":"MsSqlValidation.tsx",children:'All columns that can be sorted have been filtered with "=" or "is", which doesn\'t work on MSSQL tables. Remove a column from your filter to continue.'}),eI=e=>{var t;let{customHeader:n,gridProps:r,children:s}=e,{id:i}=(0,o.g)(),c=i?Number(i):void 0,{data:v}=(0,N.YA)(),j=(0,g.ap)(),w=(0,y.Ir)(),C=(0,l.useRef)(null),[S,k]=(0,l.useState)(!1),{filters:E,onApplyFilters:D}=(0,T.M)(),{sorts:R,onApplySorts:A}=(0,I.G)(),P=(0,h.RY)(),_=(0,f.H8)(w.originalTable)?(e=>{let{filters:t,sorts:n,table:a}=e;if(!(0,f.H8)(a))return{warning:null};let l=new Set(t.filter(e=>"="===e.operator||"is"===e.operator).map(e=>e.column)),o=n.length>0&&n.every(e=>l.has(e.column));if(l.size>0&&o)return{warning:"ConflictingSort",Component:eA};let r=a.columns.length>0&&a.columns.every(e=>"json"===e.data_type||l.has(e.name));return t.length>0&&r?{warning:"NoValidSortPossible",Component:eT}:{warning:null}})({filters:E,sorts:R,table:w.originalTable}):{warning:null},L=null===_.warning,{data:M,error:z,isSuccess:F,isError:O,isLoading:q,isRefetching:G}=(0,x.vs)({projectRef:null==v?void 0:v.ref,connectionString:null==v?void 0:v.connectionString,tableId:c,sorts:R,filters:E,page:w.page,limit:j.rowsPerPage,roleImpersonationState:P},{keepPreviousData:!0,enabled:L,retry:(e,t)=>{var n;return t&&(null==(n=t.message)?void 0:n.includes("does not exist"))&&A([]),!1}});(0,l.useEffect)(()=>{S||k(!0)},[]);let Q=null!=(t=null==M?void 0:M.rows)?t:p.Oj;return(0,a.jsx)(d.Q,{backend:u.t2,context:window,"data-sentry-element":"DndProvider","data-sentry-component":"SupabaseGrid","data-sentry-source-file":"SupabaseGrid.tsx",children:(0,a.jsxs)("div",{className:"sb-grid h-full flex flex-col",children:[(0,a.jsx)(ej.Y9,{customHeader:n,isRefetching:G,tableQueriesEnabled:L,"data-sentry-element":"Header","data-sentry-source-file":"SupabaseGrid.tsx"}),null!==_.warning&&(0,a.jsx)(_.Component,{}),s||(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(eb,{ref:C,...r,rows:Q,error:z,isDisabled:!L,isLoading:q,isSuccess:F,isError:O,filters:E,onApplyFilters:D}),(0,a.jsx)(V,{enableForeignRowsQuery:L}),(0,a.jsx)(b,{gridRef:C,rows:Q})]}),S&&(0,m.createPortal)((0,a.jsx)(eD,{rows:Q}),document.body)]})})};var eP=n(80090),e_=n(75674),eL=n(57384),eM=n(63335),ez=n(45550),eF=n(1155),eO=n(90065),eq=n(14360),eG=n(796),eQ=n(53931),eV=n(6894),e$=n(76857),eK=n(48303),eW=n(6436);let eU=e=>{let{entity:t}=e,{ref:n}=(0,o.g)(),r=(0,l.useRef)(null),s=(0,l.useRef)(null),{resolvedTheme:c}=(0,eG.D)(),{data:d}=(0,N.YA)(),u=(0,e$.G_)({id:null==t?void 0:t.id,projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString},{enabled:(0,f.b4)(t)}),m=(0,eV.$)({id:null==t?void 0:t.id,projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString},{enabled:(0,f.KO)(t)}),{data:x,isLoading:p}=(0,f.b4)(t)?u:m,h=(0,f.eg)(t)?"create view ".concat(t.schema,".").concat(t.name," as\n"):(0,f.rW)(t)?"create materialized view ".concat(t.schema,".").concat(t.name," as\n"):"",g=(0,l.useMemo)(()=>x?(0,eK.A)(h+x):void 0,[x]),y=async(e,t)=>{r.current=e,s.current=t,e.changeViewZones(e=>{e.addZone({afterLineNumber:0,heightInPx:4,domNode:document.createElement("div")})}),await (0,eW.wR)(500),null==e||e.focus()};return p?(0,a.jsxs)("div",{className:"h-full grid",children:[(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(eQ.yV,{})}),(0,a.jsx)("div",{className:"mt-auto",children:(0,a.jsx)(V,{})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex-grow overflow-y-auto border-t border-muted relative",children:[(0,a.jsx)(_.$,{asChild:!0,type:"default",className:"absolute top-2 right-5 z-10","data-sentry-element":"Button","data-sentry-source-file":"TableDefinition.tsx",children:(0,a.jsx)(i(),{href:"/project/".concat(n,"/sql/new?content=").concat(encodeURIComponent(null!=g?g:"")),"data-sentry-element":"Link","data-sentry-source-file":"TableDefinition.tsx",children:"Open in SQL Editor"})}),(0,a.jsx)(eq.default,{className:"monaco-editor",theme:(null==c?void 0:c.includes("dark"))?"vs-dark":"vs",onMount:y,defaultLanguage:"pgsql",value:g,path:"",options:{domReadOnly:!0,readOnly:!0,tabSize:2,fontSize:13,minimap:{enabled:!1},wordWrap:"on",fixedOverflowWidgets:!0},"data-sentry-element":"Editor","data-sentry-source-file":"TableDefinition.tsx"})]}),(0,a.jsx)(V,{"data-sentry-element":"Footer","data-sentry-source-file":"TableDefinition.tsx"})]})},eY=e=>{var t;let{isLoadingSelectedTable:n=!1,selectedTable:s}=e,d=(0,c.useRouter)(),{ref:u,id:m}=(0,o.g)(),{setLastVisitedTable:x}=(0,e_.q)(),{selectedSchema:p}=(0,eL.k)(),h=(0,ez.zv)();(0,W.ir)({projectRef:u,table:s});let[{view:g="data"}]=(0,S.W)(),{can:v}=(0,eP.Qp)(r.aG.TENANT_SQL_ADMIN_WRITE,"tables"),{can:b}=(0,eP.Qp)(r.aG.TENANT_SQL_ADMIN_WRITE,"columns"),j=m?h.openTabs.find(e=>e.endsWith(m)):void 0,w=h.openTabs.filter(e=>!e.startsWith("sql")),C=(0,l.useCallback)(e=>{d.push("/project/".concat(u,"/editor/").concat(e.id).concat(p?"?schema=".concat(p):""))},[u,d]),N=(0,l.useCallback)(async()=>{if(s){let e=(0,ez.lW)(s.entity_type,{id:s.id});h.handleTabClose({id:e,router:d,editor:"table",onClearDashboardHistory:()=>x(void 0)})}},[d,s,h]),{isSchemaLocked:k}=(0,eM.BQ)({schema:null!=(t=null==s?void 0:s.schema)?t:""});if(n||!u)return(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("div",{className:"h-10 bg-dash-sidebar dark:bg-surface-100"}),(0,a.jsx)("div",{className:"h-9 border-y"}),(0,a.jsx)("div",{className:"p-2 col-span-full",children:(0,a.jsx)(ee.yV,{})})]});let E=(0,f.eg)(s)||(0,f.rW)(s),D=(0,f.KO)(s),R=(0,f.bL)(s),A=!(!v&&!b)&&D&&!k,T=s?"".concat(s.schema,"_").concat(s.name):"unknown-table";return(0,a.jsxs)("div",{className:"h-full",onClick:()=>h.makeActiveTabPermanent(),"data-sentry-component":"TableGridEditor","data-sentry-source-file":"TableGridEditor.tsx",children:[s?(0,a.jsxs)(y.HQ,{projectRef:u,table:s,editable:A,children:[(0,a.jsx)(eI,{gridProps:{height:"100%"},customHeader:(E||D)&&"definition"===g?(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("p",{children:["SQL Definition of ",(0,a.jsx)("code",{className:"text-sm",children:s.name})," "]}),(0,a.jsx)("p",{className:"text-foreground-light text-sm",children:"(Read only)"})]}):null,children:(E||D)&&"definition"===g&&(0,a.jsx)(eU,{entity:s})},T),(0,a.jsx)(eF.A,{selectedTable:D?s:void 0,onTableDeleted:N})]},"table-editor-table-".concat(s.id)):(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsx)("div",{className:"w-[400px]",children:(0,a.jsx)(ed.Z,{type:"default",title:"Unable to find your table with ID ".concat(m),description:"This table doesn't exist in your database",children:j?(0,a.jsx)(_.$,{type:"default",className:"mt-2",onClick:()=>{h.handleTabClose({id:j,router:d,editor:"table",onClearDashboardHistory:()=>x(void 0)})},children:"Close tab"}):w.length>0?(0,a.jsx)(_.$,{asChild:!0,type:"default",className:"mt-2",onClick:()=>x(void 0),children:(0,a.jsx)(i(),{href:"/project/".concat(u,"/editor/").concat(w[0].split("-")[1]),children:"Close tab"})}):(0,a.jsx)(_.$,{asChild:!0,type:"default",className:"mt-2",onClick:()=>x(void 0),children:(0,a.jsx)(i(),{href:"/project/".concat(u,"/editor"),children:"Head back"})})})})}),(0,a.jsx)(eO.H,{editable:A,selectedTable:D||R?s:void 0,onTableCreated:C,"data-sentry-element":"SidePanelEditor","data-sentry-source-file":"TableGridEditor.tsx"})]})};var eH=n(10508),eB=n(50624),eZ=n(26048),eX=n(80230);let eJ=()=>{let{id:e,ref:t}=(0,o.g)(),n=e?Number(e):void 0,r=(0,ez.zv)(),{data:s}=(0,N.YA)(),{data:i,isLoading:c}=(0,C.Pk)({projectRef:null==s?void 0:s.ref,connectionString:null==s?void 0:s.connectionString,id:n});return(0,l.useEffect)(()=>{if(i&&t){let e=(0,ez.lW)(i.entity_type,{id:i.id});r.tabsMap[e]?r.makeTabActive(e):r.addTab({id:e,type:i.entity_type,label:i.name,metadata:{schema:i.schema,name:i.name,tableId:n}})}},[i,n,t]),(0,a.jsx)(eY,{isLoadingSelectedTable:c,selectedTable:i,"data-sentry-element":"TableGridEditor","data-sentry-component":"TableEditorPage","data-sentry-source-file":"[id].tsx"})};eJ.getLayout=e=>(0,a.jsx)(eH.A,{children:(0,a.jsx)(eB.$,{productMenu:(0,a.jsx)(eX.X,{}),product:"Table Editor",productMenuClassName:"overflow-y-hidden",children:(0,a.jsx)(eZ.A,{children:e})})});let e0=eJ},68856:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(80263);function l(e){let{body:t,head:n,className:l,containerClassName:o,borderless:r,headTrClasses:s,bodyClassName:i,style:c}=e,d=["table-container"];o&&d.push(o),r&&d.push("table-container--borderless");let u=["table"];return l&&u.push(l),(0,a.jsx)("div",{className:d.join(" "),"data-sentry-component":"Table","data-sentry-source-file":"Table.tsx",children:(0,a.jsxs)("table",{className:u.join(" "),style:c,children:[(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{className:s,children:n})}),(0,a.jsx)("tbody",{className:i,children:t})]})})}l.th=e=>{let{children:t,className:n,style:l}=e,o=["p-3 px-4 text-left"];return n&&o.push(n),(0,a.jsx)("th",{className:o.join(" "),style:l,"data-sentry-component":"Th","data-sentry-source-file":"Table.tsx",children:t})},l.td=e=>{let{children:t,colSpan:n,className:l,style:o,...r}=e;return(0,a.jsx)("td",{className:l,colSpan:n,style:o,...r,"data-sentry-component":"Td","data-sentry-source-file":"Table.tsx",children:t})},l.tr=e=>{let{children:t,className:n,onClick:l,style:o,hoverable:r}=e,s=[n];return(l||r)&&s.push("tr--link"),(0,a.jsx)("tr",{className:s.join(" "),onClick:l,style:o,"data-sentry-component":"Tr","data-sentry-source-file":"Table.tsx",children:t})};let o=l},79861:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c});var a=n(80263),l=n(72495);n(53239);var o=n(99779),r=n(30404),s=n(7981);let i=e=>{let{id:t,disabled:n,className:i,children:c,header:d,visible:u,open:m,size:f="medium",loading:x,align:p="right",hideFooter:h=!1,customFooter:g,onConfirm:y,onCancel:v,confirmText:b="Confirm",cancelText:j="Cancel",triggerElement:w,defaultOpen:C,tooltip:N,...S}=e,k=(0,s.A)("sidepanel"),E=g||(0,a.jsxs)("div",{className:k.footer,children:[(0,a.jsx)("div",{children:(0,a.jsx)(o.$,{disabled:x,type:"default",onClick:()=>v?v():null,children:j})}),!!y&&(0,a.jsxs)(r.m_,{children:[(0,a.jsx)(r.k$,{asChild:!0,children:(0,a.jsx)("span",{className:"inline-block",children:(0,a.jsx)(o.$,{htmlType:"submit",disabled:n||x,loading:x,onClick:y,children:b})})}),void 0!==N&&(0,a.jsx)(r.ZI,{side:"bottom",children:N})]})]});m=m||u;let{onOpenAutoFocus:D,onCloseAutoFocus:R,onEscapeKeyDown:A,onPointerDownOutside:T,onInteractOutside:I}=S;return(0,a.jsxs)(l.bL,{open:m,onOpenChange:function(e){void 0!==u&&!e&&v&&v()},defaultOpen:C,"data-sentry-element":"Dialog.Root","data-sentry-component":"SidePanel","data-sentry-source-file":"SidePanel.tsx",children:[w&&(0,a.jsx)(l.l9,{asChild:!0,children:w}),(0,a.jsxs)(l.ZL,{"data-sentry-element":"Dialog.Portal","data-sentry-source-file":"SidePanel.tsx",children:[(0,a.jsx)(l.hJ,{className:k.overlay,"data-sentry-element":"Dialog.Overlay","data-sentry-source-file":"SidePanel.tsx"}),(0,a.jsxs)(l.UC,{className:[k.base,k.size[f],k.align[p],i&&i].join(" "),onOpenAutoFocus:D,onCloseAutoFocus:R,onEscapeKeyDown:A,onPointerDownOutside:T,onInteractOutside:e=>{var t;(null==(t=e.target)?void 0:t.closest("#toast"))&&e.preventDefault(),I&&I(e)},...S,"data-sentry-element":"Dialog.Content","data-sentry-source-file":"SidePanel.tsx",children:[d&&(0,a.jsx)("header",{className:k.header,children:d}),(0,a.jsx)("div",{className:k.contents,children:c}),!h&&E]})]})]})};i.Content=function(e){let{children:t,className:n}=e,l=(0,s.A)("sidepanel");return(0,a.jsx)("div",{className:[l.content,n].join(" ").trim(),"data-sentry-component":"Content","data-sentry-source-file":"SidePanel.tsx",children:t})},i.Separator=function(){let e=(0,s.A)("sidepanel");return(0,a.jsx)("div",{className:e.separator,"data-sentry-component":"Separator","data-sentry-source-file":"SidePanel.tsx"})};let c=i},80421:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var a=n(80263),l=n(53239),o=n(9753),r=n(23157),s=n(15471),i=n(50298),c=n(95185),d=n(7981),u=n(38904),m=n(80100),f=n(99779),x=n(7760);function p(e){let{autoComplete:t,autoFocus:n,className:p,inputClassName:h,iconContainerClassName:g,copy:y,defaultValue:v,descriptionText:b,disabled:j,error:w,icon:C,id:N="",name:S="",inputRef:k,label:E,afterLabel:D,beforeLabel:R,labelOptional:A,layout:T,onChange:I,onBlur:P,onCopy:_,placeholder:L,type:M="text",value:z,style:F,reveal:O=!1,actions:q,size:G="medium",borderless:Q=!1,validation:V,...$}=e,[K,W]=(0,l.useState)("Copy"),[U,Y]=(0,l.useState)(!0),H=(0,d.A)("input"),{formContextOnChange:B,values:Z,errors:X,handleBlur:J,touched:ee,fieldLevelValidation:et}=(0,x.x)();Z&&!z&&(z=Z[N||S]),w||(X&&!w&&(w=X[N||S]),w=ee&&ee[N]?w:void 0),(0,l.useEffect)(()=>{V&&et(N,V(z))},[]);let en=["peer/input",H.base];return w&&en.push(H.variants.error),w||en.push(H.variants.standard),G&&en.push(H.size[G]),C&&en.push(H.with_icon),j&&en.push(H.disabled),h&&en.push(h),(0,a.jsx)(r.H,{label:E,afterLabel:D,beforeLabel:R,labelOptional:A,layout:T,id:N,error:w,descriptionText:b,style:F,size:G,className:p,"data-sentry-element":"FormLayout","data-sentry-component":"Input","data-sentry-source-file":"Input.tsx",children:(0,a.jsxs)("div",{className:H.container,children:[(0,a.jsx)("input",{"data-size":G,autoComplete:t,autoFocus:n,defaultValue:v,disabled:j,id:N,name:S,onChange:function(e){I&&I(e),B&&B(e),V&&et(N,V(e.target.value))},onBlur:function(e){J&&setTimeout(()=>{J(e)},100),P&&P(e)},onCopy:_,placeholder:L,ref:k,type:M,value:O&&U?c.ne:z,className:(0,m.cn)(en),...$}),C&&(0,a.jsx)(i.A,{size:G,icon:C,className:g}),y||w||q?(0,a.jsxs)("div",{className:H.actions_container,children:[w&&(0,a.jsx)(s.A,{size:G}),y&&!(O&&U)?(0,a.jsx)(f.$,{size:"tiny",type:"default",icon:(0,a.jsx)(o.A,{}),onClick:()=>{var e;return e=z,void(0,u.l)(e,()=>{W("Copied"),setTimeout(()=>{W("Copy")},3e3),null==_||_()})},children:K}):null,O&&U?(0,a.jsx)(f.$,{size:"tiny",type:"default",onClick:function(){Y(!1)},children:"Reveal"}):null,q&&q]}):null]})})}p.TextArea=function(e){let{className:t,textAreaClassName:n,descriptionText:i,disabled:c,error:m,icon:p,id:h="",name:g="",label:y,afterLabel:v,beforeLabel:b,labelOptional:j,layout:w,onChange:C,onBlur:N,placeholder:S,value:k,style:E,rows:D=4,limit:R,size:A,borderless:T=!1,validation:I,copy:P=!1,onCopy:_,actions:L,...M}=e,[z,F]=(0,l.useState)(0),[O,q]=(0,l.useState)("Copy"),{formContextOnChange:G,values:Q,errors:V,handleBlur:$,touched:K,fieldLevelValidation:W}=(0,x.x)();Q&&!k&&(k=Q[h||g]),m||(V&&!m&&(m=V[h||g]),m=K&&K[h||g]?m:void 0),(0,l.useEffect)(()=>{I&&W(h,I(k))},[]);let U=(0,d.A)("input"),Y=[U.base];return m&&Y.push(U.variants.error),m||Y.push(U.variants.standard),p&&Y.push(U.with_icon),A&&Y.push(U.size[A]),c&&Y.push(U.disabled),n&&Y.push(n),(0,a.jsx)(r.H,{className:t,label:y,afterLabel:v,beforeLabel:b,labelOptional:j,layout:w,id:h,error:m,descriptionText:i,style:E,size:A,"data-sentry-element":"FormLayout","data-sentry-component":"TextArea","data-sentry-source-file":"Input.tsx",children:(0,a.jsxs)("div",{className:U.container,children:[(0,a.jsx)("textarea",{disabled:c,id:h,name:g,rows:D,cols:100,placeholder:S,onChange:function(e){F(e.target.value.length),C&&C(e),G&&G(e),I&&W(h,I(e.target.value))},onBlur:function(e){$&&setTimeout(()=>{$(e)},100),N&&N(e)},onCopy:_,value:k,className:Y.join(" "),maxLength:R,...M}),P||m||L?(0,a.jsx)("div",{className:U.textarea_actions_container,children:(0,a.jsxs)("div",{className:U.textarea_actions_container_items,children:[m&&(0,a.jsx)(s.A,{size:A}),P&&(0,a.jsx)(f.$,{size:"tiny",type:"default",onClick:()=>{var e;return e=k,void(0,u.l)(e,()=>{q("Copied"),setTimeout(()=>{q("Copy")},3e3),null==_||_()})},icon:(0,a.jsx)(o.A,{}),children:O}),L&&L]})}):null]})})};let h=p},80545:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/editor/[id]",function(){return n(57855)}])},87432:(e,t,n)=>{"use strict";n.d(t,{j:()=>a});let a=e=>{if(0===e)return"0";let t=Math.floor(Math.log(e)/Math.log(1e3)),n=t>4?"T":["","K","M","B","T"][t],a=e/Math.pow(1e3,t>4?4:t);return""===n?"".concat(a):"".concat(a.toFixed(1)).concat(n)}},92333:(e,t,n)=>{"use strict";n.d(t,{C:()=>o});var a=n(80263),l=n(80100);let o=e=>{let{children:t,className:n}=e;return(0,a.jsx)("div",{"aria-label":"Table grid footer",className:(0,l.cn)("flex min-h-9 h-9 overflow-hidden overflow-x-auto items-center px-2 w-full border-t",n),"data-sentry-component":"GridFooter","data-sentry-source-file":"GridFooter.tsx",children:t})}}},e=>{e.O(0,[74335,60858,15599,16110,27764,36538,44033,2838,21436,57459,26616,652,86692,9711,47625,55754,4499,62941,76984,72391,35035,40545,596,10508,75187,29471,92544,95403,52772,84698,39831,62798,93537,90636,46593,38792],()=>e(e.s=80545)),_N_E=e.O()}]);