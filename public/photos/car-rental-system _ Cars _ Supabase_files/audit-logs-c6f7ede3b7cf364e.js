try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="25743894-9231-4a9a-af42-536e30a68af3",e._sentryDebugIdIdentifier="sentry-dbid-25743894-9231-4a9a-af42-536e30a68af3")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72458],{961:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/auth/audit-logs",function(){return r(56699)}])},37631:(e,t,r)=>{"use strict";r.d(t,{$E:()=>u,kV:()=>d,op:()=>c});var s=r(67850),a=r(51355),n=r(24523),i=r(85039),o=r(53239),l=r(31907);async function d(e,t){let{projectRef:r}=e;if(!r)throw Error("projectRef is required");let{data:s,error:a}=await (0,n.Jt)("/platform/auth/{ref}/config",{params:{path:{ref:r}},signal:t});return a&&(0,n.H4)(a),s}let c=function(e){let{projectRef:t}=e,{enabled:r=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)({queryKey:l.Z.authConfig(t),queryFn:e=>{let{signal:r}=e;return d({projectRef:t},r)},enabled:r&&i.pe&&void 0!==t,...a})},u=e=>{let{projectRef:t}=e,r=(0,a.jE)();return(0,o.useCallback)(()=>{t&&r.prefetchQuery({queryKey:l.Z.authConfig(t),queryFn:e=>{let{signal:r}=e;return d({projectRef:t},r)}})},[r,t])}},39624:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var s=r(80263),a=r(12123);let n=e=>{let{resourceText:t,isFullPage:r=!1}=e,n=()=>(0,s.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(a.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,s.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return r?(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsx)("div",{className:"w-[550px]",children:(0,s.jsx)(n,{})})}):(0,s.jsx)(n,{})}},56699:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>R});var s=r(80263),a=r(72112),n=r(64511),i=r(53239),o=r(87494),l=r(73969),d=r(86692),c=r(22891),u=r(37873),h=r(44168),m=r(10723),f=r(37631),g=r(97492),x=r(49810),y=r(80090),p=r(9620),j=r(65887),_=r(78039),A=r(72608),v=r(99779),b=r(16488),S=r(44725),L=r(44053);let w=(0,d.Ik)({AUDIT_LOG_DISABLE_POSTGRES:(0,d.zM)().required()}),E="audit_log_entries",N=()=>{var e;let{ref:t}=(0,c.g)(),{data:r}=(0,p.YA)(),{can:d}=(0,y.Qp)(a.aG.UPDATE,"custom_config_gotrue"),{data:N=[]}=(0,x.LW)({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString,includeColumns:!1,schema:"auth"}),P=N.find(e=>e.name===E),{data:D,error:F,isError:T,isLoading:C}=(0,f.op)({projectRef:t}),{mutate:k,isPending:I}=(0,g.U)({onError:e=>{l.oR.error("Failed to update audit logs: ".concat(null==e?void 0:e.message))},onSuccess:()=>{l.oR.success("Successfully updated audit logs settings")}}),O=(0,o.mN)({resolver:(0,n.t)(w),defaultValues:{AUDIT_LOG_DISABLE_POSTGRES:!1}}),{AUDIT_LOG_DISABLE_POSTGRES:G}=O.watch(),R=null!=(e=null==D?void 0:D.AUDIT_LOG_DISABLE_POSTGRES)&&e;return((0,i.useEffect)(()=>{if(D){var e;O.reset({AUDIT_LOG_DISABLE_POSTGRES:null!=(e=null==D?void 0:D.AUDIT_LOG_DISABLE_POSTGRES)&&e})}},[D]),T)?(0,s.jsx)(u.gu,{isFullWidth:!0,children:(0,s.jsx)(h.A,{error:F,subject:"Failed to retrieve auth configuration for hooks"})}):C?(0,s.jsx)(u.gu,{isFullWidth:!0,children:(0,s.jsx)(b.yV,{})}):(0,s.jsx)(u.gu,{isFullWidth:!0,"data-sentry-element":"ScaffoldSection","data-sentry-component":"AuditLogsForm","data-sentry-source-file":"AuditLogsForm.tsx",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(u.sZ,{className:"mb-4","data-sentry-element":"ScaffoldSectionTitle","data-sentry-source-file":"AuditLogsForm.tsx",children:"Settings"}),(0,s.jsx)(j.lV,{...O,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"AuditLogsForm.tsx",children:(0,s.jsx)("form",{onSubmit:O.handleSubmit(e=>{if(!t)return console.error("Project ref is required");k({projectRef:t,config:e})}),className:"space-y-4",children:(0,s.jsxs)(_.Zp,{"data-sentry-element":"Card","data-sentry-source-file":"AuditLogsForm.tsx",children:[(0,s.jsxs)(_.Wu,{"data-sentry-element":"CardContent","data-sentry-source-file":"AuditLogsForm.tsx",children:[(0,s.jsx)(j.zB,{control:O.control,name:"AUDIT_LOG_DISABLE_POSTGRES",render:e=>{let{field:r}=e;return(0,s.jsx)(L.M,{layout:"flex-row-reverse",label:"Write audit logs to the database",description:(0,s.jsxs)("p",{className:"text-sm prose text-foreground-lighter max-w-full",children:["When enabled, audit logs are written to the"," ",(0,s.jsx)(m.g,{target:"_blank",rel:"noopener noreferrer",href:"/project/".concat(t,"/editor/").concat(null==P?void 0:P.id),children:(0,s.jsx)("code",{className:"text-xs bg-surface-200 px-1 py-0.5 rounded",children:E})})," ","table.",(0,s.jsx)("br",{}),"You can disable this to reduce disk usage while still accessing logs through the"," ",(0,s.jsx)(m.g,{href:"/project/".concat(t,"/logs/explorer?q=select%0A++cast(timestamp+as+datetime)+as+timestamp%2C%0A++event_message%2C+metadata+%0Afrom+auth_audit_logs+%0Alimit+10%0A"),children:"Auth logs"}),"."]}),children:(0,s.jsx)(j.MJ,{children:(0,s.jsx)(A.d,{checked:!r.value,onCheckedChange:e=>r.onChange(!e),disabled:!d})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"AuditLogsForm.tsx"}),!R&&G&&(0,s.jsx)(S.Z,{type:"warning",className:"mt-4",title:"Disabling PostgreSQL storage will not automatically migrate or transfer existing audit log data",children:(0,s.jsxs)("p",{className:"!mb-0 !leading-normal prose text-foreground-light text-sm max-w-full",children:["Future audit logs will only appear in the project's"," ",(0,s.jsx)(m.g,{target:"_blank",rel:"noopener noreferrer",href:"/project/".concat(t,"/logs/explorer?q=select%0A++cast(timestamp+as+datetime)+as+timestamp%2C%0A++event_message%2C+metadata+%0Afrom+auth_audit_logs+%0Alimit+10%0A"),children:"auth logs"}),". You are responsible for backing up, copying, or migrating existing data from the ",(0,s.jsx)("code",{children:E})," table if needed."]})})]}),(0,s.jsxs)(_.wL,{className:"justify-end space-x-2","data-sentry-element":"CardFooter","data-sentry-source-file":"AuditLogsForm.tsx",children:[O.formState.isDirty&&(0,s.jsx)(v.$,{type:"default",onClick:()=>O.reset(),children:"Cancel"}),(0,s.jsx)(v.$,{type:"primary",htmlType:"submit",disabled:!d||I||!O.formState.isDirty,loading:I,"data-sentry-element":"Button","data-sentry-source-file":"AuditLogsForm.tsx",children:"Save changes"})]})]})})})]})})};var P=r(87442),D=r(10508),F=r(8750),T=r(41273),C=r(39624),k=r(53931),I=r(85039);let O=()=>{let{can:e,isSuccess:t}=(0,y.Qp)(a.aG.READ,"custom_config_gotrue");return t&&!e?(0,s.jsx)(C.A,{isFullPage:!0,resourceText:"access your project's audit logs settings"}):(0,s.jsx)(u.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"AuditLogsPage","data-sentry-source-file":"audit-logs.tsx",children:t?(0,s.jsx)(N,{}):(0,s.jsx)(u.gu,{isFullWidth:!0,children:(0,s.jsx)(k.yV,{})})})},G=[(0,s.jsx)(T.A,{href:"".concat(I.aq,"/guides/auth/audit-logs")},"docs")];O.getLayout=e=>(0,s.jsx)(D.A,{children:(0,s.jsx)(P.A,{children:(0,s.jsx)(F.M,{title:"Audit Logs",subtitle:"Track and monitor auth events in your project",secondaryActions:G,children:e})})});let R=O},64511:(e,t,r)=>{"use strict";r.d(t,{t:()=>n});var s=r(17085),a=r(87494);function n(e,t,r){return void 0===t&&(t={}),void 0===r&&(r={}),function(n,i,o){try{return Promise.resolve(function(a,l){try{var d=(t.context,Promise.resolve(e["sync"===r.mode?"validateSync":"validate"](n,Object.assign({abortEarly:!1},t,{context:i}))).then(function(e){return o.shouldUseNativeValidation&&(0,s.w)({},o),{values:r.raw?n:e,errors:{}}}))}catch(e){return l(e)}return d&&d.then?d.then(void 0,l):d}(0,function(e){var t;if(!e.inner)throw e;return{values:{},errors:(0,s.H)((t=!o.shouldUseNativeValidation&&"all"===o.criteriaMode,(e.inner||[]).reduce(function(e,r){if(e[r.path]||(e[r.path]={message:r.message,type:r.type}),t){var s=e[r.path].types,n=s&&s[r.type];e[r.path]=(0,a.Gb)(r.path,t,e,r.type,n?[].concat(n,r.message):r.message)}return e},{})),o)}}))}catch(e){return Promise.reject(e)}}}},87442:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var s=r(80263),a=r(80814),n=r(22891),i=r(91958),o=r(93873),l=r(37631),d=r(2657),c=r(9497),u=r(29471),h=r(1458);let m=()=>{let e=(0,a.useRouter)(),{ref:t="default"}=(0,n.g)(),r=(0,n._P)("authOverviewPage"),c=(0,n._P)("EnableOAuth21"),u=(0,i.hN)(),{authenticationSignInProviders:m,authenticationRateLimits:f,authenticationEmails:g,authenticationMultiFactor:x,authenticationAttackProtection:y,authenticationAdvanced:p}=(0,d.x)(["authentication:sign_in_providers","authentication:rate_limits","authentication:emails","authentication:multi_factor","authentication:attack_protection","authentication:advanced"]);(0,l.$E)({projectRef:t});let j=e.pathname.split("/")[4];return(0,s.jsx)(o.l,{page:j,menu:(0,h.B)(t,{authenticationSignInProviders:m,authenticationRateLimits:f,authenticationEmails:g,authenticationMultiFactor:x,authenticationAttackProtection:y,authenticationAdvanced:p,authenticationShowOverview:r,authenticationShowSecurityNotifications:u,authenticationOauth21:c}),"data-sentry-element":"ProductMenu","data-sentry-component":"AuthProductMenu","data-sentry-source-file":"AuthLayout.tsx"})},f=(0,c.r)(e=>{let{children:t}=e;return(0,s.jsx)(u.k,{title:"Authentication",product:"Authentication",productMenu:(0,s.jsx)(m,{}),isBlocking:!1,"data-sentry-element":"ProjectLayout","data-sentry-component":"AuthLayout","data-sentry-source-file":"AuthLayout.tsx",children:t})})}},e=>{e.O(0,[60858,15599,16110,27764,36538,44033,86692,76984,72391,35035,40545,596,10508,48340,75187,29471,8750,50143,90636,46593,38792],()=>e(e.s=961)),_N_E=e.O()}]);