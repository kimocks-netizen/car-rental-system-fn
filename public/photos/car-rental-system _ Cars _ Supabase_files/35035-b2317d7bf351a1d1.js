try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="00e1e827-e6cc-4afa-a48b-52c2629d9919",e._sentryDebugIdIdentifier="sentry-dbid-00e1e827-e6cc-4afa-a48b-52c2629d9919")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[35035],{286:(e,t,a)=>{a.d(t,{h:()=>s});let s=[{name:"Dark",value:"dark"},{name:"Light",value:"light"},{name:"Classic Dark",value:"classic-dark"},{name:"System",value:"system"}]},3272:(e,t,a)=>{a.d(t,{P:()=>o,u:()=>i});var s=a(67850),r=a(48621),n=a(32598);async function o(){let{error:e,data:t}=await r.j2.mfa.getAuthenticatorAssuranceLevel();if(e)throw e;return t}let i=function(){let{enabled:e=!0,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.I)({queryKey:n.e.aaLevel(),queryFn:()=>o(),staleTime:18e5,...t})}},9497:(e,t,a)=>{a.d(t,{r:()=>y});var s=a(80263),r=a(80814),n=a(53239),o=a(73969),i=a(22891),l=a(95130),c=a(10723),d=a(68421),u=a(27695);let h=e=>{let{visible:t,onClose:a,redirectToSignIn:r}=e;return(0,n.useEffect)(()=>{t&&l.Cp(Error("Session error detected"))},[t]),(0,s.jsx)(d.A,{visible:t,title:"Session timed out",confirmLabel:"Sign in again",onCancel:a,onConfirm:r,alert:{base:{variant:"warning"},title:"Your session has timed out",description:"Please try signing in again. If you are not able to sign in again, please contact Support."},"data-sentry-element":"ConfirmationModal","data-sentry-component":"SessionTimeoutModal","data-sentry-source-file":"SessionTimeoutModal.tsx",children:(0,s.jsxs)("div",{className:"space-y-4 text-sm text-foreground-light",children:[(0,s.jsxs)("ul",{className:"list-disc pl-1.5 list-inside space-y-1 text-sm text-foreground-light",children:[(0,s.jsx)("li",{children:"Try with a different browser"}),(0,s.jsx)("li",{children:"Disable browser extensions that block network requests"}),(0,s.jsx)("li",{children:(0,s.jsx)("button",{title:"Clear storage and reload",className:"underline",onClick:()=>{try{localStorage.clear(),sessionStorage.clear()}catch(e){o.oR.error("Failed to clear browser storage")}window.location.reload()},children:"Clear your browser storage"})})]}),(0,s.jsxs)("p",{children:["If none of these steps work, please"," ",(0,s.jsx)(u.Y,{className:c.L,queryParams:{subject:"Session timed out"},"data-sentry-element":"SupportLink","data-sentry-source-file":"SessionTimeoutModal.tsx",children:"Contact support"}),"."]}),(0,s.jsxs)("p",{children:["Consider"," ",(0,s.jsx)(c.g,{href:"https://github.com/orgs/supabase/discussions/36540","data-sentry-element":"InlineLink","data-sentry-source-file":"SessionTimeoutModal.tsx",children:"generating a HAR file"})," ","from your session to help Support pinpoint the issue."]})]})})};var m=a(95742),p=a(3272),g=a(13770),x=a(85039),f=a(5652);function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{useHighestAAL:!0};if(!x.pe)return e;let a=a=>{let l=(0,r.useRouter)(),c=(0,g.R)(),{isLoading:d,session:u}=(0,i.As)(),f=(0,n.useRef)(null),[y,b]=(0,n.useState)(!1),{isLoading:j,data:w,isError:v,error:k}=(0,p.u)();(0,n.useEffect)(()=>{v&&o.oR.error("Failed to fetch authenticator assurance level: ".concat(null==k?void 0:k.message,". Try refreshing your browser, or reach out to us via a support ticket if the issue persists"))},[v,k]);let{isError:S,error:N}=(0,m.m)();(0,n.useEffect)(()=>{S&&o.oR.error("Failed to fetch permissions: ".concat(null==N?void 0:N.message,". Try refreshing your browser, or reach out to us via a support ticket if the issue persists"))},[S,N]);let C=!d&&!j,T=(0,n.useCallback)(()=>{let e=location.pathname;if(x.o2&&(e=e.replace(x.o2,"")),"/sign-in"===e)return;let t=new URLSearchParams(location.search);t.set("returnTo",e),c().finally(()=>{l.push("/sign-in?".concat(t.toString()))})},[l,c]);(0,n.useEffect)(()=>(C?f.current&&(clearTimeout(f.current),f.current=null):f.current=setTimeout(()=>{b(!0)},1e4),()=>{f.current&&clearTimeout(f.current)}),[C,l,T]);let A=!t.useHighestAAL||(null==w?void 0:w.currentLevel)===(null==w?void 0:w.nextLevel),I=C&&(!u||!A);return(0,n.useEffect)(()=>{I&&(f.current&&(clearTimeout(f.current),f.current=null),T())},[T,I]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h,{visible:y,onClose:()=>b(!1),redirectToSignIn:T,"data-sentry-element":"SessionTimeoutModal","data-sentry-source-file":"withAuth.tsx"}),(0,s.jsx)(e,{...a,"data-sentry-element":"InnerComponent","data-sentry-source-file":"withAuth.tsx"})]})};return a.displayName="withAuth(".concat(e.displayName,")"),(0,f.H)(e)&&(a.getLayout=e.getLayout),a}},18068:(e,t,a)=>{a.d(t,{V:()=>i,l:()=>l});var s=a(80210),r=a(73969),n=a(24523),o=a(85039);async function i(e){let{bucket:t,filenames:a}=e,s=await (0,n.We)(),r=t?JSON.stringify({filenames:a,bucket:t}):JSON.stringify({filenames:a});try{let e=await fetch("".concat(o.o2,"/api/generate-attachment-url"),{method:"POST",headers:s,body:r});if(!e.ok){let t=e.status,a=await e.text();throw Error("Failed to generate attachment URLs at endpoint: ".concat(t," ").concat(a))}return await e.json()}catch(e){return[]}}let l=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,s.n)({mutationFn:e=>i(e),async onSuccess(t,a,s){await (null==e?void 0:e(t,a,s))},async onError(e,a,s){void 0===t?r.oR.error("Failed to generate attachment URLS: ".concat(e.message)):t(e,a,s)},...a})}},21890:(e,t,a)=>{a.d(t,{C0:()=>d,Vw:()=>u,XJ:()=>h});var s=a(91075),r=a(51355),n=a(53239),o=a(24523),i=a(34983),l=a(4359);async function c(e,t,a){let{slug:s,limit:r=96,page:n=0,sort:i="name_asc",search:l="",statuses:c=[]}=e;if(!s)throw Error("Slug is required");let d=0===l.length?void 0:l,u=0===c.length?void 0:c.join(","),{data:h,error:m}=await (0,o.Jt)("/platform/organizations/{slug}/projects",{params:{path:{slug:s},query:{limit:r,offset:n*r,sort:i,search:d,statuses:u}},signal:t,headers:a});return m&&(0,o.H4)(m),h}let d=function(e){let{slug:t,limit:a=96,sort:r="name_asc",search:n,statuses:o=[]}=e,{enabled:d=!0,...u}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{profile:h}=(0,i.xc)();return(0,s.q)({queryKey:l.g.infiniteListByOrg(t,{limit:a,sort:r,search:n,statuses:o}),queryFn:e=>{let{signal:s,pageParam:i}=e;return c({slug:t,limit:a,page:i,sort:r,search:n,statuses:o},s)},enabled:d&&void 0!==h&&void 0!==t,staleTime:18e5,getNextPageParam(e,t){let s=t.length;if(!(s*a>=e.pagination.count))return s},...u})},u=e=>{let t=e.databases.find(t=>t.identifier===e.ref);return null==t?void 0:t.infra_compute_size},h=()=>{let e=(0,r.jE)();return{invalidateProjectsQuery:(0,n.useCallback)(()=>e.invalidateQueries({queryKey:[l.L]}),[e])}}},37771:(e,t,a)=>{a.d(t,{O:()=>r});var s=a(38937);let r=()=>(0,s.UU)("https://obuldanrptloktxcffvn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9idWxkYW5ycHRsb2t0eGNmZnZuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTg2MTQ2ODUsImV4cCI6MjAzNDE5MDY4NX0.NFt49g6DFkc1X5khCzN5p01iAVo2TMxlx88cY1V0E2M",{auth:{persistSession:!1,autoRefreshToken:!1,multiTab:!1,detectSessionInUrl:!1,localStorage:{getItem:e=>void 0,setItem:(e,t)=>{},removeItem:e=>{}}}})},39148:(e,t,a)=>{a.d(t,{Nj:()=>i,qM:()=>l});var s=a(56028),r=a(12532),n=a(22891);let o=(0,s.BX)({activeDocsSection:["introduction"],docsLanguage:"js",showProjectApiDocs:!1,showCreateBranchModal:!1,showAiSettingsModal:!1,showConnectDialog:!1,ongoingQueriesPanelOpen:!1,mobileMenuOpen:!1,showSidebar:!0,showEditorPanel:!1,lastRouteBeforeVisitingAccountPage:"",activeDocsSection:["introduction"],docsLanguage:"js",showProjectApiDocs:!1,setShowProjectApiDocs:e=>{o.showProjectApiDocs=e},setActiveDocsSection:e=>{o.activeDocsSection=e},setDocsLanguage:e=>{o.docsLanguage=e},isOptedInTelemetry:!1,setIsOptedInTelemetry:e=>{o.isOptedInTelemetry=null!==e&&e,null!==e&&localStorage.setItem(n.rS.TELEMETRY_CONSENT,e.toString())},isMfaEnforced:!1,setIsMfaEnforced:e=>{o.isMfaEnforced=e},showCreateBranchModal:!1,setShowCreateBranchModal:e=>{o.showCreateBranchModal=e},showAiSettingsModal:!1,setShowAiSettingsModal:e=>{o.showAiSettingsModal=e},showSidebar:!0,setShowSidebar:e=>{o.showSidebar=e},showOngoingQueriesPanelOpen:!1,setOnGoingQueriesPanelOpen:e=>{o.ongoingQueriesPanelOpen=e},mobileMenuOpen:!1,setMobileMenuOpen:e=>{o.mobileMenuOpen=e},lastRouteBeforeVisitingAccountPage:"",setLastRouteBeforeVisitingAccountPage:e=>{o.lastRouteBeforeVisitingAccountPage=e}}),i=()=>(0,s.P9)(o),l=e=>(0,r.s)(o,e)},53931:(e,t,a)=>{a.d(t,{yV:()=>c,Ay:()=>d});var s=a(80263),r=a(22891),n=a(53239);let o=null;var i=a(80100);let l=e=>{let{className:t,delayIndex:a=0,animationDelay:l=150}=e,c=function(e){let t=(0,n.useRef)(null);return(0,r.Es)(()=>{let e=document.getAnimations().filter(e=>e instanceof CSSAnimation&&"shimmer"===e.animationName),a=e.find(e=>e.effect instanceof KeyframeEffect&&e.effect.target===t.current);if(void 0===a)return;let s=e[0];return a===s&&o&&(a.currentTime=o),a!==s&&(a.currentTime=s.currentTime),()=>{a===s&&a.currentTime&&(o=Number(a.currentTime))}},[]),t}(0);return(0,s.jsx)("div",{ref:c,className:(0,i.cn)("shimmering-loader rounded py-3",t),style:{animationFillMode:"backwards",animationDelay:"".concat(a*l,"ms")},"data-sentry-component":"ShimmeringLoader","data-sentry-source-file":"ShimmeringLoader.tsx"})},c=()=>(0,s.jsxs)("div",{className:"space-y-2","data-sentry-component":"GenericSkeletonLoader","data-sentry-source-file":"ShimmeringLoader.tsx",children:[(0,s.jsx)(l,{"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"ShimmeringLoader.tsx"}),(0,s.jsx)(l,{className:"w-3/4",delayIndex:1,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"ShimmeringLoader.tsx"}),(0,s.jsx)(l,{className:"w-1/2",delayIndex:2,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"ShimmeringLoader.tsx"})]}),d=l},54952:(e,t,a)=>{a.d(t,{X:()=>v});var s=a(80263),r=a(73886),n=a(41121),o=a(91487),i=a(796),l=a(52555),c=a.n(l),d=a(80814),u=a(96422),h=a(85039),m=a(2657),p=a(34983),g=a(39148),x=a(21162),f=a(99779),y=a(286),b=a(91898),j=a(53123),w=a(91958);function v(){let e=(0,d.useRouter)(),{theme:t,setTheme:a}=(0,i.D)(),l=(0,g.qM)(),v=(0,m.x)("profile:show_email"),{username:k,avatarUrl:S,primaryEmail:N,isLoading:C}=(0,p.JX)();(0,b.sU)(),(0,j.y)();let{openFeaturePreviewModal:T}=(0,w.j_)();return(0,s.jsxs)(x.rI,{"data-sentry-element":"DropdownMenu","data-sentry-component":"UserDropdown","data-sentry-source-file":"UserDropdown.tsx",children:[(0,s.jsx)(x.ty,{asChild:!0,className:"border flex-shrink-0 px-3","data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"UserDropdown.tsx",children:(0,s.jsx)(f.$,{type:"default",className:"[&>span]:flex px-0 py-0 rounded-full overflow-hidden h-8 w-8","data-sentry-element":"Button","data-sentry-source-file":"UserDropdown.tsx",children:C?(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)(r.A,{className:"animate-spin text-foreground-lighter",size:16})}):(0,s.jsx)(u.p,{alt:k,src:S,className:"w-8 h-8 rounded-md"})})}),(0,s.jsxs)(x.SQ,{side:"bottom",align:"end","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"UserDropdown.tsx",children:[h.pe&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"px-2 py-1 flex flex-col gap-0 text-sm",children:!!k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{title:k,className:"w-full text-left text-foreground truncate",children:k}),N!==k&&v&&(0,s.jsx)("span",{title:N,className:"w-full text-left text-foreground-light text-xs truncate",children:N})]})}),(0,s.jsx)(x.mB,{}),(0,s.jsxs)(x.I,{children:[(0,s.jsx)(x._2,{className:"flex gap-2",asChild:!0,children:(0,s.jsxs)(c(),{href:"/account/me",onClick:()=>{"/account/me"!==e.pathname&&l.setLastRouteBeforeVisitingAccountPage(e.asPath)},children:[(0,s.jsx)(n.A,{size:14,strokeWidth:1.5,className:"text-foreground-lighter"}),"Account preferences"]})}),(0,s.jsxs)(x._2,{className:"flex gap-2",onClick:T,onSelect:T,children:[(0,s.jsx)(o.A,{size:14,strokeWidth:1.5,className:"text-foreground-lighter"}),"Feature previews"]}),(0,s.jsx)(x.mB,{})]})]}),(0,s.jsxs)(x.I,{"data-sentry-element":"DropdownMenuGroup","data-sentry-source-file":"UserDropdown.tsx",children:[(0,s.jsx)(x.lp,{"data-sentry-element":"DropdownMenuLabel","data-sentry-source-file":"UserDropdown.tsx",children:"Theme"}),(0,s.jsx)(x.Hr,{value:t,onValueChange:e=>{a(e)},"data-sentry-element":"DropdownMenuRadioGroup","data-sentry-source-file":"UserDropdown.tsx",children:y.h.map(e=>(0,s.jsx)(x.Ht,{value:e.value,children:e.name},e.value))})]}),h.pe&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x.mB,{}),(0,s.jsx)(x.I,{children:(0,s.jsx)(x._2,{onSelect:()=>{e.push("/logout")},children:"Log out"})})]})]})]})}},68421:(e,t,a)=>{a.d(t,{A:()=>d,R:()=>c});var s=a(80263),r=a(53239),n=a(95137),o=a(80100),i=a(99779),l=a(44725);let c=(0,r.forwardRef)((e,t)=>{let{title:a,description:c,size:d="small",visible:u,onCancel:h,onConfirm:m,loading:p,cancelLabel:g="Cancel",confirmLabel:x="Submit",confirmLabelLoading:f,alert:y,children:b,variant:j="default",disabled:w,className:v,...k}=e,[S,N]=(0,r.useState)(void 0!==p&&p);return(0,r.useEffect)(()=>{u&&void 0===p&&N(!1)},[u]),(0,r.useEffect)(()=>{void 0!==p&&N(p)},[p]),(0,s.jsx)(n.lG,{open:u,...k,onOpenChange:()=>{u&&h()},children:(0,s.jsxs)(n.Cf,{ref:t,className:"p-0 gap-0 pb-5 !block",size:d,children:[(0,s.jsxs)(n.c7,{className:(0,o.cn)("border-b"),padding:"small",children:[(0,s.jsx)(n.L3,{children:a}),c&&(0,s.jsx)(n.rr,{children:c})]}),y&&(0,s.jsx)(l.Z,{type:j,label:y.title,description:y.description,className:"border-r-0 border-l-0 rounded-none -mt-px [&_svg]:ml-0.5 mb-0",...null==y?void 0:y.base}),b&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.OO,{padding:"small",className:v,children:b}),(0,s.jsx)(n.pf,{})]}),(0,s.jsxs)("div",{className:"flex gap-2 px-5 pt-5",children:[(0,s.jsx)(i.$,{size:"medium",block:!0,type:"default",disabled:S,onClick:()=>h(),children:g}),(0,s.jsx)(i.$,{block:!0,size:"medium",type:"destructive"===j?"danger":"warning"===j?"warning":"primary",htmlType:"submit",loading:S,disabled:S||w,onClick:e=>{e.preventDefault(),e.stopPropagation(),m(),void 0===p&&N(!0)},className:"truncate",children:x})]})]})})});c.displayName="ConfirmationModal";let d=c},75878:(e,t,a)=>{a.d(t,{w:()=>i});var s=a(80263),r=a(22949),n=a(53239),o=a(80100);let i=n.forwardRef((e,t)=>{let{className:a,orientation:n="horizontal",decorative:i=!0,...l}=e;return(0,s.jsx)(r.b,{ref:t,decorative:i,orientation:n,className:(0,o.cn)("shrink-0 bg-border-muted","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",a),...l})});i.displayName=r.b.displayName},93566:(e,t,a)=>{a.d(t,{R:()=>Y});var s=a(80263),r=a(60656),n=a(63159),o=a(53239),i=a(27695),l=a(61548),c=a(99779),d=a(56404),u=a(88712),h=a(97507),m=a(4206),p=a(68152),g=a(71545),x=a(23417),f=a(98531),y=a(61785),b=a(80814),j=a(73969),w=a(22891),v=a(10723),k=a(67850),S=a(24523),N=a(85039);async function C(e,t){let{prompt:a}=e;if(!a)return null;let s=await (0,S.We)({"Content-Type":"application/json"}),r=await (0,S.x8)("".concat(N.o2,"/api/ai/feedback/classify"),{method:"POST",body:JSON.stringify({prompt:a}),headers:s,credentials:"include",signal:t});if(!r.ok){let{error:e}=await r.json();(0,S.H4)("object"==typeof e?e:"string"==typeof e?{message:e}:{message:"Unknown error"})}return(await r.json()).feedback_category}let T=function(e){let{prompt:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,k.I)({queryKey:["feedback-category",t],queryFn:e=>{let{signal:a}=e;return C({prompt:t},a)},enabled:a&&!!t,...s})};var A=a(80210);async function I(e){let{message:t,pathname:a,projectRef:s,organizationSlug:r}=e,{data:n,error:o}=await (0,S.bE)("/platform/feedback/send",{body:{message:t,category:"Feedback",tags:["dashboard-feedback"],projectRef:s,organizationSlug:r,pathname:a}});return o&&(0,S.H4)(o),n}let D=function(){let{onError:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,A.n)({mutationFn:e=>I(e),async onError(t,a,s){void 0===e?j.oR.error("Failed to submit feedback: ".concat(t.message)):e(t,a,s)},...t})};var F=a(36261),L=a(28202),E=a(84512),_=a(6436),M=a(34983),R=a(34634),P=a(80100),O=a(21162),U=a(44725),z=a(37771),W=a(18068);let B=e=>{let t="image/png",a=atob(e.substr("data:".concat(t,";base64,").length)),s=[];for(let e=0;e<a.length;e+=1024){let t=a.slice(e,e+1024),r=Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);let n=new Uint8Array(r);s.push(n)}return new Blob(s,{type:t})},q=async e=>{let{image:t,userId:a}=e;if(!a)return void console.error("[FeedbackWidget > uploadAttachment] Unable to upload screenshot, missing user ID");let s=(0,z.O)(),r=B(t),n="".concat(a,"/").concat((0,_.gZ)(),".png"),{data:o,error:i}=await s.storage.from("feedback-attachments").upload(n,r,{cacheControl:"3600"});return i||!o?void console.error("Failed to upload screenshot attachment:",i):(await (0,W.V)({bucket:"feedback-attachments",filenames:[o.path]}))[0]},V=e=>{let{onClose:t}=e,a=(0,b.useRouter)(),{profile:r}=(0,M.xc)(),{ref:n,slug:y}=(0,w.g)(),{data:k}=(0,E.s)(),S=(0,o.useRef)(null),[C,A]=(0,o.useState)(""),[I,z]=(0,o.useState)(!1),[W,V]=(0,o.useState)(!1),[Y,H]=(0,o.useState)(!1),Q=(0,d.d7)(C,500),[$,G]=(0,L.U)(w.rS.FEEDBACK_WIDGET_CONTENT,null),[X,Z,{isSuccess:K}]=(0,L.U)(w.rS.FEEDBACK_WIDGET_SCREENSHOT,null),{data:ee}=T({prompt:Q}),{mutate:et}=(0,F.h)(),{mutate:ea}=D({onSuccess:()=>{H(!0),A(""),Z(null),z(!1)},onError:e=>{j.oR.error("Failed to submit feedback: ".concat(e.message)),z(!1)}}),es=async()=>{V(!0),await (0,_.wR)(100),(0,m.$E)(document.body,{filter:function(e){var t;return!((null!=(t=null==e?void 0:e.children)?t:[]).length>0)||"feedback-widget"!==e.children[0].id}}).then(e=>Z(e)).catch(()=>j.oR.error("Failed to capture screenshot")).finally(()=>V(!1))},er=async e=>{e.persist();let[t]=e.target.files||e.dataTransfer.items,a=new FileReader;a.onload=function(e){var t;let a=null==(t=e.target)?void 0:t.result;"string"==typeof a&&Z(a)},a.readAsDataURL(t),e.target.value=""},en=async()=>{let[e]=await navigator.clipboard.read();if(void 0===X&&"image/png"===e.types[0]){let t=await e.getType("image/png"),a=new FileReader;a.onload=function(e){var t;let a=null==(t=e.target)?void 0:t.result;"string"==typeof a&&Z(a)},a.readAsDataURL(t)}},eo=async()=>{if(0===C.length&&void 0!==X)return j.oR.error("Please include a message in your feedback.");if(C.length>0){z(!0);let e=X&&(null==r?void 0:r.gotrue_id)?await q({image:X,userId:r.gotrue_id}):void 0;ea({projectRef:n,organizationSlug:y,message:void 0!==e?"".concat(C,"\n\nAttachments:\n").concat(e):C,pathname:a.asPath})}};return(0,o.useEffect)(()=>{$&&A($),X&&Z(X)},[K]),(0,o.useEffect)(()=>{Q.length>0&&G(Q)},[Q]),Y?(0,s.jsx)(J,{onClose:t,"data-sentry-element":"ThanksMessage","data-sentry-component":"FeedbackWidget","data-sentry-source-file":"FeedbackWidget.tsx"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"px-5 pb-4",children:(0,s.jsx)(R.f,{placeholder:"It would be great if...",rows:5,value:C,onChange:e=>A(e.target.value),onPaste:en,className:"text-sm mt-4 mb-1","data-sentry-element":"TextArea_Shadcn_","data-sentry-source-file":"FeedbackWidget.tsx"})}),(0,s.jsx)(u.N,{"data-sentry-element":"AnimatePresence","data-sentry-source-file":"FeedbackWidget.tsx",children:"support"===ee&&(0,s.jsx)(h.P.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},exit:{opacity:0,y:16},transition:{duration:.25},children:(0,s.jsx)(U.Z,{type:"caution",title:"This looks like an issue that's better handled by support",className:"rounded-none border-x-0 border-b-0 mb-0 [&>h5]:text-xs [&>h5]:mb-0.5",children:(0,s.jsxs)("p",{className:"text-xs text-foreground-light !leading-tight",children:["Please"," ",(0,s.jsx)(i.Y,{className:(0,P.cn)(v.L,"text-foreground-light hover:text-foreground"),queryParams:{projectRef:y,message:C},children:"open a support ticket"})," ","to get help with this issue, as we do not reply to all product feedback."]})})},"support-alert")})]}),(0,s.jsx)(l.zT,{"data-sentry-element":"PopoverSeparator_Shadcn_","data-sentry-source-file":"FeedbackWidget.tsx"}),(0,s.jsxs)("div",{className:"px-5 flex flex-row justify-between items-start mt-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-foreground",children:"Have a technical issue?"}),(0,s.jsxs)("p",{className:"text-xs text-foreground-light",children:["Contact"," ",(0,s.jsx)(i.Y,{"data-sentry-element":"SupportLink","data-sentry-source-file":"FeedbackWidget.tsx",children:(0,s.jsx)("span",{className:"cursor-pointer text-brand-link transition-colors hover:text-brand-600",children:"support"})})," ","or"," ",(0,s.jsx)("a",{href:"".concat(N.aq),target:"_blank",rel:"noreferrer",children:(0,s.jsx)("span",{className:"cursor-pointer text-brand-link transition-colors hover:text-brand-600",children:"see docs"})}),"."]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-row",children:[X?(0,s.jsx)("div",{style:{backgroundImage:'url("'.concat(X,'")')},onClick:()=>{let e=B(X),t=URL.createObjectURL(e);window.open(t,"_blank")},className:"cursor-pointer rounded h-[26px] w-[26px] border border-control relative bg-cover bg-center bg-no-repeat",children:(0,s.jsx)("button",{className:"cursor-pointer rounded-full bg-red-900 h-3 w-3 flex items-center justify-center absolute -top-1 -right-1",onClick:e=>{e.stopPropagation(),Z(null)},children:(0,s.jsx)(p.A,{size:8,strokeWidth:3})})}):(0,s.jsxs)(O.rI,{children:[(0,s.jsx)(O.ty,{asChild:!0,children:(0,s.jsx)(c.$,{type:"default",disabled:W,loading:W,className:"w-7",icon:(0,s.jsx)(g.A,{size:14})})}),(0,s.jsxs)(O.SQ,{side:"bottom",align:"end",className:"w-fit",children:[(0,s.jsxs)(O._2,{className:"flex gap-2",onSelect:()=>{S.current&&S.current.click()},children:[(0,s.jsx)(x.A,{size:14}),"Upload screenshot"]},"upload-screenshot"),(0,s.jsx)(O.mB,{}),(0,s.jsxs)(O._2,{className:"flex gap-2",onSelect:()=>es(),children:[(0,s.jsx)(f.A,{size:14}),"Capture screenshot"]},"capture-screenshot")]})]}),(0,s.jsx)("input",{type:"file",ref:S,className:"hidden",accept:"image/png",onChange:er}),(0,s.jsx)(c.$,{disabled:0===C.length||I,loading:I,onClick:()=>{eo(),et({action:"send_feedback_button_clicked",groups:{project:n,organization:null==k?void 0:k.slug}})},"data-sentry-element":"Button","data-sentry-source-file":"FeedbackWidget.tsx",children:"Send"})]})]})]})},J=e=>{let{onClose:t}=e;return(0,s.jsx)("div",{className:"px-0 pt-3 pb-0","data-sentry-component":"ThanksMessage","data-sentry-source-file":"FeedbackWidget.tsx",children:(0,s.jsxs)("div",{className:"grid gap-3",children:[(0,s.jsxs)("div",{className:"px-6 grid gap-3 py-2 text-center text-foreground-light",children:[(0,s.jsx)(y.A,{className:"mx-auto text-brand-500",size:24,"data-sentry-element":"CircleCheck","data-sentry-source-file":"FeedbackWidget.tsx"}),(0,s.jsx)("p",{className:"text-foreground text-base",children:"Your feedback has been sent. Thanks!"}),(0,s.jsx)("p",{className:"text-sm ",children:"We do not always respond to feedback. If you require assistance, please contact support instead."})]}),(0,s.jsx)(l.zT,{"data-sentry-element":"PopoverSeparator_Shadcn_","data-sentry-source-file":"FeedbackWidget.tsx"}),(0,s.jsxs)("div",{className:"flex items-center justify-between px-4",children:[(0,s.jsx)("p",{className:"text-xs text-foreground-light",children:(0,s.jsx)(i.Y,{"data-sentry-element":"SupportLink","data-sentry-source-file":"FeedbackWidget.tsx",children:(0,s.jsx)("span",{className:"cursor-pointer text-brand transition-colors hover:text-brand-600",children:"Create a Support Ticket"})})}),(0,s.jsx)(c.$,{type:"default",onClick:t,"data-sentry-element":"Button","data-sentry-source-file":"FeedbackWidget.tsx",children:"Close"})]})]})})},Y=e=>{let{className:t}=e,[a,d]=(0,o.useState)(!1),[u,h]=(0,o.useState)("select");return(0,s.jsxs)(l.AM,{modal:!1,open:a,onOpenChange:e=>{d(e),e||h("select")},"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"FeedbackDropdown","data-sentry-source-file":"FeedbackDropdown.tsx",children:[(0,s.jsx)(l.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"FeedbackDropdown.tsx",children:(0,s.jsx)(c.$,{asChild:!0,onClick:()=>{d(e=>!e),h("select")},type:"text",className:"rounded-full h-[32px] text-foreground-light hover:text-foreground","data-sentry-element":"Button","data-sentry-source-file":"FeedbackDropdown.tsx",children:(0,s.jsx)("span",{className:t,children:"Feedback"})})}),(0,s.jsxs)(l.hl,{side:"bottom",align:"end",className:"px-0 flex flex-col pt-1 pb-3 w-96",id:"feedback-widget","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"FeedbackDropdown.tsx",children:["select"===u&&(0,s.jsxs)("div",{className:"flex flex-col gap-4 p-4",children:[(0,s.jsx)("div",{className:"font-medium text-sm",children:"What would you like to share?"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsx)(c.$,{type:"default",className:"h-32",onClick:()=>d(!1),asChild:!0,children:(0,s.jsx)(i.Y,{children:(0,s.jsxs)("span",{className:"grid gap-1 text-center",children:[(0,s.jsx)(r.A,{size:"28",className:"mx-auto text-destructive-600"}),(0,s.jsx)("span",{className:"text-base",children:"Issue"}),(0,s.jsx)("span",{className:"text-xm text-foreground-lighter",children:"with my project"})]})})}),(0,s.jsx)(c.$,{type:"default",className:"h-32",onClick:()=>h("widget"),children:(0,s.jsxs)("span",{className:"grid gap-1 text-center",children:[(0,s.jsx)(n.A,{size:"28",className:"mx-auto text-warning"}),(0,s.jsx)("span",{className:"text-base",children:"Idea"}),(0,s.jsx)("span",{className:"text-xm text-foreground-lighter",children:"to improve Supabase"})]})})]})]}),"widget"===u&&(0,s.jsx)(V,{onClose:()=>d(!1)})]})]})}}}]);