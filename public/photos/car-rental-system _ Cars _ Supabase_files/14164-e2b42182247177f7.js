try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="48776bd4-d03b-4ab9-b344-28da39dc663a",e._sentryDebugIdIdentifier="sentry-dbid-48776bd4-d03b-4ab9-b344-28da39dc663a")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[14164],{14164:(e,t,a)=>{a.d(t,{A:()=>eb});var l=a(80263),n=a(72112),r=a(53434),s=a.n(r),i=a(53667),d=a.n(i),o=a(53923),u=a(52555),c=a.n(u),m=a(80814),p=a(53239),b=a(73969),f=a(22891),y=a(70610),x=a(59615),g=a(72432),h=a(27371),_=a(99779),v=a(80100),j=a(30404);let N=(0,a(86848).A)("Columns3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),w={MAX_PROMPT_LENGTH:500},k=["Recipe sharing app","Event ticketing system","Fitness tracker","Learning management platform"];var T=a(24523),A=a(28202),q=a(85039),E=function(e){return e.AI="ai",e.TEMPLATE="template",e}({}),P=function(e){return e.CONTROL="control",e.AI="ai",e.TEMPLATES="templates",e.ASSISTANT="assistant",e}({});let z=e=>null!=e,C=e=>{if((e=>e.isPrimary||"id"===e.name)(e))return"Primary key"},I=e=>({bigint:"int8",integer:"int4",smallint:"int2",boolean:"bool",text:"text",varchar:"varchar",uuid:"uuid",timestamp:"timestamp",timestamptz:"timestamptz","timestamp with time zone":"timestamptz",date:"date",time:"time",timetz:"timetz","time with time zone":"timetz",json:"json",jsonb:"jsonb",numeric:"numeric",real:"float4","double precision":"float8",bytea:"bytea"})[e.toLowerCase()]||"text",L=e=>Array.isArray(e.tables)?e.tables.map((e,t)=>{if(!e)return null;let a="string"==typeof e.name&&e.name.trim().length>0?e.name:"table_".concat(t+1),l=(Array.isArray(e.columns)?e.columns:[]).map((e,t)=>{var a,l,n;if(!e)return null;let r="string"==typeof e.name&&e.name.trim().length>0?e.name:"column_".concat(t+1);return{name:r,type:I("string"==typeof e.type&&e.type.trim().length>0?e.type:"text"),nullable:null!=(a=e.isNullable)?a:void 0,unique:null!=(l=e.isUnique)?l:void 0,default:null!=(n=e.defaultValue)?n:void 0,description:C({...e,name:r}),isPrimary:e.isPrimary||"id"===r||void 0}}).filter(z);return 0!==l.length||e.name?{tableName:a,fields:l,rationale:"string"==typeof e.description?e.description:void 0,source:E.AI}:null}).filter(z):[],S=e=>{try{return JSON.parse(e)}catch(e){return null}};function M(e){let t=e.fields.map((t,a)=>{var l;let n=!0===t.isPrimary||"id"===t.name,r="id"===t.name&&t.type.toLowerCase().includes("int")&&!t.default,s=t.default?String(t.default):null;return{id:"column-".concat(a),name:t.name,format:t.type,defaultValue:s,isNullable:!1!==t.nullable,isUnique:null!=(l=t.unique)&&l,isIdentity:r,isPrimaryKey:n,comment:t.description||"",isNewColumn:!0,table:e.tableName,schema:"public",check:null,isArray:!1,isEncrypted:!1}});return{name:e.tableName,comment:e.rationale||"",columns:t}}var R=a(51982);let U=e=>{let{onSelectTable:t,disabled:a}=e,[n,r]=(0,p.useState)(""),s=(0,p.useRef)(null),i=(0,R.n)(),{generateTables:d,isGenerating:u,error:c,prompt:m,tables:f,setPrompt:y}=(()=>{let[e,t]=(0,p.useState)(!1),[a,l]=(0,p.useState)(null),[n,r]=(0,A.M)("table-quickstart-ai-results",{prompt:"",tables:[]}),s=(0,p.useRef)(null),i=(0,p.useRef)(!0);(0,p.useEffect)(()=>(i.current=!0,()=>{i.current=!1,s.current&&s.current.abort()}),[]);let d=(0,p.useCallback)(async e=>{if(s.current&&s.current.abort(),e.length>w.MAX_PROMPT_LENGTH){let e="Your description is too long. Try shortening it to under ".concat(w.MAX_PROMPT_LENGTH," characters.");return l(e),b.oR.error("Description too long",{description:e}),[]}let a=new AbortController;s.current=a,t(!0),l(null),r({prompt:e,tables:[]});try{let t=await (0,T.We)();t.set("Content-Type","application/json");let n=await (0,T.x8)("".concat(q.o2,"/api/ai/table-quickstart/generate-schemas"),{method:"POST",headers:t,body:JSON.stringify({prompt:e}),signal:a.signal});if(!n.ok){let e=await n.json().catch(()=>({error:"Unable to generate table schema. Try again with a different description."})),t=(null==e?void 0:e.error)||"Unable to generate table schema. Try again with a different description.";return i.current&&l(t),b.oR.error("Unable to generate tables",{description:t}),[]}if(!n.body)throw Error("Response body is null");let s=n.body.getReader(),d=new TextDecoder,o="",u={};try{for(;;){let{done:t,value:a}=await s.read();if(t)break;if((o+=d.decode(a,{stream:!0})).length>51200)throw Error("Response too large");let l=S(o);if(l){Object.assign(u,l);let t=L(u);i.current&&t.length>0&&r({prompt:e,tables:t})}}}finally{s.releaseLock()}o+=d.decode();let c=S(o),m=c?c.tables.map(e=>({tableName:e.name,fields:e.columns.map(e=>{var t,a,l;return{name:e.name,type:I(e.type),nullable:null!=(t=e.isNullable)?t:void 0,unique:null!=(a=e.isUnique)?a:void 0,default:null!=(l=e.defaultValue)?l:void 0,description:C(e),isPrimary:e.isPrimary||"id"===e.name||void 0}}),rationale:e.description,source:E.AI})):L(u);return i.current&&(l(null),r({prompt:e,tables:m})),m}catch(t){if(t instanceof Error&&"AbortError"===t.name)return[];let e=t instanceof Error?t.message:"Unable to generate tables. Please try again.";return i.current&&l(e),b.oR.error("Unable to generate tables",{description:e}),[]}finally{i.current&&t(!1),s.current=null}},[]),o=(0,p.useCallback)(()=>{s.current&&(s.current.abort(),s.current=null),t(!1),l(null),r({prompt:"",tables:[]})},[]),u=(0,p.useCallback)(e=>{r(t=>({...t,prompt:e}))},[r]);return{generateTables:d,isGenerating:e,error:a,prompt:n.prompt,tables:n.tables,setPrompt:u,clearTables:o}})(),x=null!=m?m:"",P=null!=f?f:[];(0,p.useEffect)(()=>{s.current&&s.current.focus()},[]),(0,p.useEffect)(()=>{x&&P.length>0&&r(x)},[]);let z=(0,p.useCallback)(e=>{i("table_quickstart_template_clicked",{tableName:e.tableName,columnCount:e.fields.length,source:"ai"}),t(M(e)),b.oR.success("Applied ".concat(e.tableName," template. You can customize the fields below."),{duration:3e3})},[t,i]),U=(0,p.useCallback)(async function(){let{promptOverride:e,wasQuickIdea:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=null!=e?e:x;if(a.trim()&&!u){i("table_quickstart_ai_prompt_submitted",{promptLength:a.length,wasQuickIdea:t});try{let e=await d(a);i("table_quickstart_ai_generation_completed",{success:e.length>0,tablesGenerated:e.length,promptLength:a.length}),r(a)}catch(e){i("table_quickstart_ai_generation_completed",{success:!1,tablesGenerated:0,promptLength:a.length,errorMessage:e instanceof Error?e.message:"Unknown error"})}}},[x,d,u,i]),W=(0,p.useCallback)(e=>{i("table_quickstart_quick_idea_clicked",{ideaText:e}),y(e),U({promptOverride:e,wasQuickIdea:!0})},[U,y,i]);return(0,l.jsxs)("div",{className:"rounded-lg border border-default bg-surface-100 p-6 transition-all hover:border-foreground-muted","data-sentry-component":"QuickstartAIWidget","data-sentry-source-file":"QuickstartAIWidget.tsx",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)(g.M,{size:16,loading:!1,"data-sentry-element":"AiIconAnimation","data-sentry-source-file":"QuickstartAIWidget.tsx"}),(0,l.jsx)("h3",{className:"text-base font-medium",children:"Generate tables with AI"})]}),(0,l.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Describe your app and AI will create a complete table schema."})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(h.p,{ref:s,placeholder:"Describe your app (e.g., 'recipe sharing app')",value:x,onChange:e=>y(e.target.value),onKeyDown:e=>{"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),x.trim()&&U())},disabled:u||a,"aria-label":"Table description for AI generation",className:"pr-24","data-sentry-element":"Input","data-sentry-source-file":"QuickstartAIWidget.tsx"}),(0,l.jsx)(_.$,{type:"default",size:"tiny",disabled:!x.trim()||u||a,onClick:()=>U(),icon:(0,l.jsx)(g.M,{loading:u}),className:"absolute right-1 top-1/2 -translate-y-1/2 !space-x-1","data-sentry-element":"Button","data-sentry-source-file":"QuickstartAIWidget.tsx",children:u?"Generating...":x===n&&P.length>0?"Regenerate":"Generate"})]}),c&&(0,l.jsx)("div",{className:"text-sm text-red-600",role:"alert",children:c}),0===P.length&&(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"text-xs text-foreground-light mb-2",children:"Quick ideas:"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:k.map(e=>(0,l.jsxs)("button",{onClick:()=>W(e),disabled:u||a,"aria-label":"Generate table for ".concat(e),className:(0,v.cn)("flex items-center gap-1.5 px-2 py-1 rounded-md text-xs border border-default","hover:border-foreground-muted hover:bg-surface-200","disabled:opacity-50 disabled:cursor-not-allowed","transition-all"),children:[(0,l.jsx)(g.M,{size:12}),(0,l.jsx)("span",{children:e})]},e))})]}),P.length>0&&(0,l.jsx)("div",{className:"grid gap-2",children:P.map(e=>(0,l.jsx)("button",{onClick:()=>z(e),disabled:a,"aria-label":"Select ".concat(e.tableName," template with ").concat(e.fields.length," fields"),className:(0,v.cn)("text-left p-3 rounded-md border transition-colors w-full bg-surface-100","border-light hover:border-default hover:bg-surface-200 cursor-pointer","disabled:opacity-50 disabled:cursor-not-allowed"),children:(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[(0,l.jsx)("div",{className:"rounded-full bg-alternative border w-8 h-8 flex items-center justify-center flex-shrink-0",children:(0,l.jsx)(o.A,{size:16,className:"text-foreground"})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-foreground mb-0",children:e.tableName}),e.rationale&&(0,l.jsx)("div",{className:"text-xs text-foreground-light mt-0.5",children:e.rationale})]}),(0,l.jsxs)(j.m_,{children:[(0,l.jsx)(j.k$,{asChild:!0,children:(0,l.jsxs)("div",{className:"flex items-center gap-1 text-sm text-foreground-muted ml-3",children:[(0,l.jsx)(N,{size:14,"aria-hidden":"true"}),(0,l.jsx)("span",{children:e.fields.length})]})}),(0,l.jsxs)(j.ZI,{children:[e.fields.length," ",1===e.fields.length?"column":"columns"]})]})]})},"ai:".concat(e.tableName)))})]})]})};var W=a(64382);let Q={"Social Network":[{tableName:"profiles",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"user_id",type:"uuid",nullable:!1,unique:!0},{name:"username",type:"text",nullable:!0,unique:!0},{name:"display_name",type:"text",nullable:!0},{name:"avatar_url",type:"text",nullable:!0},{name:"bio",type:"text",nullable:!0},{name:"location",type:"text",nullable:!0},{name:"website",type:"text",nullable:!0},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"},{name:"updated_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Stores user profile details such as name, avatar, and bio",source:E.TEMPLATE},{tableName:"posts",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"author_id",type:"uuid",nullable:!1},{name:"content",type:"text",nullable:!1},{name:"image_url",type:"text",nullable:!0},{name:"likes_count",type:"int4",nullable:!1,default:"0"},{name:"comments_count",type:"int4",nullable:!1,default:"0"},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"},{name:"updated_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Stores user posts, images, and engagement counts",source:E.TEMPLATE},{tableName:"follows",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"follower_id",type:"uuid",nullable:!1},{name:"following_id",type:"uuid",nullable:!1},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Tracks relationships between followers and followed users",source:E.TEMPLATE}],"E-commerce":[{tableName:"products",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"name",type:"text",nullable:!1},{name:"slug",type:"text",nullable:!1,unique:!0},{name:"description",type:"text",nullable:!0},{name:"price",type:"numeric",nullable:!1},{name:"compare_at_price",type:"numeric",nullable:!0},{name:"cost",type:"numeric",nullable:!0},{name:"sku",type:"text",nullable:!0,unique:!0},{name:"barcode",type:"text",nullable:!0},{name:"stock_quantity",type:"int4",nullable:!1,default:"0"},{name:"weight",type:"numeric",nullable:!0},{name:"published",type:"bool",nullable:!1,default:"false"},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"},{name:"updated_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Stores product details, pricing, and stock levels",source:E.TEMPLATE},{tableName:"orders",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"order_number",type:"text",nullable:!1,unique:!0},{name:"customer_id",type:"uuid",nullable:!1},{name:"status",type:"text",nullable:!1,default:"pending"},{name:"subtotal",type:"numeric",nullable:!1},{name:"tax",type:"numeric",nullable:!1,default:"0"},{name:"shipping",type:"numeric",nullable:!1,default:"0"},{name:"total",type:"numeric",nullable:!1},{name:"notes",type:"text",nullable:!0},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"},{name:"updated_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Manages customer orders, payment totals, and statuses",source:E.TEMPLATE},{tableName:"cart_items",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"user_id",type:"uuid",nullable:!1},{name:"product_id",type:"uuid",nullable:!1},{name:"quantity",type:"int4",nullable:!1,default:"1"},{name:"added_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Tracks products added to customer shopping carts",source:E.TEMPLATE}],Blog:[{tableName:"articles",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"title",type:"text",nullable:!1},{name:"slug",type:"text",nullable:!1,unique:!0},{name:"content",type:"text",nullable:!0},{name:"excerpt",type:"text",nullable:!0},{name:"cover_image",type:"text",nullable:!0},{name:"author_id",type:"uuid",nullable:!1},{name:"status",type:"text",nullable:!1,default:"'draft'"},{name:"published_at",type:"timestamptz",nullable:!0},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"},{name:"updated_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Stores blog posts with author, status, and publish dates",source:E.TEMPLATE},{tableName:"categories",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"name",type:"text",nullable:!1},{name:"slug",type:"text",nullable:!1,unique:!0},{name:"description",type:"text",nullable:!0},{name:"color",type:"text",nullable:!0},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Organizes articles into categories or tags for filtering",source:E.TEMPLATE},{tableName:"comments",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"article_id",type:"uuid",nullable:!1},{name:"author_name",type:"text",nullable:!1},{name:"author_email",type:"text",nullable:!1},{name:"content",type:"text",nullable:!1},{name:"approved",type:"bool",nullable:!1,default:"false"},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Stores reader comments and approval status for moderation",source:E.TEMPLATE}],"To-Do List":[{tableName:"tasks",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"title",type:"text",nullable:!1},{name:"description",type:"text",nullable:!0},{name:"completed",type:"bool",nullable:!1,default:"false"},{name:"priority",type:"text",nullable:!0,default:"medium"},{name:"due_date",type:"date",nullable:!0},{name:"user_id",type:"uuid",nullable:!1},{name:"list_id",type:"uuid",nullable:!0},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"},{name:"updated_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Stores user tasks with priorities, due dates, and status",source:E.TEMPLATE},{tableName:"lists",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"name",type:"text",nullable:!1},{name:"description",type:"text",nullable:!0},{name:"color",type:"text",nullable:!0},{name:"icon",type:"text",nullable:!0},{name:"user_id",type:"uuid",nullable:!1},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"},{name:"updated_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Groups tasks into named lists for better organization",source:E.TEMPLATE},{tableName:"subtasks",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"task_id",type:"uuid",nullable:!1},{name:"title",type:"text",nullable:!1},{name:"completed",type:"bool",nullable:!1,default:"false"},{name:"position",type:"int4",nullable:!1,default:"0"},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Tracks smaller subtasks linked to a main task",source:E.TEMPLATE}],Analytics:[{tableName:"events",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"user_id",type:"uuid",nullable:!0},{name:"session_id",type:"text",nullable:!0},{name:"event_type",type:"text",nullable:!1},{name:"properties",type:"jsonb",nullable:!0},{name:"user_agent",type:"text",nullable:!0},{name:"ip_address",type:"text",nullable:!0},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Captures user events and properties for analytics tracking",source:E.TEMPLATE},{tableName:"page_views",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"user_id",type:"uuid",nullable:!0},{name:"session_id",type:"text",nullable:!0},{name:"path",type:"text",nullable:!1},{name:"referrer",type:"text",nullable:!0},{name:"duration",type:"int4",nullable:!0},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Tracks user page views, referrers, and session info",source:E.TEMPLATE},{tableName:"metrics",fields:[{name:"id",type:"uuid",nullable:!1,isPrimary:!0,default:"gen_random_uuid()"},{name:"metric_name",type:"text",nullable:!1},{name:"value",type:"numeric",nullable:!1},{name:"tags",type:"jsonb",nullable:!0},{name:"timestamp",type:"timestamptz",nullable:!1,default:"now()"},{name:"aggregation_period",type:"text",nullable:!0},{name:"created_at",type:"timestamptz",nullable:!1,default:"now()"}],rationale:"Stores aggregated metrics and KPIs with timestamps",source:E.TEMPLATE}]},O=Object.keys(Q),D=e=>{let{onSelectTemplate:t,disabled:a}=e,[n,r]=(0,p.useState)(null),s=(0,R.n)();(0,p.useEffect)(()=>{null===n&&O.length>0&&r(O[0])},[n]);let i=(0,p.useCallback)(e=>{r(e),s("table_quickstart_category_clicked",{categoryName:e})},[s]),d=(0,p.useCallback)(e=>{s("table_quickstart_template_clicked",{tableName:e.tableName,columnCount:e.fields.length,source:"templates",categoryName:null!=n?n:"Unknown"}),t(M(e)),b.oR.success("Applied ".concat(e.tableName," template. You can customize the fields below."),{duration:3e3})},[t,s,n]),u=n&&Q[n]||[];return(0,l.jsxs)("div",{className:"rounded-lg border border-default bg-surface-100 p-6 transition-all hover:border-foreground-muted","data-sentry-component":"QuickstartTemplatesWidget","data-sentry-source-file":"QuickstartTemplatesWidget.tsx",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,l.jsx)(W.A,{size:16,className:"text-foreground","data-sentry-element":"Layers","data-sentry-source-file":"QuickstartTemplatesWidget.tsx"}),(0,l.jsx)("h3",{className:"text-base font-medium",children:"Table quickstarts"})]}),(0,l.jsx)("p",{className:"text-sm text-foreground-lighter",children:"Select a pre-built schema to get started quickly."})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:O.map(e=>(0,l.jsx)("button",{onClick:()=>i(e),disabled:a,role:"tab","aria-selected":n===e,"aria-label":"".concat(e," templates category"),className:(0,v.cn)("px-3 py-1.5 rounded-md text-sm capitalize border transition-all",n===e?"border-foreground bg-surface-200 text-foreground":"border-default hover:border-foreground-muted hover:bg-surface-100 text-foreground-light","disabled:opacity-50 disabled:cursor-not-allowed"),children:e},e))}),u.length>0&&(0,l.jsx)("div",{className:"grid gap-2 pt-1",children:u.map(e=>(0,l.jsx)("button",{onClick:()=>d(e),disabled:a,"aria-label":"Select ".concat(e.tableName," template with ").concat(e.fields.length," fields"),className:(0,v.cn)("text-left p-3 rounded-md border transition-colors w-full bg-surface-100","border-light hover:border-default hover:bg-surface-200 cursor-pointer","disabled:opacity-50 disabled:cursor-not-allowed"),children:(0,l.jsxs)("div",{className:"flex items-start gap-3",children:[(0,l.jsx)("div",{className:"rounded-full bg-alternative border w-8 h-8 flex items-center justify-center flex-shrink-0",children:(0,l.jsx)(o.A,{size:16,className:"text-foreground"})}),(0,l.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,l.jsx)("div",{className:"text-sm font-medium text-foreground mb-0",children:e.tableName}),e.rationale&&(0,l.jsx)("div",{className:"text-xs text-foreground-light mt-0.5",children:e.rationale})]}),(0,l.jsxs)(j.m_,{children:[(0,l.jsx)(j.k$,{asChild:!0,children:(0,l.jsxs)("div",{className:"flex items-center gap-1 text-sm text-foreground-muted ml-3",children:[(0,l.jsx)(N,{size:14,"aria-hidden":"true"}),(0,l.jsx)("span",{children:e.fields.length})]})}),(0,l.jsxs)(j.ZI,{children:[e.fields.length," ",1===e.fields.length?"column":"columns"]})]})]})},"".concat(n,":").concat(e.tableName)))})]})]})};var G=a(36261),V=a(80090),Z=a(84512),B=a(9620),X=a(67267),Y=a(6436),$=a(34983),F=a(95448),H=a(19873),K=a(71344),J=a(18664),ee=a(45550),et=a(91786),ea=a(11101),el=a(78187),en=a(31846),er=a(97507),es=a(88712),ei=a(95470),ed=a(89388);function eo(){let{ref:e}=(0,f.g)(),t=(0,ee.zv)(),a=(0,el.l)();if(!(null==t?void 0:t.recentItems)||!e)return null;let n=(a?t.recentItems.filter(e=>ee.qm[a].includes(e.type)):[...t.recentItems]).sort((e,t)=>t.timestamp-e.timestamp);return(0,l.jsxs)("div",{className:"space-y-4","data-sentry-component":"RecentItems","data-sentry-source-file":"RecentItems.tsx",children:[(0,l.jsx)("h2",{className:"text-sm text-foreground",children:"Recent items"}),(0,l.jsx)("div",{className:"flex flex-col gap-0",children:0===n.length?(0,l.jsxs)(er.P.div,{layout:!0,initial:!1,className:"flex flex-col items-center justify-center p-8 text-center border rounded-md border-muted gap-3",children:[(0,l.jsx)(ei.L,{type:"r"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs text-foreground-light",children:"No recent items yet"}),(0,l.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Items will appear here as you browse through your project"})]})]}):(0,l.jsx)(es.N,{children:(0,l.jsx)("div",{className:"grid grid-cols-1 gap-12 gap-y-0",children:n.map((t,a)=>{var n,r,i,d,o,u,m;return(0,l.jsx)(er.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{delay:.012*a,duration:.15},children:(0,l.jsxs)(c(),{href:"/project/".concat(e,"/").concat("sql"===t.type?"sql/".concat(null==(n=t.metadata)?void 0:n.sqlId):"r"===t.type||"v"===t.type||"m"===t.type||"f"===t.type||"p"===t.type?"editor/".concat(null==(r=t.metadata)?void 0:r.tableId,"?schema=").concat(null==(i=t.metadata)?void 0:i.schema,"&").concat(ed.bV,"=true"):"explorer/".concat(t.type,"/").concat(null==(d=t.metadata)?void 0:d.schema,"/").concat(null==(o=t.metadata)?void 0:o.name)),className:"flex items-center gap-4 rounded-lg bg-surface-100 py-2 transition-colors hover:bg-surface-200",children:[(0,l.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded bg-surface-100 border",children:(0,l.jsx)(ei.L,{type:t.type})}),(0,l.jsxs)("div",{className:"flex flex-1 gap-5 items-center",children:[(0,l.jsxs)("span",{className:"text-sm text-foreground",children:[(0,l.jsx)("span",{className:"text-foreground-lighter",children:null==(u=t.metadata)?void 0:u.schema}),(null==(m=t.metadata)?void 0:m.schema)&&(0,l.jsx)("span",{className:"text-foreground-light",children:"."}),(0,l.jsx)("span",{className:"text-foreground",children:t.label||"Untitled"})]}),(0,l.jsx)("div",{className:"bg-border-muted flex grow h-px"}),(0,l.jsx)("span",{className:"text-xs text-foreground-lighter",children:s()(t.timestamp).fromNow()})]})]})},t.id)})})})})]})}var eu=a(69498),ec=a(57384),em=a(63335);let ep={user:"Help me create a new database table for my project",assistant:"I'll help you create a database table. Please tell me:\n\n1. What does your application do?\n2. What kind of data do you want to store?\n\nI'll suggest a table structure that fits your requirements and help you create it directly in your database."};function eb(){let e=(0,m.useRouter)(),{ref:t}=(0,f.g)(),a=(0,el.l)(),{profile:r}=(0,$.xc)(),{data:i}=(0,Z.s)(),{data:u}=(0,B.YA)(),{selectedSchema:h}=(0,ec.k)(),{isSchemaLocked:j}=(0,em.BQ)({schema:h}),N=(0,K.ap)(),w=(0,H.aP)(),k=(0,ee.zv)(),T=(0,F.xd)(),{openSidebar:A}=(0,J.rM)(),[q,E]=(0,p.useState)(!1),[z]=d()(y.R,{type:"template"}),[C]=d()(y.R,{type:"quickstart"}),I=(0,p.useRef)(!1),{mutate:L}=(0,G.h)(),S=(0,R.n)(),{can:M}=(0,V.Qp)(n.aG.CREATE,"user_content",{resource:{type:"sql",owner_id:null==r?void 0:r.id},subject:{id:null==r?void 0:r.id}}),W=(0,X.I)("tableQuickstart"),Q=(0,p.useMemo)(()=>!!(null==u?void 0:u.inserted_at)&&7>s()().diff(s()(u.inserted_at),"day"),[null==u?void 0:u.inserted_at]),O="sql"!==a&&Q&&W&&W!==P.CONTROL?W:null,er="sql"!==a&&Q&&!1!==W&&void 0!==W;(0,p.useEffect)(()=>{er&&!I.current&&(I.current=!0,S("table_quickstart_opened",{variant:W}))},[er,W,S]);let es=j?[]:[{icon:(0,l.jsx)(o.A,{className:"h-4 w-4 text-foreground",strokeWidth:1.5}),title:"Create a table",description:"Design and create a new database table",bgColor:"bg-blue-500",isBeta:!1,onClick:()=>N.onAddTable()}],ei=[{icon:(0,l.jsx)(et.ty,{className:(0,v.cn)("fill-foreground","w-4 h-4"),strokeWidth:1.5}),title:"New SQL Snippet",description:"Execute SQL queries",bgColor:"bg-green-500",isBeta:!1,onClick:()=>e.push("/project/".concat(t,"/sql/new"))}],ed=async(a,l)=>{if(!t)return console.error("Project ref is required");if(!u)return console.error("Project is required");if(!r)return console.error("Profile is required");if(!M)return(0,b.oR)("Your queries will not be saved as you do not have sufficient permissions");try{let n=(0,x.fW)({id:(0,Y.gZ)(),name:l,sql:a,owner_id:null==r?void 0:r.id,project_id:null==u?void 0:u.id});w.addSnippet({projectRef:t,snippet:n}),w.addNeedsSaving(n.id);let s=(0,ee.lW)("sql",{id:n.id});k.addTab({id:s,type:"sql",label:l,metadata:{sqlId:n.id}}),e.push("/project/".concat(t,"/sql/").concat(n.id))}catch(e){b.oR.error("Failed to create new query: ".concat(e.message))}};return(0,l.jsxs)("div",{className:"bg-surface-100 h-full overflow-y-auto py-12","data-sentry-component":"NewTab","data-sentry-source-file":"NewTab.tsx",children:[(0,l.jsxs)("div",{className:"mx-auto max-w-2xl flex flex-col gap-10 px-10",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[("sql"===a?ei:es).map((e,t)=>(0,l.jsx)(en.L,{...e},"action-card-".concat(t))),O===P.ASSISTANT&&(0,l.jsx)(en.L,{icon:(0,l.jsx)(g.M,{size:16,loading:q}),title:"Create with Assistant",description:"Use AI to design your database table",bgColor:"bg-brand-200",onClick:()=>{if(!q){E(!0);try{if(A(eu.c.AI_ASSISTANT),!T.newChat({name:"Create a database table"}))throw S("table_quickstart_assistant_opened",{chatCreated:!1}),Error("Failed to create chat");let e={id:(0,Y.gZ)(),role:"user",parts:[{type:"text",text:ep.user}]},t={id:(0,Y.gZ)(),role:"assistant",parts:[{type:"text",text:ep.assistant}]};T.saveMessage([e,t]),S("table_quickstart_assistant_opened",{chatCreated:!0})}catch(t){console.error("Failed to open AI assistant:",t);let e=t instanceof Error?t.message:"Unknown error";b.oR.error("Unable to open AI assistant: ".concat(e))}finally{E(!1)}}}})]}),O===P.AI&&(0,l.jsx)(U,{onSelectTable:e=>N.onAddTable(e)}),O===P.TEMPLATES&&(0,l.jsx)(D,{onSelectTemplate:e=>N.onAddTable(e)}),(0,l.jsx)(eo,{"data-sentry-element":"RecentItems","data-sentry-source-file":"NewTab.tsx"})]}),"sql"===a&&(0,l.jsx)("div",{className:"flex flex-col gap-4 mx-auto py-10",children:(0,l.jsxs)(ea.tU,{defaultValue:"templates",children:[(0,l.jsxs)(ea.j7,{className:"mx-auto justify-center gap-5",children:[(0,l.jsx)(ea.Xi,{value:"templates",children:"Templates"}),(0,l.jsx)(ea.Xi,{value:"quickstarts",children:"Quickstarts"})]}),(0,l.jsxs)(ea.av,{value:"templates",className:"max-w-5xl mx-auto py-5",children:[(0,l.jsx)("div",{className:"grid grid-cols-3 gap-4 px-8",children:z.slice(0,9).map((e,a)=>(0,l.jsx)(en.L,{onClick:()=>{var a;ed(e.sql,e.title),L({action:"sql_editor_template_clicked",properties:{templateName:e.title},groups:{project:null!=t?t:"Unknown",organization:null!=(a=null==i?void 0:i.slug)?a:"Unknown"}})},bgColor:"bg-alternative border",...e,icon:(0,l.jsx)(et.ty,{className:(0,v.cn)("fill-foreground","w-4 h-4"),strokeWidth:1.5})},"action-card-".concat(a)))}),(0,l.jsx)("div",{className:"flex justify-center mt-5",children:(0,l.jsx)(_.$,{asChild:!0,type:"default",children:(0,l.jsx)(c(),{href:"/project/".concat(t,"/sql/templates"),children:"View more templates"})})})]}),(0,l.jsxs)(ea.av,{value:"quickstarts",className:"max-w-5xl mx-auto py-5",children:[(0,l.jsx)("div",{className:"grid grid-cols-3 gap-4 px-8",children:C.map((e,a)=>(0,l.jsx)(en.L,{onClick:()=>{var a;ed(e.sql,e.title),L({action:"sql_editor_quickstart_clicked",properties:{quickstartName:e.title},groups:{project:null!=t?t:"Unknown",organization:null!=(a=null==i?void 0:i.slug)?a:"Unknown"}})},bgColor:"bg-alternative border",...e,icon:(0,l.jsx)(et.ty,{className:(0,v.cn)("fill-foreground","w-4 h-4"),strokeWidth:1.5})},"action-card-".concat(a)))}),(0,l.jsx)("div",{className:"flex justify-center mt-5",children:(0,l.jsx)(_.$,{asChild:!0,type:"default",children:(0,l.jsx)(c(),{href:"/project/".concat(t,"/sql/quickstarts"),children:"View more templates"})})})]})]})})]})}},64382:(e,t,a)=>{a.d(t,{A:()=>l});let l=(0,a(86848).A)("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]])}}]);