try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="1f6b6956-417d-4168-bb3b-7f5b6612c53b",e._sentryDebugIdIdentifier="sentry-dbid-1f6b6956-417d-4168-bb3b-7f5b6612c53b")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[84698],{1348:(e,n,t)=>{t.d(n,{BA:()=>i,SF:()=>o,yG:()=>m});var a=t(29395),r=t(15960);let o=10240,i=50,s=["text","varchar","char","character varying","character"],l=["json","jsonb"],c=new Set(l),d=new Set([...s,...l,"bytea","xml","hstore","clob","vector","geometry","geography","tsvector","tsquery","daterange","tsrange","tstzrange","numrange","int4range","int8range","cube","ltree","lquery","jsonpath","citext"]),u=function(e){var n;let{excludedColumns:t=[]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=null==(n=e.primary_keys)?void 0:n.map(e=>e.name);if(a&&a.length>0&&!a.every(e=>t.includes(e)))return a;if(e.columns&&e.columns.length>0){let n=e.columns.filter(e=>!e.data_type.includes("json")&&!t.includes(e.name));if(n.length>0)return[n[0].name]}return[]},m=e=>{let{table:n,filters:t=[],sorts:l=[],page:m,limit:b,maxCharacters:p=o,maxArraySize:_=i,sortExcludedColumns:f=[]}=e;if(!n||!n.columns)return"";let h=new r.X().from(n.name,n.schema).select();t.forEach(e=>{var t;let a=null==(t=n.columns)?void 0:t.find(n=>n.name===e.column),r=!a||s.includes(a.format);h=h.filter(e.column,e.operator,r||""!==e.value?e.value:null)});let y=n.live_rows_estimate||0;if(0===l.length&&y<=1e5&&n.columns.length>0){let e=u(n,{excludedColumns:f});e.length>0&&e.forEach(e=>{h=h.order(n.name,e)})}else l.forEach(e=>{h=h.order(e.table,e.column,e.ascending,e.nullsFirst)});let{from:g,to:w}=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,t=e?e*n:0;return{from:t,to:e?t+n-1:n-1}}((null!=m?m:1)-1,b),j="with _base_query as (".concat(h.range(g,w).toSql({isCTE:!1,isFinal:!1}),")"),v=n.columns.sort((e,n)=>e.ordinal_position-n.ordinal_position).map(e=>({name:e.name,format:e.format.toLowerCase()})),x=n.columns.filter(e=>{let n;return n=e.format,d.has(n.toLowerCase())}).map(e=>e.name),E=v.map(e=>{let{name:n}=e,t=(0,a.bD)(n);return x.includes(n)?"case\n        when octet_length(".concat(t,"::text) > ").concat(p," \n        then left(").concat(t,"::text, ").concat(p,") || '...'\n        else ").concat(t,"::text\n      end as ").concat(t):t});n.columns.filter(e=>"array"===e.data_type.toLowerCase()).map(e=>({name:e.name,format:e.format.toLowerCase().slice(1)})).forEach(e=>{let{name:n,format:t}=e,r=E.findIndex(e=>e===(0,a.bD)(n)),o=c.has(t)?"".concat(t,"[]"):"text[]",i="text[]"===o?"array['...']":"array['{\"truncated\": true}'::json]";r>=0&&(E[r]="\n        case \n          when octet_length(".concat((0,a.bD)(n),"::text) > ").concat(p," \n          then\n            case\n              when array_ndims(").concat((0,a.bD)(n),") = 1\n              then\n                (select array_cat(").concat((0,a.bD)(n),"[1:").concat(_,"]::").concat(o,", ").concat(i,"::").concat(o,"))::").concat(o,"\n              else\n                ").concat((0,a.bD)(n),"[1:").concat(_,"]::").concat(o,"\n            end\n          else ").concat((0,a.bD)(n),"::").concat(o,"\n        end\n      "))});let k=E.join(","),S=new r.X().from("_base_query").select(k);return"".concat(j,"\n  ").concat(S.toSql({isCTE:!0,isFinal:!0}))}},6843:(e,n,t)=>{t.d(n,{j:()=>a});let a={tableRows:function(e){let{table:n,roleImpersonationState:t,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["projects",e,"table-rows",null==n?void 0:n.id,"rows",{roleImpersonation:null==t?void 0:t.role,...a}]},tableRowsCount:function(e){let{table:n,...t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return["projects",e,"table-rows",null==n?void 0:n.id,"count",t]},tableRowsAndCount:(e,n)=>["projects",e,"table-rows",n]}},28436:(e,n,t)=>{t.d(n,{AM:()=>v,I:()=>y,KV:()=>p,Lj:()=>i,_c:()=>m,ao:()=>l,cx:()=>d,e2:()=>k,hB:()=>f,n0:()=>r,th:()=>w,yB:()=>E});let a=["smallint","integer","bigint","decimal","numeric","real","double precision","serial","bigserial","int2","int4","int8","float4","float8","smallserial","serial2","serial4","serial8"];function r(e){return a.indexOf(e.toLowerCase())>-1}let o=["json","jsonb","array"];function i(e){return o.indexOf(e.toLowerCase())>-1}let s=["array"];function l(e){return s.indexOf(e.toLowerCase())>-1}let c=["uuid","text","character varying"];function d(e){return c.indexOf(e.toLowerCase())>-1}let u=["citext"];function m(e){return u.indexOf(e.toLowerCase())>-1}let b=["timestamp","timestamptz"];function p(e){return b.indexOf(e.toLowerCase())>-1}let _=["date"];function f(e){return _.indexOf(e.toLowerCase())>-1}let h=["time","timetz"];function y(e){return h.indexOf(e.toLowerCase())>-1}let g=["boolean","bool"];function w(e){return g.indexOf(e.toLowerCase())>-1}let j=["user-defined"];function v(e){return j.indexOf(e.toLowerCase())>-1}let x=["bytea"];function E(e){return x.indexOf(e.toLowerCase())>-1}function k(e){var n;let{targetTableSchema:t,targetTableName:a,targetColumnName:r}=null!=(n=null==e?void 0:e.foreignKey)?n:{};return!!t&&!!a&&!!r}},35693:(e,n,t)=>{t.d(n,{i:()=>d});var a=t(80263),r=t(53239),o=t(95137),i=t(99779),s=t(63335),l=t(44725);let c=e=>{let{onClose:n}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,a.jsx)(o.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Schemas managed by Supabase"})}),(0,a.jsx)(o.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"ProtectedSchemaWarning.tsx"}),(0,a.jsxs)(o.OO,{className:"space-y-2 prose","data-sentry-element":"DialogSection","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,a.jsx)("p",{className:"text-sm",children:"The following schemas are managed by Supabase and are currently protected from write access through the dashboard."}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:s.$O.map(e=>(0,a.jsx)("code",{className:"text-xs",children:e},e))}),(0,a.jsx)("p",{className:"text-sm !mt-4",children:"These schemas are critical to the functionality of your Supabase project and hence we highly recommend not altering them."}),(0,a.jsx)("p",{className:"text-sm",children:"You can, however, still interact with those schemas through the SQL Editor although we advise you only do so if you know what you are doing."})]}),(0,a.jsx)(o.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,a.jsx)("div",{className:"flex items-center justify-end space-x-2",children:(0,a.jsx)(i.$,{type:"default",onClick:n,"data-sentry-element":"Button","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Understood"})})})]})},d=e=>{let{size:n="md",schema:t,entity:d}=e,[u,m]=(0,r.useState)(!1),{isSchemaLocked:b,reason:p,fdwType:_}=(0,s.BQ)({schema:t});return b?(0,a.jsx)(l.Z,{showIcon:"sm"!==n,type:"note",title:"sm"===n?"Viewing protected schema":"Viewing ".concat(d," from a protected schema"),className:"[&_p]:!m-0","data-sentry-element":"Admonition","data-sentry-component":"ProtectedSchemaWarning","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"fdw"===p&&"iceberg"===_?(0,a.jsxs)("p",{children:["The ",(0,a.jsx)("code",{className:"text-code-inline",children:t})," schema is used by Supabase to connect to analytics buckets and is read-only through the dashboard."]}):"fdw"===p&&"s3_vectors"===_?(0,a.jsxs)("p",{children:["The ",(0,a.jsx)("code",{className:"text-xs",children:t})," schema is used by Supabase to connect to vector buckets and is read-only through the dashboard."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"mb-2",children:["The ",(0,a.jsx)("code",{className:"text-code-inline",children:t})," schema is managed by Supabase and is read-only through the dashboard."]}),(0,a.jsxs)(o.lG,{open:u,onOpenChange:m,children:[(0,a.jsx)(o.zM,{asChild:!0,children:(0,a.jsx)(i.$,{type:"default",size:"tiny",onClick:()=>m(!0),children:"Learn more"})}),(0,a.jsx)(o.Cf,{children:(0,a.jsx)(c,{onClose:()=>m(!1)})})]})]})}):null}},56748:(e,n,t)=>{t.d(n,{Y:()=>a});let a={list:e=>["projects",e,"fdws"]}},57648:(e,n,t)=>{t.d(n,{Ap:()=>l,Nj:()=>d,Pk:()=>c});var a=t(67850),r=t(59356),o=t(88403),i=t(26616),s=t.n(i);async function l(e,n){var t,a;let{projectRef:o,connectionString:i,id:l}=e;if(!l)throw Error("id is required");let c=l?s()("\n    with base_table_info as (\n        select \n            c.oid::int8 as id,\n            nc.nspname as schema,\n            c.relname as name,\n            c.relkind,\n            c.relrowsecurity as rls_enabled,\n            c.relforcerowsecurity as rls_forced,\n            c.relreplident,\n            c.relowner,\n            obj_description(c.oid) as comment,\n            fs.srvname as foreign_server_name,\n            fdw.fdwname as foreign_data_wrapper_name,\n            fdw_handler.proname as foreign_data_wrapper_handler\n        from pg_class c\n        join pg_namespace nc on nc.oid = c.relnamespace\n        left join pg_foreign_table ft on ft.ftrelid = c.oid\n        left join pg_foreign_server fs on fs.oid = ft.ftserver\n        left join pg_foreign_data_wrapper fdw on fdw.oid = fs.srvfdw\n        left join pg_proc fdw_handler on fdw.fdwhandler = fdw_handler.oid\n        where c.oid = ".concat(l,"\n            and not pg_is_other_temp_schema(nc.oid)\n            and (\n                pg_has_role(c.relowner, 'USAGE')\n                or has_table_privilege(\n                    c.oid,\n                    'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n                )\n                or has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n            )\n    ),\n    table_stats as (\n        select \n            b.id,\n            case\n                when b.relreplident = 'd' then 'DEFAULT'\n                when b.relreplident = 'i' then 'INDEX'\n                when b.relreplident = 'f' then 'FULL'\n                else 'NOTHING'\n            end as replica_identity,\n            pg_total_relation_size(format('%I.%I', b.schema, b.name))::int8 as bytes,\n            pg_size_pretty(pg_total_relation_size(format('%I.%I', b.schema, b.name))) as size,\n            pg_stat_get_live_tuples(b.id) as live_rows_estimate,\n            pg_stat_get_dead_tuples(b.id) as dead_rows_estimate\n        from base_table_info b\n        where b.relkind in ('r', 'p')\n    ),\n    primary_keys as (\n        select \n            i.indrelid as table_id,\n            jsonb_agg(jsonb_build_object(\n                'schema', n.nspname,\n                'table_name', c.relname,\n                'table_id', i.indrelid::int8,\n                'name', a.attname\n            )) as primary_keys\n        from pg_index i\n        join pg_class c on i.indrelid = c.oid\n        join pg_attribute a on (a.attrelid = c.oid and a.attnum = any(i.indkey))\n        join pg_namespace n on c.relnamespace = n.oid\n        where i.indisprimary\n        group by i.indrelid\n    ),\n    relationships as (\n        select \n            c.conrelid as source_id,\n            c.confrelid as target_id,\n            jsonb_build_object(\n                'id', c.oid::int8,\n                'constraint_name', c.conname,\n                'deletion_action', c.confdeltype,\n                'update_action', c.confupdtype,\n                'source_schema', nsa.nspname,\n                'source_table_name', csa.relname,\n                'source_column_name', sa.attname,\n                'target_table_schema', nta.nspname,\n                'target_table_name', cta.relname,\n                'target_column_name', ta.attname\n            ) as rel_info\n        from pg_constraint c\n        join pg_class csa on c.conrelid = csa.oid\n        join pg_namespace nsa on csa.relnamespace = nsa.oid\n        join pg_attribute sa on (sa.attrelid = c.conrelid and sa.attnum = any(c.conkey))\n        join pg_class cta on c.confrelid = cta.oid\n        join pg_namespace nta on cta.relnamespace = nta.oid\n        join pg_attribute ta on (ta.attrelid = c.confrelid and ta.attnum = any(c.confkey))\n        where c.contype = 'f'\n    ),\n    columns as (\n        select \n            a.attrelid as table_id,\n            jsonb_agg(jsonb_build_object(\n                'id', (a.attrelid || '.' || a.attnum),\n                'table_id', c.oid::int8,\n                'schema', nc.nspname,\n                'table', c.relname,\n                'ordinal_position', a.attnum,\n                'name', a.attname,\n                'default_value', case \n                    when a.atthasdef then pg_get_expr(ad.adbin, ad.adrelid)\n                    else null\n                end,\n                'data_type', case \n                    when t.typtype = 'd' then \n                        case \n                            when bt.typelem <> 0::oid and bt.typlen = -1 then 'ARRAY'\n                            when nbt.nspname = 'pg_catalog' then format_type(t.typbasetype, null)\n                            else 'USER-DEFINED'\n                        end\n                    else \n                        case \n                            when t.typelem <> 0::oid and t.typlen = -1 then 'ARRAY'\n                            when nt.nspname = 'pg_catalog' then format_type(a.atttypid, null)\n                            else 'USER-DEFINED'\n                        end\n                end,\n                'format', case\n                    when t.typtype = 'e' then\n                        case\n                            when nt.nspname <> 'public' then concat(nt.nspname, '.', coalesce(bt.typname, t.typname))\n                            else coalesce(bt.typname, t.typname)\n                        end\n                    else\n                        coalesce(bt.typname, t.typname)\n                end,\n                'is_identity', a.attidentity in ('a', 'd'),\n                'identity_generation', case a.attidentity\n                    when 'a' then 'ALWAYS'\n                    when 'd' then 'BY DEFAULT'\n                    else null\n                end,\n                'is_generated', a.attgenerated in ('s'),\n                'is_nullable', not (a.attnotnull or t.typtype = 'd' and t.typnotnull),\n                'is_updatable', (\n                    b.relkind in ('r', 'p') or \n                    (b.relkind in ('v', 'f') and pg_column_is_updatable(b.id, a.attnum, false))\n                ),\n                'is_unique', uniques.table_id is not null,\n                'check', check_constraints.definition,\n                'comment', col_description(c.oid, a.attnum),\n                'enums', coalesce(\n                    (\n                        select jsonb_agg(e.enumlabel order by e.enumsortorder)\n                        from pg_catalog.pg_enum e\n                        where e.enumtypid = coalesce(bt.oid, t.oid)\n                            or e.enumtypid = coalesce(bt.typelem, t.typelem)\n                    ),\n                    '[]'::jsonb\n                )\n            ) order by a.attnum) as columns\n        from pg_attribute a\n        join base_table_info b on a.attrelid = b.id\n        join pg_class c on a.attrelid = c.oid\n        join pg_namespace nc on c.relnamespace = nc.oid\n        left join pg_attrdef ad on (a.attrelid = ad.adrelid and a.attnum = ad.adnum)\n        join pg_type t on a.atttypid = t.oid\n        join pg_namespace nt on t.typnamespace = nt.oid\n        left join pg_type bt on (t.typtype = 'd' and t.typbasetype = bt.oid)\n        left join pg_namespace nbt on bt.typnamespace = nbt.oid\n        left join (\n            select \n                conrelid as table_id,\n                conkey[1] as ordinal_position\n            from pg_catalog.pg_constraint\n            where contype = 'u' and cardinality(conkey) = 1\n            group by conrelid, conkey[1]\n        ) as uniques on uniques.table_id = a.attrelid and uniques.ordinal_position = a.attnum\n        left join (\n            select distinct on (conrelid, conkey[1])\n                conrelid as table_id,\n                conkey[1] as ordinal_position,\n                substring(\n                    pg_get_constraintdef(oid, true),\n                    8,\n                    length(pg_get_constraintdef(oid, true)) - 8\n                ) as definition\n            from pg_constraint\n            where contype = 'c' and cardinality(conkey) = 1\n            order by conrelid, conkey[1], oid asc\n        ) as check_constraints on check_constraints.table_id = a.attrelid \n                            and check_constraints.ordinal_position = a.attnum\n        where a.attnum > 0 \n        and not a.attisdropped\n        group by a.attrelid\n    )\n    select \n        case b.relkind\n            when 'r' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'rls_enabled', b.rls_enabled,\n                'rls_forced', b.rls_forced,\n                'replica_identity', ts.replica_identity,\n                'bytes', ts.bytes,\n                'size', ts.size,\n                'live_rows_estimate', ts.live_rows_estimate,\n                'dead_rows_estimate', ts.dead_rows_estimate,\n                'comment', b.comment,\n                'primary_keys', coalesce(pk.primary_keys, '[]'::jsonb),\n                'relationships', coalesce(\n                    (select jsonb_agg(r.rel_info)\n                    from relationships r\n                    where r.source_id = b.id or r.target_id = b.id), \n                    '[]'::jsonb\n                ),\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'p' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'rls_enabled', b.rls_enabled,\n                'rls_forced', b.rls_forced,\n                'replica_identity', ts.replica_identity,\n                'bytes', ts.bytes,\n                'size', ts.size,\n                'live_rows_estimate', ts.live_rows_estimate,\n                'dead_rows_estimate', ts.dead_rows_estimate,\n                'comment', b.comment,\n                'primary_keys', coalesce(pk.primary_keys, '[]'::jsonb),\n                'relationships', coalesce(\n                    (select jsonb_agg(r.rel_info)\n                    from relationships r\n                    where r.source_id = b.id or r.target_id = b.id), \n                    '[]'::jsonb\n                ),\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'v' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'is_updatable', (pg_relation_is_updatable(b.id, false) & 20) = 20,\n                'comment', b.comment,\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'm' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'is_populated', true,\n                'comment', b.comment,\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n            when 'f' then jsonb_build_object(\n                'entity_type', b.relkind,\n                'id', b.id,\n                'schema', b.schema,\n                'name', b.name,\n                'comment', b.comment,\n                'foreign_server_name', b.foreign_server_name,\n                'foreign_data_wrapper_name', b.foreign_data_wrapper_name,\n                'foreign_data_wrapper_handler', b.foreign_data_wrapper_handler,\n                'columns', coalesce(c.columns, '[]'::jsonb)\n            )\n        end as entity\n    from base_table_info b\n    left join table_stats ts on b.id = ts.id\n    left join primary_keys pk on b.id = pk.table_id\n    left join columns c on b.id = c.table_id;\n  ")):"",{result:d}=await (0,r.E)({projectRef:o,connectionString:i,sql:c,queryKey:["table-editor",l]},n);return null!=(a=null==(t=d[0])?void 0:t.entity)?a:null}let c=function(e){let{projectRef:n,connectionString:t,id:r}=e,{enabled:i=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)({queryKey:o.i.tableEditor(n,r),queryFn:e=>{let{signal:a}=e;return l({projectRef:n,connectionString:t,id:r},a)},enabled:i&&void 0!==n&&void 0!==r&&!isNaN(r),refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:3e5,...s})};function d(e,n){let{projectRef:t,connectionString:a,id:r}=n;return e.fetchQuery({queryKey:o.i.tableEditor(t,r),queryFn:e=>{let{signal:n}=e;return l({projectRef:t,connectionString:a,id:r},n)}})}},71875:(e,n,t)=>{t.d(n,{li:()=>_,q3:()=>p,tv:()=>f});var a=t(80263),r=t(51355),o=t(80814),i=t(53239),s=t(89388),l=t(57648),c=t(75204),d=t(9620),u=t(13693),m=t(71344),b=t(58732);function p(e){let{queryClient:n,projectRef:t,connectionString:a,id:r,sorts:o,filters:i,roleImpersonationState:d}=e;return(0,l.Nj)(n,{projectRef:t,connectionString:a,id:r}).then(e=>{if(e){var l;let u=(0,s.rH)(e),{sorts:b=[],filters:p=[]}=null!=(l=(0,s.Tk)(t,e.name,e.schema))?l:{};(0,c.nk)(n,{projectRef:t,connectionString:a,tableId:r,sorts:null!=o?o:(0,s.FU)(u.name,b),filters:null!=i?i:(0,s.hl)(p),page:1,limit:m.to,roleImpersonationState:d})}})}function _(){let e=(0,o.useRouter)(),n=(0,r.jE)(),{data:t}=(0,d.YA)(),a=(0,u.RY)();return(0,i.useCallback)(r=>{let{id:o,filters:i,sorts:s}=r,l=o?Number(o):void 0;!t||!l||isNaN(l)||(e.prefetch("/project/".concat(t.ref,"/editor/").concat(l)),p({queryClient:n,projectRef:t.ref,connectionString:t.connectionString,id:l,sorts:s,filters:i,roleImpersonationState:a}).catch(()=>{}))},[t,n,a,e])}function f(e){let{projectRef:n,id:t,sorts:r,filters:o,href:i,children:s,...l}=e,c=_();return(0,a.jsx)(b.A,{href:i||"/project/".concat(n,"/editor/").concat(t),prefetcher:()=>c({id:t,sorts:r,filters:o}),...l,"data-sentry-element":"PrefetchableLink","data-sentry-component":"EditorTablePageLink","data-sentry-source-file":"project.$ref.editor.$id.tsx",children:s})}},73036:(e,n,t)=>{t.d(n,{$:()=>o});var a=t(53239),r=t(74065);let o=e=>{let{checkIsDirty:n,onClose:t}=e,[o,i]=(0,a.useState)(!1),s=(0,r.A)(n),l=(0,r.A)(t),c=(0,a.useCallback)(()=>{s.current()?i(!0):l.current()},[]),d=(0,a.useCallback)(()=>{i(!1),l.current()},[]),u=(0,a.useCallback)(()=>{i(!1)},[]),m=(0,a.useMemo)(()=>({visible:o,onClose:d,onCancel:u}),[o,d,u]);return(0,a.useMemo)(()=>({confirmOnClose:c,modalProps:m}),[c,m])}},75204:(e,n,t)=>{t.d(n,{HQ:()=>w,PX:()=>g,nk:()=>x,sE:()=>y,vs:()=>v});var a=t(76984),r=t(1348),o=t(51355),i=t(67850),s=t(22891),l=t(89388),c=t(57648),d=t(52641),u=t(99842),m=t(13693),b=t(5652),p=t(59356),_=t(6843),f=t(90188);async function h(e){return new Promise(n=>setTimeout(n,e))}async function y(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let a=0;a<=n;a++)try{return await e()}catch(e){if(429===(e instanceof b.o?e.code:e.status)&&a<n){let n=function(e){var n;if(e instanceof b.o)return e.retryAfter;let t=null==(n=e.headers)?void 0:n.get("retry-after");if(t)return parseInt(t)}(e),r=n?1e3*n:t*Math.pow(2,a);await h(r);continue}throw e}throw Error("Max retries reached without success")}let g=e=>{var n;let{table:t,filters:r=[],sorts:o=[]}=e,i=new a.Query,s=t.columns.filter(e=>{var n;return(null!=(n=null==e?void 0:e.enum)?n:[]).length>0&&"array"===e.dataType.toLowerCase()}).map(e=>'"'.concat(e.name,'"::text[]')),l=i.from(t.name,null!=(n=t.schema)?n:void 0).select(s.length>0?"*,".concat(s.join(",")):"*");r.filter(e=>e.value&&""!==e.value).forEach(e=>{let n=(0,f.b)(t,e);l=l.filter(e.column,e.operator,n)});let c=(e=>{let n=e.columns.filter(e=>null==e?void 0:e.isPrimaryKey).map(e=>e.name);if(0!==n.length)return n;{var t;let n=e.columns.filter(e=>!e.dataType.includes("json"));return n.length>0?[null==(t=n[0])?void 0:t.name]:[]}})(t);if(0===o.length)c.length>0&&c.forEach(e=>{l=l.order(t.name,e)});else if(o.forEach(e=>{l=l.order(e.table,e.column,e.ascending,e.nullsFirst)}),c.length>0){let e=new Set(o.filter(e=>e.table===t.name).map(e=>e.column));c.filter(n=>!e.has(n)).forEach(e=>{l=l.order(t.name,e)})}return l=l.order(t.name,"ctid")},w=async e=>{let{projectRef:n,connectionString:t,table:a,filters:r=[],sorts:o=[],roleImpersonationState:i,progressCallback:l}=e;if(s.pe&&!t)return console.error("Connection string is required"),[];let c=[],d=g({table:a,sorts:o,filters:r}),m=-1;for(;;){let e=500*(m+=1),a=(m+1)*500-1,r=(0,u.Nf)(d.range(e,a).toSql(),i);try{let{result:e}=await y(async()=>(0,p.E)({projectRef:n,connectionString:t,sql:r}));if(c.push(...e),null==l||l(c.length),e.length<500)break;await h(500)}catch(e){throw Error("Error fetching all table rows: ".concat(e instanceof Error?e.message:"Unknown error"))}}return c.filter(e=>1!==e[u.BO])};async function j(e,n){let{queryClient:t,projectRef:a,connectionString:o,tableId:i,roleImpersonationState:s,filters:b,sorts:_,limit:f,page:h}=e,y=await (0,c.Nj)(t,{projectRef:a,connectionString:o,id:i});if(!y)throw Error("Table not found");let g=(0,l.rH)(y),w=null==b?void 0:b.filter(e=>"="===e.operator||"is"===e.operator).flatMap(e=>e.column),j=(0,d.H8)(y)?Array.from(new Set(w)):void 0,v=(0,u.Nf)((0,r.yG)({table:y,filters:b,sorts:_,limit:f,page:h,sortExcludedColumns:j}),s);try{let{result:e}=await (0,p.E)({projectRef:a,connectionString:o,sql:v,queryKey:["table-rows",null==g?void 0:g.id],isRoleImpersonationEnabled:(0,m._c)(null==s?void 0:s.role)},n);return{rows:e.map((e,n)=>({idx:n,...e}))}}catch(e){throw Error(e instanceof Error?e.message:"Unknown error")}}let v=function(e){let{projectRef:n,connectionString:t,tableId:a,...r}=e,{enabled:s=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=(0,o.jE)();return(0,i.I)({queryKey:_.j.tableRows(n,{table:{id:a},...r}),queryFn:e=>{let{signal:o}=e;return j({queryClient:c,projectRef:n,connectionString:t,tableId:a,...r},o)},enabled:s&&void 0!==n&&void 0!==a,...l})};function x(e,n){let{projectRef:t,connectionString:a,tableId:r,...o}=n;return e.fetchQuery({queryKey:_.j.tableRows(t,{table:{id:r},...o}),queryFn:n=>{let{signal:i}=n;return j({queryClient:e,projectRef:t,connectionString:a,tableId:r,...o},i)}})}},88403:(e,n,t)=>{t.d(n,{i:()=>a});let a={tableEditor:(e,n)=>["projects",e,"table-editor",n].filter(Boolean)}},90188:(e,n,t)=>{t.d(n,{b:()=>o,j:()=>i});var a=t(28436),r=t(52641);function o(e,n){let t=e.columns.find(e=>e.name==n.column);if(t&&(0,a.n0)(t.format)){let e=Number(n.value);if(!Number.isNaN(e)&&!(e>Number.MAX_SAFE_INTEGER))return Number(n.value)}return n.value}function i(e){let{table:n}=e;if(!(0,r.KO)(n))return{error:{message:"Only table rows can be updated or deleted"}};let t=n.primary_keys;return t&&0!=t.length?{primaryKeys:t.map(e=>e.name)}:{error:{message:"Please add a primary key column to your table to update or delete rows"}}}},93424:(e,n,t)=>{t.d(n,{a:()=>u,e:()=>m});var a=t(72391),r=t(51355),o=t(80210),i=t(73969),s=t(89790),l=t(59356),c=t(88403),d=t(31958);async function u(e){let{projectRef:n,connectionString:t,id:r,name:o,schema:i,payload:s}=e,{sql:c}=a.A.tables.update({id:r,name:o,schema:i},s),{result:d}=await (0,l.E)({projectRef:n,connectionString:t,sql:c,queryKey:["table","update",r]});return d}let m=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,r.jE)();return(0,o.n)({mutationFn:e=>u(e),async onSuccess(n,t,r){let{projectRef:o,schema:i,id:l}=t;await Promise.all([a.invalidateQueries({queryKey:c.i.tableEditor(o,l)}),a.invalidateQueries({queryKey:d.v.list(o,i)}),a.invalidateQueries({queryKey:s.O.lint(o)})]),await (null==e?void 0:e(n,t,r))},async onError(e,t,a){void 0===n?i.oR.error("Failed to update database table: ".concat(e.message)):n(e,t,a)},...t})}}}]);