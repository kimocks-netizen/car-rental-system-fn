try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="c63d3168-6330-4976-90ec-58b74de58f44",e._sentryDebugIdIdentifier="sentry-dbid-c63d3168-6330-4976-90ec-58b74de58f44")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4843],{3413:(e,t,a)=>{"use strict";a.d(t,{j:()=>d});var n=a(67850),s=a(78960),r=a(24523),i=a(9620),l=a(85039),o=a(80658);async function c(e,t){let{projectRef:a}=e;if(!a)throw Error("projectRef is required");let{data:n,error:s}=await (0,r.Jt)("/platform/storage/{ref}/analytics-buckets",{params:{path:{ref:a}},signal:t});return s&&(0,r.H4)(s),n.data}let d=function(e){let{projectRef:t}=e,{enabled:a=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d}=(0,i.YA)(),u=(null==d?void 0:d.status)===l.BU.ACTIVE_HEALTHY,m=(0,s.mM)({projectRef:null==d?void 0:d.ref});return(0,n.I)({queryKey:o.w.analyticsBuckets(t),queryFn:e=>{let{signal:a}=e;return c({projectRef:t},a)},enabled:a&&void 0!==t&&u&&m,...r})}},14310:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(86848).A)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]])},26819:(e,t,a)=>{"use strict";a.d(t,{s:()=>c,v:()=>d});var n=a(80263),s=a(10115),r=a(53239),i=a(37724),l=a(883),o=a(80100);let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,n.jsx)(s.bL,{className:(0,o.cn)("flex flex-col -space-y-px w-full",a),...r,ref:t})});c.displayName="RadioGroupStacked";let d=r.forwardRef((e,t)=>{let{image:a,label:r,showIndicator:c=!0,...d}=e;return(0,n.jsx)(s.q7,{ref:t,...d,className:(0,o.cn)("flex flex-col gap-2","w-full","bg-overlay/50 disabled:opacity-50","border","first-of-type:rounded-t-lg last-of-type:rounded-b-lg","shadow-sm","enabled:hover:bg-surface-300","enabled:hover:border-foreground-muted","enabled:cursor-pointer disabled:cursor-not-allowed","hover:z-[1] focus-visible:z-[1]","data-[state=checked]:z-[1]","data-[state=checked]:ring-1 data-[state=checked]:ring-border","data-[state=checked]:bg-surface-300","data-[state=checked]:border-foreground-muted","transition","group",d.className),children:(0,n.jsxs)("div",{className:"flex gap-3 w-full px-[21px] py-3",children:[c&&(0,n.jsx)("div",{className:(0,o.cn)("aspect-square h-4 w-4 min-w-4 min-h-4","rounded-full border group-data-[state=checked]:border-foreground-muted","group-focus:border-foreground-muted","group-hover:border-foreground-muted","ring-offset-background","group-focus:outline-none","group-focus-visible:ring-2 group-focus-visible:ring-ring group-focus-visible:ring-offset-2","flex items-center justify-center","transition"),children:(0,n.jsx)(s.C1,{className:"flex items-center justify-center",children:(0,n.jsx)(i.A,{className:"h-2.5 w-2.5 fill-current text-current"})})}),(0,n.jsxs)("div",{className:"flex flex-col gap-0.25 items-start",children:[(0,n.jsx)(l.J,{htmlFor:d.value,className:(0,o.cn)("block","-mt-[0.15rem]","text-sm transition-colors text-left","text-light","enabled:group-hover:text-foreground group-data-[state=checked]:text-foreground"),children:r}),d.description&&(0,n.jsx)("p",{className:"text-sm text-foreground-lighter",children:d.description}),d.children]})]})})});d.displayName="RadioGroupStackedItem"},38985:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(86848).A)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},40713:(e,t,a)=>{"use strict";a.d(t,{A:()=>x});var n=a(53037),s=a(31530),r=a(53995),i=a(25257),l=a(42034);let o=e=>()=>e;function c(e,{sourceEvent:t,subject:a,target:n,identifier:s,active:r,x:i,y:l,dx:o,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:a,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:o,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}function d(e){return!e.ctrlKey&&!e.button}function u(){return this.parentNode}function m(e,t){return null==t?{x:e.x,y:e.y}:t}function p(){return navigator.maxTouchPoints||"ontouchstart"in this}function x(){var e,t,a,x,h=d,f=u,y=m,g=p,j={},b=(0,n.A)("start","drag","end"),v=0,N=0;function w(e){e.on("mousedown.drag",S).filter(g).on("touchstart.drag",C).on("touchmove.drag",k,l.vr).on("touchend.drag touchcancel.drag",I).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function S(n,r){if(!x&&h.call(this,n,r)){var o=R(this,f.call(this,n,r),n,r,"mouse");o&&((0,s.A)(n.view).on("mousemove.drag",A,l.Rw).on("mouseup.drag",_,l.Rw),(0,i.A)(n.view),(0,l.GK)(n),a=!1,e=n.clientX,t=n.clientY,o("start",n))}}function A(n){if((0,l.Ay)(n),!a){var s=n.clientX-e,r=n.clientY-t;a=s*s+r*r>N}j.mouse("drag",n)}function _(e){(0,s.A)(e.view).on("mousemove.drag mouseup.drag",null),(0,i.y)(e.view,a),(0,l.Ay)(e),j.mouse("end",e)}function C(e,t){if(h.call(this,e,t)){var a,n,s=e.changedTouches,r=f.call(this,e,t),i=s.length;for(a=0;a<i;++a)(n=R(this,r,e,t,s[a].identifier,s[a]))&&((0,l.GK)(e),n("start",e,s[a]))}}function k(e){var t,a,n=e.changedTouches,s=n.length;for(t=0;t<s;++t)(a=j[n[t].identifier])&&((0,l.Ay)(e),a("drag",e,n[t]))}function I(e){var t,a,n=e.changedTouches,s=n.length;for(x&&clearTimeout(x),x=setTimeout(function(){x=null},500),t=0;t<s;++t)(a=j[n[t].identifier])&&((0,l.GK)(e),a("end",e,n[t]))}function R(e,t,a,n,s,i){var l,o,d,u=b.copy(),m=(0,r.A)(i||a,t);if(null!=(d=y.call(e,new c("beforestart",{sourceEvent:a,target:w,identifier:s,active:v,x:m[0],y:m[1],dx:0,dy:0,dispatch:u}),n)))return l=d.x-m[0]||0,o=d.y-m[1]||0,function a(i,p,x){var h,f=m;switch(i){case"start":j[s]=a,h=v++;break;case"end":delete j[s],--v;case"drag":m=(0,r.A)(x||p,t),h=v}u.call(i,e,new c(i,{sourceEvent:p,subject:d,target:w,identifier:s,active:h,x:m[0]+l,y:m[1]+o,dx:m[0]-f[0],dy:m[1]-f[1],dispatch:u}),n)}}return w.filter=function(e){return arguments.length?(h="function"==typeof e?e:o(!!e),w):h},w.container=function(e){return arguments.length?(f="function"==typeof e?e:o(e),w):f},w.subject=function(e){return arguments.length?(y="function"==typeof e?e:o(e),w):y},w.touchable=function(e){return arguments.length?(g="function"==typeof e?e:o(!!e),w):g},w.on=function(){var e=b.on.apply(b,arguments);return e===b?w:e},w.clickDistance=function(e){return arguments.length?(N=(e*=1)*e,w):Math.sqrt(N)},w}c.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e}},41313:()=>{},42459:(e,t,a)=>{"use strict";a.d(t,{c:()=>c});var n=a(80263),s=a(52555),r=a.n(s),i=a(80100),l=a(99779),o=a(44725);let c=e=>{let{urlBack:t,fullHeight:a=!0}=e;return(0,n.jsx)("div",{className:(0,i.cn)("w-full flex items-center justify-center",a&&"h-full"),"data-sentry-component":"UnknownInterface","data-sentry-source-file":"UnknownInterface.tsx",children:(0,n.jsx)(o.Z,{type:"note",className:"max-w-xl",title:"Looking for something?",description:"We couldn't find the page that you're looking for","data-sentry-element":"Admonition","data-sentry-source-file":"UnknownInterface.tsx",children:(0,n.jsx)(l.$,{asChild:!0,type:"default",className:"mt-2","data-sentry-element":"Button","data-sentry-source-file":"UnknownInterface.tsx",children:(0,n.jsx)(r(),{href:t,"data-sentry-element":"Link","data-sentry-source-file":"UnknownInterface.tsx",children:"Head back"})})})})}},42890:(e,t,a)=>{"use strict";var n=a(53239),s=a(87044),r="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=s.useSyncExternalStore,l=n.useRef,o=n.useEffect,c=n.useMemo,d=n.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,a,n,s){var u=l(null);if(null===u.current){var m={hasValue:!1,value:null};u.current=m}else m=u.current;var p=i(e,(u=c(function(){function e(e){if(!o){if(o=!0,i=e,e=n(e),void 0!==s&&m.hasValue){var t=m.value;if(s(t,e))return l=t}return l=e}if(t=l,r(i,e))return t;var a=n(e);return void 0!==s&&s(t,a)?t:(i=e,l=a)}var i,l,o=!1,c=void 0===a?null:a;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]},[t,a,n,s]))[0],u[1]);return o(function(){m.hasValue=!0,m.value=p},[p]),d(p),p}},45452:(e,t,a)=>{"use strict";function n(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(let[a,n]of e)if(!Object.is(n,t.get(a)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(let a of e)if(!t.has(a))return!1;return!0}let a=Object.keys(e);if(a.length!==Object.keys(t).length)return!1;for(let n=0;n<a.length;n++)if(!Object.prototype.hasOwnProperty.call(t,a[n])||!Object.is(e[a[n]],t[a[n]]))return!1;return!0}a.d(t,{x:()=>n})},48465:(e,t,a)=>{"use strict";a.d(t,{V:()=>x,_:()=>n});var n,s=a(53239),r=a(67057),i=a(26218),l=a(45452);function o({color:e,dimensions:t,lineWidth:a}){return s.createElement("path",{stroke:e,strokeWidth:a,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function c({color:e,radius:t}){return s.createElement("circle",{cx:t,cy:t,r:t,fill:e})}!function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"}(n||(n={}));let d={[n.Dots]:"#91919a",[n.Lines]:"#eee",[n.Cross]:"#e2e2e2"},u={[n.Dots]:1,[n.Lines]:1,[n.Cross]:6},m=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function p({id:e,variant:t=n.Dots,gap:a=20,size:p,lineWidth:x=1,offset:h=2,color:f,style:y,className:g}){let j=(0,s.useRef)(null),{transform:b,patternId:v}=(0,i.Pj)(m,l.x),N=f||d[t],w=p||u[t],S=t===n.Dots,A=t===n.Cross,_=Array.isArray(a)?a:[a,a],C=[_[0]*b[2]||1,_[1]*b[2]||1],k=w*b[2],I=A?[k,k]:C,R=S?[k/h,k/h]:[I[0]/h,I[1]/h];return s.createElement("svg",{className:(0,r.A)(["react-flow__background",g]),style:{...y,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:j,"data-testid":"rf__background"},s.createElement("pattern",{id:v+e,x:b[0]%C[0],y:b[1]%C[1],width:C[0],height:C[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${R[0]},-${R[1]})`},S?s.createElement(c,{color:N,radius:k/h}):s.createElement(o,{dimensions:I,color:N,lineWidth:x})),s.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${v+e})`}))}p.displayName="Background";var x=(0,s.memo)(p)},49697:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(86848).A)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]])},50286:(e,t,a)=>{"use strict";a.d(t,{UC:()=>ei,Y9:()=>es,q7:()=>en,bL:()=>ea,l9:()=>er});var n=a(53239),s=a(30106),r=a(56070),i=a(71896),l=a(41375),o=a(57535),c=a(50155),d=a(78395),u=a(21388),m=a(30219),p=a(80263),x="Collapsible",[h,f]=(0,s.A)(x),[y,g]=h(x),j=n.forwardRef((e,t)=>{let{__scopeCollapsible:a,open:s,defaultOpen:r,disabled:i,onOpenChange:l,...d}=e,[u,h]=(0,o.i)({prop:s,defaultProp:r??!1,onChange:l,caller:x});return(0,p.jsx)(y,{scope:a,disabled:i,contentId:(0,m.B)(),open:u,onOpenToggle:n.useCallback(()=>h(e=>!e),[h]),children:(0,p.jsx)(c.sG.div,{"data-state":A(u),"data-disabled":i?"":void 0,...d,ref:t})})});j.displayName=x;var b="CollapsibleTrigger",v=n.forwardRef((e,t)=>{let{__scopeCollapsible:a,...n}=e,s=g(b,a);return(0,p.jsx)(c.sG.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":A(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...n,ref:t,onClick:(0,l.mK)(e.onClick,s.onOpenToggle)})});v.displayName=b;var N="CollapsibleContent",w=n.forwardRef((e,t)=>{let{forceMount:a,...n}=e,s=g(N,e.__scopeCollapsible);return(0,p.jsx)(u.C,{present:a||s.open,children:({present:e})=>(0,p.jsx)(S,{...n,ref:t,present:e})})});w.displayName=N;var S=n.forwardRef((e,t)=>{let{__scopeCollapsible:a,present:s,children:r,...l}=e,o=g(N,a),[u,m]=n.useState(s),x=n.useRef(null),h=(0,i.s)(t,x),f=n.useRef(0),y=f.current,j=n.useRef(0),b=j.current,v=o.open||u,w=n.useRef(v),S=n.useRef(void 0);return n.useEffect(()=>{let e=requestAnimationFrame(()=>w.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,d.N)(()=>{let e=x.current;if(e){S.current=S.current||{transitionDuration:e.style.transitionDuration,animationName:e.style.animationName},e.style.transitionDuration="0s",e.style.animationName="none";let t=e.getBoundingClientRect();f.current=t.height,j.current=t.width,w.current||(e.style.transitionDuration=S.current.transitionDuration,e.style.animationName=S.current.animationName),m(s)}},[o.open,s]),(0,p.jsx)(c.sG.div,{"data-state":A(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!v,...l,ref:h,style:{"--radix-collapsible-content-height":y?`${y}px`:void 0,"--radix-collapsible-content-width":b?`${b}px`:void 0,...e.style},children:v&&r})});function A(e){return e?"open":"closed"}var _=a(39963),C="Accordion",k=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[I,R,D]=(0,r.N)(C),[E,P]=(0,s.A)(C,[D,f]),M=f(),B=n.forwardRef((e,t)=>{let{type:a,...n}=e;return(0,p.jsx)(I.Provider,{scope:e.__scopeAccordion,children:"multiple"===a?(0,p.jsx)(K,{...n,ref:t}):(0,p.jsx)(O,{...n,ref:t})})});B.displayName=C;var[T,F]=E(C),[L,q]=E(C,{collapsible:!1}),O=n.forwardRef((e,t)=>{let{value:a,defaultValue:s,onValueChange:r=()=>{},collapsible:i=!1,...l}=e,[c,d]=(0,o.i)({prop:a,defaultProp:s??"",onChange:r,caller:C});return(0,p.jsx)(T,{scope:e.__scopeAccordion,value:n.useMemo(()=>c?[c]:[],[c]),onItemOpen:d,onItemClose:n.useCallback(()=>i&&d(""),[i,d]),children:(0,p.jsx)(L,{scope:e.__scopeAccordion,collapsible:i,children:(0,p.jsx)($,{...l,ref:t})})})}),K=n.forwardRef((e,t)=>{let{value:a,defaultValue:s,onValueChange:r=()=>{},...i}=e,[l,c]=(0,o.i)({prop:a,defaultProp:s??[],onChange:r,caller:C}),d=n.useCallback(e=>c((t=[])=>[...t,e]),[c]),u=n.useCallback(e=>c((t=[])=>t.filter(t=>t!==e)),[c]);return(0,p.jsx)(T,{scope:e.__scopeAccordion,value:l,onItemOpen:d,onItemClose:u,children:(0,p.jsx)(L,{scope:e.__scopeAccordion,collapsible:!0,children:(0,p.jsx)($,{...i,ref:t})})})}),[z,Q]=E(C),$=n.forwardRef((e,t)=>{let{__scopeAccordion:a,disabled:s,dir:r,orientation:o="vertical",...d}=e,u=n.useRef(null),m=(0,i.s)(u,t),x=R(a),h="ltr"===(0,_.jH)(r),f=(0,l.mK)(e.onKeyDown,e=>{if(!k.includes(e.key))return;let t=e.target,a=x().filter(e=>!e.ref.current?.disabled),n=a.findIndex(e=>e.ref.current===t),s=a.length;if(-1===n)return;e.preventDefault();let r=n,i=s-1,l=()=>{(r=n+1)>i&&(r=0)},c=()=>{(r=n-1)<0&&(r=i)};switch(e.key){case"Home":r=0;break;case"End":r=i;break;case"ArrowRight":"horizontal"===o&&(h?l():c());break;case"ArrowDown":"vertical"===o&&l();break;case"ArrowLeft":"horizontal"===o&&(h?c():l());break;case"ArrowUp":"vertical"===o&&c()}let d=r%s;a[d].ref.current?.focus()});return(0,p.jsx)(z,{scope:a,disabled:s,direction:r,orientation:o,children:(0,p.jsx)(I.Slot,{scope:a,children:(0,p.jsx)(c.sG.div,{...d,"data-orientation":o,ref:m,onKeyDown:s?void 0:f})})})}),U="AccordionItem",[G,V]=E(U),Y=n.forwardRef((e,t)=>{let{__scopeAccordion:a,value:n,...s}=e,r=Q(U,a),i=F(U,a),l=M(a),o=(0,m.B)(),c=n&&i.value.includes(n)||!1,d=r.disabled||e.disabled;return(0,p.jsx)(G,{scope:a,open:c,disabled:d,triggerId:o,children:(0,p.jsx)(j,{"data-orientation":r.orientation,"data-state":et(c),...l,...s,ref:t,disabled:d,open:c,onOpenChange:e=>{e?i.onItemOpen(n):i.onItemClose(n)}})})});Y.displayName=U;var J="AccordionHeader",H=n.forwardRef((e,t)=>{let{__scopeAccordion:a,...n}=e,s=Q(C,a),r=V(J,a);return(0,p.jsx)(c.sG.h3,{"data-orientation":s.orientation,"data-state":et(r.open),"data-disabled":r.disabled?"":void 0,...n,ref:t})});H.displayName=J;var W="AccordionTrigger",Z=n.forwardRef((e,t)=>{let{__scopeAccordion:a,...n}=e,s=Q(C,a),r=V(W,a),i=q(W,a),l=M(a);return(0,p.jsx)(I.ItemSlot,{scope:a,children:(0,p.jsx)(v,{"aria-disabled":r.open&&!i.collapsible||void 0,"data-orientation":s.orientation,id:r.triggerId,...l,...n,ref:t})})});Z.displayName=W;var X="AccordionContent",ee=n.forwardRef((e,t)=>{let{__scopeAccordion:a,...n}=e,s=Q(C,a),r=V(X,a),i=M(a);return(0,p.jsx)(w,{role:"region","aria-labelledby":r.triggerId,"data-orientation":s.orientation,...i,...n,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});function et(e){return e?"open":"closed"}ee.displayName=X;var ea=B,en=Y,es=H,er=Z,ei=ee},52366:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n={credentials:e=>["projects",e,"storage-credentials"]}},54916:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/database/etl",function(){return a(62715)}])},60734:(e,t,a)=>{"use strict";a.d(t,{S:()=>c});var n=a(51355),s=a(80210),r=a(73969),i=a(24523),l=a(52366);let o=async e=>{let{description:t,projectRef:a}=e;if(!a)throw Error("projectRef is required");let{data:n,error:s}=await (0,i.bE)("/platform/storage/{ref}/credentials",{params:{path:{ref:a}},body:{description:t}});return s&&(0,i.H4)(s),n};function c(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,n.jE)();return(0,s.n)({mutationFn:e=>o(e),async onSuccess(t,a,n){let{projectRef:s}=a;await i.invalidateQueries({queryKey:l.A.credentials(s)}),await (null==e?void 0:e(t,a,n))},async onError(e,a,n){void 0===t?r.oR.error("Failed to create S3 access key: ".concat(e.message)):t(e,a,n)},...a})}},61262:(e,t,a)=>{"use strict";e.exports=a(42890)},62715:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>tL});var n=a(80263),s=a(22891),r=a(38985),i=a(37724),l=a(90376),o=a(34866),c=a(74310),d=a(796),u=a(52555),m=a.n(u),p=a(53239),x=a(26218),h=a(48465);a(41313);var f=a(85039),y=a(78039),g=a(21650),j=a(99779),b=a(56581);let v=[{id:"1",type:"primary",data:{label:"Primary Database",region:"East US (Ohio)",provider:"AWS",regionIcon:"us-east-1"},position:{x:825,y:0}},{id:"2",type:"replica",data:{label:"Iceberg",details:"3 tables",regionIcon:"us-west-1"},position:{x:875,y:110}},{id:"3",type:"replica",data:{label:"BigQuery",details:"5 tables",regionIcon:"us-west-1"},position:{x:875,y:200}},{id:"4",type:"blank",position:{x:875,y:290},data:{}},{id:"5",type:"cta",position:{x:125,y:20},data:{}}],N=[{id:"e1-2",source:"1",target:"2",type:"smoothstep",animated:!0},{id:"e1-3",source:"1",target:"3",type:"smoothstep",animated:!0},{id:"e1-4",source:"1",target:"4",type:"smoothstep",animated:!0}],w=e=>{let{projectRef:t}=e;return(0,n.jsx)(x.Ln,{"data-sentry-element":"ReactFlowProvider","data-sentry-component":"ReplicationComingSoon","data-sentry-source-file":"ComingSoon.tsx",children:(0,n.jsx)(S,{projectRef:t,"data-sentry-element":"ReplicationStaticMockup","data-sentry-source-file":"ComingSoon.tsx"})})},S=e=>{let{projectRef:t}=e,a=(0,p.useMemo)(()=>v,[]),s=(0,p.useMemo)(()=>N,[]),{resolvedTheme:r}=(0,d.D)(),i=(0,p.useMemo)(()=>({primary:A,replica:_,blank:C,cta:()=>k({projectRef:t})}),[t]);return(0,n.jsx)("div",{className:"relative border-t h-full w-full","data-sentry-component":"ReplicationStaticMockup","data-sentry-source-file":"ComingSoon.tsx",children:(0,n.jsx)(x.Gc,{fitView:!0,fitViewOptions:{minZoom:.9,maxZoom:.9},className:"instance-configuration",zoomOnPinch:!1,zoomOnScroll:!1,nodesDraggable:!0,nodesConnectable:!1,zoomOnDoubleClick:!1,edgesFocusable:!1,edgesUpdatable:!1,nodes:a,edges:s,nodeTypes:i,proOptions:{hideAttribution:!0},"data-sentry-element":"ReactFlow","data-sentry-source-file":"ComingSoon.tsx",children:(0,n.jsx)(h.V,{color:"dark"===r?"rgba(255, 255, 255, 0.3)":"rgba(0, 0, 0, 0.4)","data-sentry-element":"Background","data-sentry-source-file":"ComingSoon.tsx"})})})},A=e=>{let{data:t}=e;return(0,n.jsxs)("div",{className:"flex flex-col rounded bg-surface-100 border border-default","data-sentry-component":"PrimaryNode","data-sentry-source-file":"ComingSoon.tsx",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between p-3",style:{width:b.M4/2+55},children:[(0,n.jsxs)("div",{className:"flex gap-x-3",children:[(0,n.jsx)("div",{className:"w-8 h-8 bg-brand-500 border border-brand-600 rounded-md flex items-center justify-center",children:(0,n.jsx)(r.A,{size:16,"data-sentry-element":"Database","data-sentry-source-file":"ComingSoon.tsx"})}),(0,n.jsxs)("div",{className:"flex flex-col gap-y-0.5",children:[(0,n.jsx)("p",{className:"text-sm",children:t.label}),(0,n.jsx)("p",{className:"flex items-center gap-x-1",children:(0,n.jsx)("span",{className:"text-sm text-foreground-light",children:t.region})}),(0,n.jsx)("p",{className:"flex items-center gap-x-1",children:(0,n.jsx)("span",{className:"text-sm text-foreground-light",children:t.provider})})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("img",{alt:"region icon",className:"w-6 rounded-sm mt-0.5",src:"".concat(f.o2,"/img/regions/").concat(t.regionIcon,".svg")}),(0,n.jsx)(i.A,{size:10,className:"bg-brand-500 stroke-none rounded-full","data-sentry-element":"Circle","data-sentry-source-file":"ComingSoon.tsx"})]})]}),(0,n.jsx)(x.h7,{type:"source",position:x.yX.Left,className:"opacity-25","data-sentry-element":"Handle","data-sentry-source-file":"ComingSoon.tsx"})]})},_=e=>{let{data:t}=e;return(0,n.jsxs)("div",{className:"flex flex-col rounded bg-surface-100 border border-default px-2","data-sentry-component":"ReplicaNode","data-sentry-source-file":"ComingSoon.tsx",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between p-3",style:{width:b.M4/2-10},children:[(0,n.jsx)("div",{className:"flex gap-x-3",children:(0,n.jsxs)("div",{className:"flex flex-col gap-y-0.5",children:[(0,n.jsx)("p",{className:"",children:t.label}),(0,n.jsx)("p",{className:"flex items-center gap-x-1",children:(0,n.jsx)("span",{className:"text-sm text-foreground-light",children:t.details})})]})}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("img",{alt:"region icon",className:"w-6 rounded-sm mt-0.5",src:"".concat(f.o2,"/img/regions/").concat(t.regionIcon,".svg")}),(0,n.jsx)(i.A,{size:10,className:"bg-brand-500 stroke-none rounded-full","data-sentry-element":"Circle","data-sentry-source-file":"ComingSoon.tsx"})]})]}),(0,n.jsx)(x.h7,{type:"target",position:x.yX.Left,className:"opacity-25","data-sentry-element":"Handle","data-sentry-source-file":"ComingSoon.tsx"})]})},C=()=>(0,n.jsx)("div",{className:"flex flex-col rounded bg-surface-100 border border-default px-1","data-sentry-component":"BlankNode","data-sentry-source-file":"ComingSoon.tsx",children:(0,n.jsxs)("div",{className:"flex items-start justify-between p-3",style:{width:b.M4/2},children:[(0,n.jsx)("div",{className:"flex gap-x-3",children:(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)(l.A,{size:16,"data-sentry-element":"Plus","data-sentry-source-file":"ComingSoon.tsx"}),(0,n.jsx)("span",{className:"text-sm",children:"Add new"})]})}),(0,n.jsx)(x.h7,{type:"target",position:x.yX.Left,className:"opacity-25","data-sentry-element":"Handle","data-sentry-source-file":"ComingSoon.tsx"})]})}),k=e=>{let{projectRef:t}=e;return(0,n.jsx)(y.Zp,{className:"w-[500px] p-6","data-sentry-element":"Card","data-sentry-component":"CTANode","data-sentry-source-file":"ComingSoon.tsx",children:(0,n.jsxs)(y.Wu,{"data-sentry-element":"CardContent","data-sentry-source-file":"ComingSoon.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2 justify-between mb-2",children:[(0,n.jsx)("h2",{className:"text-lg",children:"Replicate data to destinations in real-time"}),(0,n.jsx)(g.E,{variant:"warning","data-sentry-element":"Badge","data-sentry-source-file":"ComingSoon.tsx",children:"Early Access"})]}),(0,n.jsx)("p",{className:"text-foreground-light",children:"Replicate database changes to multiple destinations with ETL replication - no manual exports, no lag. Limited rollout for external destinations has begun, read replicas available now."}),(0,n.jsxs)("div",{className:"flex items-center gap-x-2 mt-6",children:[(0,n.jsx)(j.$,{asChild:!0,type:"secondary",iconRight:(0,n.jsx)(o.A,{size:16,strokeWidth:1.5}),"data-sentry-element":"Button","data-sentry-source-file":"ComingSoon.tsx",children:(0,n.jsx)(m(),{href:"https://forms.supabase.com/pg_replicate",target:"_blank",rel:"noreferrer","data-sentry-element":"Link","data-sentry-source-file":"ComingSoon.tsx",children:"Request early access"})}),(0,n.jsx)(j.$,{asChild:!0,type:"default",iconRight:(0,n.jsx)(c.A,{size:16,strokeWidth:1.5}),"data-sentry-element":"Button","data-sentry-source-file":"ComingSoon.tsx",children:(0,n.jsx)(m(),{href:"/project/".concat(t,"/settings/infrastructure?createReplica=true"),"data-sentry-element":"Link","data-sentry-source-file":"ComingSoon.tsx",children:"Create a read replica"})})]})]})})};var I=a(51355),R=a(31092),D=a(68856),E=a(44168),P=a(41273),M=a(86541),B=a(93824),T=a(26004),F=a(4922),L=a(85694),q=a(97003),O=a(84512),K=a(27371),z=a(80100),Q=a(16488),$=a(32981),U=a(52793),G=a.n(U),V=a(87494),Y=a(73969),J=a(25580),H=a(12957),W=a(76750),Z=a(27664),X=a(67850),ee=a(59356),et=a(32510);async function ea(e){let{projectRef:t,connectionString:a,tables:n}=e;if(!t)throw Error("Project ref is required");let{result:s}=await (0,ee.E)({projectRef:t,connectionString:a,sql:(e=>{let t=e.map(e=>"'".concat(e.schema,".").concat(e.name,"'")).join(",");return"\nWITH targets(rel) AS (\n  SELECT unnest(ARRAY[".concat(t,"]::regclass[])\n)\nSELECT\n  c.oid AS id,\n  n.nspname AS schema,\n  c.relname AS name,\n  (con.conrelid IS NOT NULL) AS has_primary_key\nFROM targets t\nJOIN pg_class c ON c.oid = t.rel\nJOIN pg_namespace n ON n.oid = c.relnamespace\nLEFT JOIN pg_constraint con\n  ON con.conrelid = c.oid AND con.contype = 'p'\nORDER BY n.nspname, c.relname;\n")})(n)});return{offendingTables:s.filter(e=>!e.has_primary_key)}}let en=function(e){let{projectRef:t,connectionString:a,tables:n}=e,{enabled:s=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,X.I)({queryKey:et.c.checkPrimaryKeysExists(t,n),queryFn:()=>ea({projectRef:t,connectionString:a,tables:n}),retry:!1,enabled:s&&void 0!==t&&n.length>0,...r})};var es=a(35238),er=a(24523);async function ei(e,t){let{projectRef:a,destinationId:n}=e;if(!a)throw Error("projectRef is required");if(!n)throw Error("destinationId is required");let{data:s,error:r}=await (0,er.Jt)("/platform/replication/{ref}/destinations/{destination_id}",{params:{path:{ref:a,destination_id:n}},signal:t});return r&&(0,er.H4)(r),s}let el=function(e){let{projectRef:t,destinationId:a}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,X.I)({queryKey:T.l.destinationById(t,a),queryFn:e=>{let{signal:n}=e;return ei({projectRef:t,destinationId:a},n)},enabled:n&&void 0!==t&&void 0!==a,...s})};var eo=a(10283),ec=a(99269),ed=a(34991),eu=a(15135),em=a(80210);async function ep(e,t){let a,{destinationId:n,pipelineId:s,projectRef:r,destinationName:i,destinationConfig:l,pipelineConfig:{publicationName:o,batch:c},sourceId:d}=e;if(!r)throw Error("projectRef is required");if("bigQuery"in l){let{projectId:e,datasetId:t,serviceAccountKey:n,maxStalenessMins:s}=l.bigQuery;a={big_query:{project_id:e,dataset_id:t,service_account_key:n,...null!==s?{max_staleness_mins:s}:{}}}}else if("iceberg"in l){let{projectRef:e,warehouseName:t,namespace:n,catalogToken:s,s3AccessKeyId:r,s3SecretAccessKey:i,s3Region:o}=l.iceberg;a={iceberg:{supabase:{project_ref:e,warehouse_name:t,namespace:n,catalog_token:s,s3_access_key_id:r,s3_secret_access_key:i,s3_region:o}}}}else throw Error("Invalid destination config: must specify either bigQuery or iceberg");let{data:u,error:m}=await (0,er.bE)("/platform/replication/{ref}/destinations-pipelines/{destination_id}/{pipeline_id}",{params:{path:{ref:r,destination_id:n,pipeline_id:s}},body:{destination_config:a,source_id:d,destination_name:i,pipeline_config:{publication_name:o,...c?{batch:{max_fill_ms:c.maxFillMs}}:{}}},signal:t});return m&&(0,er.H4)(m),u}let ex=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,I.jE)();return(0,em.n)({mutationFn:e=>ep(e),async onSuccess(t,a,s){let{projectRef:r,destinationId:i,pipelineId:l}=a;await Promise.all([n.invalidateQueries({queryKey:T.l.destinations(r)}),n.invalidateQueries({queryKey:T.l.pipelines(r)}),n.invalidateQueries({queryKey:T.l.destinationById(r,i)}),n.invalidateQueries({queryKey:T.l.pipelineById(r,l)})]),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){void 0===t?Y.oR.error("Failed to update destination or pipeline: ".concat(e.message)):t(e,a,n)},...a})};var eh=a(90702),ef=a(80658);let ey="Failed to create Iceberg namespace";async function eg(e){let{projectRef:t,catalogUri:a,warehouse:n,namespace:s}=e;try{if(!t)throw Error("".concat(ey,": projectRef is required"));let e=(await (0,eh.z4)(t)).apiKey,r=new Headers;(r=await (0,er.We)({"Content-Type":"application/json",apikey:e})).delete("Authorization");let i="".concat(a,"/v1/").concat(n,"/namespaces").replaceAll(RegExp("(?<!:)\\/\\/","g"),"/"),l=await (0,er.x8)(i,{headers:r,method:"POST",body:JSON.stringify({namespace:s})}),o=await l.json();if(o.error)if(o.error.message)throw Error("".concat(ey,": ").concat(o.error.message));else throw Error(ey);return o}catch(e){(0,er.H4)(e)}}let ej=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,I.jE)();return(0,em.n)({mutationFn:e=>eg({...e}),async onSuccess(t,a,s){await n.invalidateQueries({queryKey:ef.w.icebergNamespace({projectRef:a.projectRef,catalog:a.catalogUri,warehouse:a.warehouse,namespace:a.namespace})}),await n.invalidateQueries({queryKey:ef.w.icebergNamespaces({projectRef:a.projectRef,catalog:a.catalogUri,warehouse:a.warehouse})}),await (null==e?void 0:e(t,a,s))},async onError(e,a,n){if("Request failed with status code 409"===e.message)return void Y.oR.error("A namespace named ".concat(a.namespace," already exists in the catalog."));void 0===t?Y.oR.error("Failed to create Iceberg namespace: ".concat(e.message)):t(e,a,n)},...a})};var eb=a(60734),ev=a(9620),eN=a(12006),ew=a(65346),eS=a(65887),eA=a(95137),e_=a(68152),eC=a(10663),ek=a(99487),eI=a(65084),eR=a(44053),eD=a(49742);let eE=e=>{let{visible:t,sourceId:a,onClose:r}=e,{ref:i}=(0,s.g)(),{mutateAsync:l,isPending:o}=(0,ek.F)(),{data:c}=(0,eI.b)({projectRef:i,sourceId:a}),d="publication-editor",u=eC.Ik({name:eC.Yj().min(1,"Name is required"),tables:eC.YO(eC.Yj()).min(1,"At least one table is required")}),m={name:"",tables:[]},p=(0,V.mN)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,$.u)(u),defaultValues:m}),x=async e=>{if(!i)return console.error("Project ref is required");if(!a)return console.error("Source id is required");try{await l({projectRef:i,sourceId:a,name:e.name,tables:e.tables.map(e=>{let[t,a]=e.split(".");return{schema:t,name:a}})}),Y.oR.success("Successfully created publication"),r()}catch(e){Y.oR.error("Failed to create publication")}p.reset(m)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(ew.cj,{open:t,onOpenChange:r,"data-sentry-element":"Sheet","data-sentry-source-file":"NewPublicationPanel.tsx",children:(0,n.jsx)(ew.h,{showClose:!1,size:"default","data-sentry-element":"SheetContent","data-sentry-source-file":"NewPublicationPanel.tsx",children:(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[(0,n.jsx)(ew.Fm,{"data-sentry-element":"SheetHeader","data-sentry-source-file":"NewPublicationPanel.tsx",children:(0,n.jsxs)("div",{className:"flex flex-row justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(ew.qp,{"data-sentry-element":"SheetTitle","data-sentry-source-file":"NewPublicationPanel.tsx",children:"New Publication"}),(0,n.jsx)(ew.Qs,{"data-sentry-element":"SheetDescription","data-sentry-source-file":"NewPublicationPanel.tsx",children:"Create a new publication to replicate table changes to destinations"})]}),(0,n.jsxs)(ew.kN,{className:(0,z.cn)("text-muted hover:opacity-100","focus:outline-none focus:ring-2","disabled:pointer-events-none"),"data-sentry-element":"SheetClose","data-sentry-source-file":"NewPublicationPanel.tsx",children:[(0,n.jsx)(e_.A,{className:"h-3 w-3","data-sentry-element":"X","data-sentry-source-file":"NewPublicationPanel.tsx"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]})]})}),(0,n.jsx)(ew.Xc,{className:"flex-grow overflow-auto","data-sentry-element":"SheetSection","data-sentry-source-file":"NewPublicationPanel.tsx",children:(0,n.jsx)(eS.lV,{...p,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"NewPublicationPanel.tsx",children:(0,n.jsxs)("form",{id:d,onSubmit:p.handleSubmit(x),className:"flex flex-col gap-y-4",children:[(0,n.jsx)(eS.zB,{control:p.control,name:"name",render:e=>{let{field:t}=e;return(0,n.jsx)(eR.M,{label:"Name",layout:"vertical",children:(0,n.jsx)(eS.MJ,{children:(0,n.jsx)(K.p,{...t,placeholder:"Name"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"NewPublicationPanel.tsx"}),(0,n.jsx)(eS.zB,{control:p.control,name:"tables",render:e=>{let{field:t}=e;return(0,n.jsx)(eR.M,{label:"Tables",description:"Which tables to replicate to destinations",children:(0,n.jsx)(eS.MJ,{children:(0,n.jsxs)(eD.xf,{values:t.value,onValuesChange:t.onChange,disabled:o,children:[(0,n.jsx)(eD.xf.Trigger,{children:(0,n.jsx)(eD.xf.Input,{placeholder:"Select tables"})}),(0,n.jsx)(eD.xf.Content,{children:(0,n.jsx)(eD.xf.List,{children:null==c?void 0:c.map(e=>(0,n.jsx)(eD.xf.Item,{value:"".concat(e.schema,".").concat(e.name),children:"".concat(e.schema,".").concat(e.name)},"".concat(e.schema,".").concat(e.name)))})})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"NewPublicationPanel.tsx"})]})})}),(0,n.jsxs)(ew.XW,{"data-sentry-element":"SheetFooter","data-sentry-source-file":"NewPublicationPanel.tsx",children:[(0,n.jsx)(j.$,{type:"default",disabled:o,onClick:r,"data-sentry-element":"Button","data-sentry-source-file":"NewPublicationPanel.tsx",children:"Cancel"}),(0,n.jsx)(j.$,{type:"primary",disabled:o,form:d,htmlType:"submit","data-sentry-element":"Button","data-sentry-source-file":"NewPublicationPanel.tsx",children:"Create publication"})]})]})})})})},eP=e=>{let{open:t,isLoading:a,onOpenChange:s,onConfirm:r}=e;return(0,n.jsx)(eA.lG,{open:t,onOpenChange:s,"data-sentry-element":"Dialog","data-sentry-component":"ReplicationDisclaimerDialog","data-sentry-source-file":"ReplicationDisclaimerDialog.tsx",children:(0,n.jsxs)(eA.Cf,{className:"sm:max-w-lg","data-sentry-element":"DialogContent","data-sentry-source-file":"ReplicationDisclaimerDialog.tsx",children:[(0,n.jsx)(eA.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"ReplicationDisclaimerDialog.tsx",children:(0,n.jsx)(eA.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"ReplicationDisclaimerDialog.tsx",children:"Replication limitations"})}),(0,n.jsx)(eA.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"ReplicationDisclaimerDialog.tsx"}),(0,n.jsxs)(eA.OO,{className:"space-y-4 text-sm","data-sentry-element":"DialogSection","data-sentry-source-file":"ReplicationDisclaimerDialog.tsx",children:[(0,n.jsx)("p",{className:"text-foreground",children:"Creating this replication pipeline will immediately start syncing data from your publication into the destination. Make sure you understand the limitations of the system before proceeding."}),(0,n.jsx)("div",{className:"text-foreground-light",children:(0,n.jsxs)("ul",{className:"list-disc flex flex-col gap-y-1.5 pl-5 text-sm leading-snug",children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{className:"text-foreground",children:"Custom data types replicate as strings."})," ","Check that the destination can interpret those string values correctly."]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{className:"text-foreground",children:"Generated columns are skipped."})," Replace them with triggers or materialized views if you need the derived values downstream."]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{className:"text-foreground",children:"FULL replica identity is strongly recommended."})," ","With FULL replica identity deletes and updates include the payload that is needed to correctly apply those changes."]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("strong",{className:"text-foreground",children:"Schema changes arenâ€™t supported yet."})," ","Plan for manual adjustments if you need to alter replicated tables."]})]})})]}),(0,n.jsx)(eA.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"ReplicationDisclaimerDialog.tsx"}),(0,n.jsxs)(eA.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"ReplicationDisclaimerDialog.tsx",children:[(0,n.jsx)(j.$,{type:"default",disabled:a,onClick:()=>s(!1),"data-sentry-element":"Button","data-sentry-source-file":"ReplicationDisclaimerDialog.tsx",children:"Cancel"}),(0,n.jsx)(j.$,{loading:a,onClick:r,"data-sentry-element":"Button","data-sentry-source-file":"ReplicationDisclaimerDialog.tsx",children:"Understood, start replication"})]})]})})};var eM=a(15833);let eB=e=>{let{form:t}=e,{type:a}=t.watch(),s=e=>t=>{let a=t.target.value;e.onChange(""===a?void 0:Number(a))};return(0,n.jsx)("div",{className:"px-5","data-sentry-component":"AdvancedSettings","data-sentry-source-file":"AdvancedSettings.tsx",children:(0,n.jsx)(eM.nD,{type:"single",collapsible:!0,"data-sentry-element":"Accordion_Shadcn_","data-sentry-source-file":"AdvancedSettings.tsx",children:(0,n.jsxs)(eM.As,{value:"item-1",className:"border-none","data-sentry-element":"AccordionItem_Shadcn_","data-sentry-source-file":"AdvancedSettings.tsx",children:[(0,n.jsx)(eM.$m,{className:"font-normal gap-2 justify-between text-sm py-3 hover:no-underline","data-sentry-element":"AccordionTrigger_Shadcn_","data-sentry-source-file":"AdvancedSettings.tsx",children:(0,n.jsxs)("div",{className:"flex flex-col items-start gap-0.5",children:[(0,n.jsx)("span",{className:"text-sm font-medium",children:"Advanced settings"}),(0,n.jsx)("span",{className:"text-sm text-foreground-lighter font-normal",children:"Optional performance tuning"})]})}),(0,n.jsxs)(eM.ub,{className:"!pb-0 space-y-6 pt-3","data-sentry-element":"AccordionContent_Shadcn_","data-sentry-source-file":"AdvancedSettings.tsx",children:[(0,n.jsx)(eS.zB,{control:t.control,name:"maxFillMs",render:e=>{var t;let{field:a}=e;return(0,n.jsx)(eR.M,{label:"Batch wait time (milliseconds)",layout:"vertical",description:"How long to wait for more changes before sending. Shorter times mean more real-time updates but higher overhead.",children:(0,n.jsx)(eS.MJ,{children:(0,n.jsx)(K.p,{...a,type:"number",value:null!=(t=a.value)?t:"",onChange:s(a),placeholder:"e.g., 5000 (5 seconds)"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"AdvancedSettings.tsx"}),"BigQuery"===a&&(0,n.jsx)("div",{className:"pt-2",children:(0,n.jsx)(eS.zB,{control:t.control,name:"maxStalenessMins",render:e=>{var t;let{field:a}=e;return(0,n.jsx)(eR.M,{label:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{children:"Maximum staleness (minutes)"}),(0,n.jsx)(g.E,{children:"BigQuery only"})]}),layout:"vertical",description:"Maximum age of cached data before BigQuery reads from base tables at query time. Lower values ensure fresher results but may increase query costs.",children:(0,n.jsx)(eS.MJ,{children:(0,n.jsx)(K.p,{...a,type:"number",value:null!=(t=a.value)?t:"",onChange:s(a),placeholder:"e.g. 60 (1 hour)"})})})}})})]})]})})})},eT=e=>{let{form:t}=e;return(0,n.jsx)(eS.zB,{control:t.control,name:"name",render:e=>{let{field:t}=e;return(0,n.jsx)(eR.M,{label:"Name",layout:"vertical",description:"A descriptive name to identify this destination",children:(0,n.jsx)(eS.MJ,{children:(0,n.jsx)(K.p,{...t,placeholder:"My destination"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-component":"DestinationNameInput","data-sentry-source-file":"DestinationNameInput.tsx"})},eF="create-new",eL="create-new-namespace";var eq=a(63324);let eO=eC.k5(["BigQuery","Analytics Bucket"]),eK=eC.Ik({type:eO,name:eC.Yj().min(1,"Name is required"),publicationName:eC.Yj().min(1,"Publication is required"),maxFillMs:eC.ai().min(1,"Max Fill milliseconds should be greater than 0").int().optional(),projectId:eC.Yj().optional(),datasetId:eC.Yj().optional(),serviceAccountKey:eC.Yj().optional(),maxStalenessMins:eC.ai().nonnegative().optional(),warehouseName:eC.Yj().optional(),namespace:eC.Yj().optional(),newNamespaceName:eC.Yj().optional(),catalogToken:eC.Yj().optional(),s3AccessKeyId:eC.Yj().optional(),s3SecretAccessKey:eC.Yj().optional(),s3Region:eC.Yj().optional()}).superRefine((e,t)=>{var a,n,s,r,i,l,o,c,d;let u=(e,a)=>{t.addIssue({code:eq.eq.custom,message:a,path:[e]})};if("BigQuery"===e.type)(null==(a=e.projectId)?void 0:a.length)||u("projectId","Project ID is required"),(null==(n=e.datasetId)?void 0:n.length)||u("datasetId","Dataset ID is required"),(null==(s=e.serviceAccountKey)?void 0:s.length)||u("serviceAccountKey","Service Account Key is required");else if("Analytics Bucket"===e.type){if((null==(r=e.warehouseName)?void 0:r.length)||u("warehouseName","Bucket is required"),!((null==(i=e.namespace)?void 0:i.length)&&"create-new-namespace"!==e.namespace||"create-new-namespace"===e.namespace&&(null==(l=e.newNamespaceName)?void 0:l.length))){let t="create-new-namespace"===e.namespace;u(t?"newNamespaceName":"namespace",t?"Namespace name is required":"Namespace is required")}(null==(o=e.s3Region)?void 0:o.length)||u("s3Region","S3 Region is required"),(null==(c=e.s3AccessKeyId)?void 0:c.length)||u("s3AccessKeyId","S3 Access Key ID is required"),"create-new"===e.s3AccessKeyId||(null==(d=e.s3SecretAccessKey)?void 0:d.length)||u("s3SecretAccessKey","S3 Secret Access Key is required")}});var ez=a(73886),eQ=a(93901),e$=a(23169),eU=a(10723),eG=a(3413),eV=a(73731),eY=a(96078),eJ=a(34634),eH=a(60793),eW=a(66329),eZ=a(44725),eX=a(64758);let e0=e=>{let{form:t}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"px-5 pt-5",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-foreground mb-1",children:"BigQuery settings"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light mb-4",children:"Configure how data is sent to your BigQuery destination"})]}),(0,n.jsxs)("div",{className:"space-y-4 pb-5",children:[(0,n.jsx)(eS.zB,{control:t.control,name:"projectId",render:e=>{let{field:t}=e;return(0,n.jsx)(eR.M,{layout:"vertical",className:"px-5",label:"Project ID",description:"The Google Cloud project ID where data will be sent",children:(0,n.jsx)(eS.MJ,{children:(0,n.jsx)(K.p,{...t,placeholder:"my-gcp-project"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DestinationPanelFields.tsx"}),(0,n.jsx)(eS.zB,{control:t.control,name:"datasetId",render:e=>{let{field:t}=e;return(0,n.jsx)(eR.M,{label:"Dataset ID",layout:"vertical",className:"px-5",description:"The BigQuery dataset where replicated tables will be created",children:(0,n.jsx)(eS.MJ,{children:(0,n.jsx)(K.p,{...t,placeholder:"my_dataset"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DestinationPanelFields.tsx"}),(0,n.jsx)(eS.zB,{control:t.control,name:"serviceAccountKey",render:e=>{let{field:t}=e;return(0,n.jsx)(eR.M,{layout:"vertical",className:"px-5",label:"Service Account Key",description:"Service account credentials JSON for authenticating with BigQuery",children:(0,n.jsx)(eS.MJ,{children:(0,n.jsx)(eJ.f,{...t,rows:5,maxLength:5e3,placeholder:'{"type": "service_account", "project_id": "...", ...}',className:"font-mono text-xs"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DestinationPanelFields.tsx"})]})]})},e1=e=>{var t,a;let{form:r,setIsFormInteracting:i}=e,{warehouseName:l,type:o,s3AccessKeyId:c,namespace:d}=r.watch(),[u,m]=(0,p.useState)(!1),[x,h]=(0,p.useState)(!1),{ref:f}=(0,s.g)(),{data:y}=(0,ev.YA)(),{canReadAPIKeys:g}=(0,J.u)(),{data:b}=(0,W.I)({projectRef:f,reveal:!0},{enabled:g}),{serviceKey:v}=(0,W.x)(b),N=null!=(t=null==v?void 0:v.api_key)?t:"",{data:w}=(0,Z.G)({projectRef:f}),{data:S,isSuccess:A,isLoading:_,isError:C}=(0,eY.r)({projectRef:f}),k=null!=(a=null==S?void 0:S.data)?a:[],I=(null!=c?c:"").length>0&&c!==eF&&!k.find(e=>e.access_key===c),{data:R=[],isLoading:D,isError:E}=(0,eG.j)({projectRef:f}),P=(0,p.useMemo)(()=>{var e,t,a,n;if(!(null==y?void 0:y.ref)||!w)return"";let s=null!=(n=null==(e=w.app_config)?void 0:e.protocol)?n:"https",r=(null==(t=w.app_config)?void 0:t.storage_endpoint)||(null==(a=w.app_config)?void 0:a.endpoint);return(0,H.Uj)(y.ref,s,r)},[null==y?void 0:y.ref,w]),M=!!l&&!!N,{data:B=[],isLoading:T,isError:F,refetch:L}=(0,eV.J)({projectRef:f,catalogUri:P,warehouse:l||""},{enabled:"Analytics Bucket"===o&&!!P&&!!l&&!!N});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"px-5 pt-5",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-foreground mb-1",children:"Analytics Bucket settings"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light mb-4",children:"Configure how data is sent to your Analytics Bucket destination"})]}),(0,n.jsxs)("div",{className:"space-y-4 pb-5",children:[(0,n.jsx)(eS.zB,{control:r.control,name:"warehouseName",render:e=>{let{field:t}=e;return(0,n.jsx)(eR.M,{label:"Bucket",layout:"vertical",className:"px-5",description:"The Analytics Bucket where data will be stored",children:D?(0,n.jsx)(j.$,{disabled:!0,type:"default",className:"w-full justify-between",size:"small",iconRight:(0,n.jsx)(ez.A,{className:"animate-spin"}),children:"Retrieving buckets"}):E?(0,n.jsx)(j.$,{disabled:!0,type:"default",className:"w-full justify-start",size:"small",icon:(0,n.jsx)(eH.id,{}),children:"Failed to retrieve buckets"}):(0,n.jsx)(eS.MJ,{children:(0,n.jsxs)(eW.l6,{value:t.value,onValueChange:e=>{i(!0),t.onChange(e),r.setValue("namespace","")},children:[(0,n.jsx)(eW.bq,{children:t.value||"Select a bucket"}),(0,n.jsx)(eW.gC,{children:(0,n.jsx)(eW.s3,{children:0===R.length?(0,n.jsx)(eW.eb,{value:"__no_buckets__",disabled:!0,children:"No buckets available"}):R.map(e=>(0,n.jsx)(eW.eb,{value:e.name,children:e.name},e.name))})})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DestinationPanelFields.tsx"}),(0,n.jsx)(eS.zB,{control:r.control,name:"namespace",render:e=>{let{field:t}=e;return(0,n.jsx)(eR.M,{label:"Namespace",layout:"vertical",className:"px-5",description:"The namespace within the bucket where tables will be organized",children:T&&M?(0,n.jsx)(j.$,{disabled:!0,type:"default",className:"w-full justify-between",size:"small",iconRight:(0,n.jsx)(ez.A,{className:"animate-spin"}),children:"Retrieving namespaces"}):F?(0,n.jsx)(j.$,{disabled:!0,type:"default",className:"w-full justify-start",size:"small",icon:(0,n.jsx)(eH.id,{}),children:"Failed to retrieve namespaces"}):(0,n.jsx)(eS.MJ,{children:(0,n.jsxs)(eW.l6,{value:t.value,onValueChange:e=>{i(!0),t.onChange(e)},disabled:!M,children:[(0,n.jsx)(eW.bq,{children:M?t.value===eL?"Create a new namespace":t.value||"Select a namespace":"Select a warehouse first"}),(0,n.jsx)(eW.gC,{children:(0,n.jsxs)(eW.s3,{children:[0===B.length?(0,n.jsx)(eW.eb,{value:"__no_namespaces__",disabled:!0,children:"No namespaces available"}):B.map(e=>(0,n.jsx)(eW.eb,{value:e,children:e},e)),B.length>0&&(0,n.jsx)(eW.mi,{}),(0,n.jsx)(eW.eb,{value:eL,children:"Create a new namespace"},eL)]})})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DestinationPanelFields.tsx"}),d===eL&&(0,n.jsx)(eS.zB,{control:r.control,name:"newNamespaceName",render:e=>{let{field:t}=e;return(0,n.jsx)(eR.M,{label:"New Namespace Name",layout:"vertical",className:"px-5",description:"A unique name for the new namespace",children:(0,n.jsx)(eS.MJ,{children:(0,n.jsx)(K.p,{...t,placeholder:"new_namespace",value:t.value||""})})})}}),(0,n.jsx)(eS.zB,{control:r.control,name:"catalogToken",render:e=>{let{field:t}=e;return(0,n.jsx)(eR.M,{layout:"vertical",label:"Catalog Token",className:"px-5",description:(0,n.jsxs)(n.Fragment,{children:["Automatically retrieved from your project's"," ",(0,n.jsx)(eU.g,{href:"/project/".concat(f,"/settings/api-keys"),children:"service role key"})]}),children:(0,n.jsx)(eX.p,{disabled:!0,value:t.value,type:u?"text":"password",placeholder:"Auto-populated",actions:N?(0,n.jsx)("div",{className:"flex items-center justify-center",children:(0,n.jsx)(j.$,{type:"default",className:"w-7",icon:u?(0,n.jsx)(eQ.A,{}):(0,n.jsx)(e$.A,{}),onClick:()=>m(!u)})}):null})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DestinationPanelFields.tsx"}),(0,n.jsx)(eS.zB,{control:r.control,name:"s3AccessKeyId",render:e=>{var t;let{field:a}=e;return(0,n.jsx)(eR.M,{layout:"vertical",label:"S3 Access Key ID",className:"px-5",children:_?(0,n.jsx)(j.$,{disabled:!0,type:"default",className:"w-full justify-between",size:"small",iconRight:(0,n.jsx)(ez.A,{className:"animate-spin"}),children:"Retrieving keys"}):C?(0,n.jsx)(j.$,{disabled:!0,type:"default",className:"w-full justify-start",size:"small",icon:(0,n.jsx)(eH.id,{}),children:"Failed to retrieve keys"}):(0,n.jsx)(eS.MJ,{children:(0,n.jsxs)(eW.l6,{value:a.value,onValueChange:a.onChange,children:[(0,n.jsx)(eW.bq,{children:a.value===eF?"Create a new key":0===(null!=(t=a.value)?t:"").length?"Select an access key ID":a.value}),(0,n.jsx)(eW.gC,{children:(0,n.jsxs)(eW.s3,{children:[k.map(e=>(0,n.jsxs)(eW.eb,{value:e.access_key,children:[e.access_key,(0,n.jsx)("p",{className:"text-foreground-lighter",children:e.description})]},e.id)),(0,n.jsx)(eW.mi,{}),(0,n.jsx)(eW.eb,{value:eF,children:"Create a new key"},eF)]})})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DestinationPanelFields.tsx"}),A&&I&&(0,n.jsx)("div",{className:"px-5",children:(0,n.jsx)(eZ.Z,{type:"warning",title:"Unable to find access key ID in project",children:(0,n.jsxs)("p",{className:"!leading-normal",children:["Please select another key or create a new set, as this destination will not work otherwise. S3 access keys can be managed in your"," ",(0,n.jsx)(eU.g,{href:"/project/".concat(f,"/storage/files/settings"),children:"storage settings"})]})})}),c===eF?(0,n.jsx)("div",{className:"px-5",children:(0,n.jsx)(eZ.Z,{type:"default",title:"A new set of S3 access keys will be created",children:(0,n.jsxs)("p",{className:"!leading-normal",children:["S3 access keys can be managed in your"," ",(0,n.jsx)(eU.g,{href:"/project/".concat(f,"/storage/files/settings"),children:"storage settings"}),"."]})})}):(0,n.jsx)(eS.zB,{control:r.control,name:"s3SecretAccessKey",render:e=>{var t;let{field:a}=e;return(0,n.jsxs)(eR.M,{layout:"vertical",label:"S3 Secret Access Key",className:"relative px-5",description:"The secret key corresponding to your selected access key ID",children:[(0,n.jsx)(eS.MJ,{children:(0,n.jsx)(K.p,{...a,type:x?"text":"password",value:null!=(t=a.value)?t:""})}),(0,n.jsx)(j.$,{type:"default",icon:x?(0,n.jsx)(eQ.A,{}):(0,n.jsx)(e$.A,{}),className:"w-7 absolute right-6 top-[33px]",onClick:()=>h(!x)})]})}})]})]})};var e3=a(26819);let e2=e=>{let{form:t,editMode:a}=e,r=(0,s._P)("etlEnableBigQuery"),i=(0,s._P)("etlEnableIceberg");return(0,n.jsxs)("div",{className:"px-5 py-5","data-sentry-component":"DestinationTypeSelection","data-sentry-source-file":"DestinationTypeSelection.tsx",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-foreground mb-1",children:"Destination type"}),a?(0,n.jsx)("p",{className:"text-sm text-foreground-light mb-4",children:"The destination type cannot be changed after creation"}):(0,n.jsx)("p",{className:"text-sm text-foreground-light mb-4",children:"Choose which platform to send your database changes to"}),(0,n.jsx)(eS.zB,{name:"type",control:t.control,render:e=>{let{field:t}=e;return(0,n.jsx)(eS.MJ,{children:(0,n.jsxs)(e3.s,{disabled:a,value:t.value,onValueChange:e=>t.onChange(e),children:[(!a&&r||a&&"BigQuery"===t.value)&&(0,n.jsx)(e3.v,{id:"BigQuery",value:"BigQuery",label:"BigQuery",className:"[&>div>div>p]:text-left",description:"Send data to Google Cloud's data warehouse for analytics and business intelligence"}),(!a&&i||a&&"Analytics Bucket"===t.value)&&(0,n.jsx)(e3.v,{value:"Analytics Bucket",id:"Analytics Bucket",label:"Analytics Bucket",className:"[&>div>div>p]:text-left",description:"Send data to Apache Iceberg tables in your Supabase Storage for flexible analytics workflows"})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DestinationTypeSelection.tsx"})]})};var e5=a(66959);let e4=()=>(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-full px-8 py-16 text-center","data-sentry-component":"NoDestinationsAvailable","data-sentry-source-file":"NoDestinationsAvailable.tsx",children:[(0,n.jsx)("div",{className:"flex items-center justify-center w-14 h-14 rounded-full bg-surface-300 mb-5",children:(0,n.jsx)(e5.A,{size:26,className:"text-foreground-light",strokeWidth:1.5,"data-sentry-element":"DatabaseZap","data-sentry-source-file":"NoDestinationsAvailable.tsx"})}),(0,n.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No destinations available"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light max-w-lg",children:"ETL replication destinations are not currently enabled for this project. Contact support to enable real-time replication to external platforms."})]});var e6=a(32157),e8=a(23892),e9=a(61548),e7=a(29244),te=a(97757);let tt=e=>{let{publications:t,isLoadingPublications:a,isLoadingCheck:s,onNewPublicationClick:r,field:i}=e,[o,c]=(0,p.useState)(!1),[d,u]=(0,p.useState)((null==i?void 0:i.value)||""),[m,x]=(0,p.useState)("");function h(e){u(e),c(!1),i.onChange(e)}return(0,p.useEffect)(()=>{u((null==i?void 0:i.value)||"")},[null==i?void 0:i.value]),(0,n.jsxs)(e9.AM,{modal:!1,open:o,onOpenChange:e=>{c(e),!e&&(null==i?void 0:i.onBlur)&&i.onBlur()},"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"PublicationsComboBox","data-sentry-source-file":"PublicationsComboBox.tsx",children:[(0,n.jsx)(e9.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"PublicationsComboBox.tsx",children:(0,n.jsx)(j.$,{type:"default",size:"medium",className:(0,z.cn)("w-full [&>span]:w-full text-left",!d&&"text-foreground-muted"),iconRight:s?(0,n.jsx)(ez.A,{className:"animate-spin",size:14}):(0,n.jsx)(e6.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),name:i.name,onBlur:i.onBlur,"data-sentry-element":"Button","data-sentry-source-file":"PublicationsComboBox.tsx",children:d||"Select publication"})}),(0,n.jsx)(e9.hl,{className:"p-0",sameWidthAsTrigger:!0,"data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"PublicationsComboBox.tsx",children:(0,n.jsxs)(e7.uB,{"data-sentry-element":"Command_Shadcn_","data-sentry-source-file":"PublicationsComboBox.tsx",children:[(0,n.jsx)(e7.G7,{placeholder:"Find publication...",value:m,onValueChange:x,"data-sentry-element":"CommandInput_Shadcn_","data-sentry-source-file":"PublicationsComboBox.tsx"}),(0,n.jsxs)(e7.oI,{"data-sentry-element":"CommandList_Shadcn_","data-sentry-source-file":"PublicationsComboBox.tsx",children:[(0,n.jsx)(e7.xL,{"data-sentry-element":"CommandEmpty_Shadcn_","data-sentry-source-file":"PublicationsComboBox.tsx",children:a?(0,n.jsxs)("div",{className:"flex items-center gap-2 text-center justify-center",children:[(0,n.jsx)(ez.A,{size:12,className:"animate-spin"}),"Loading..."]}):"No publications found"}),(0,n.jsxs)(e7.L$,{"data-sentry-element":"CommandGroup_Shadcn_","data-sentry-source-file":"PublicationsComboBox.tsx",children:[0===t.length&&(0,n.jsx)("p",{className:"text-foreground-lighter text-xs py-3 px-2",children:"No publications available"}),(0,n.jsx)(te.FK,{className:t.length>7?"h-[210px]":"","data-sentry-element":"ScrollArea","data-sentry-source-file":"PublicationsComboBox.tsx",children:t.map(e=>(0,n.jsxs)(e7.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{h(e)},onClick:()=>{h(e)},children:[(0,n.jsx)("span",{children:e}),d===e&&(0,n.jsx)(e8.A,{className:"text-brand",strokeWidth:2,size:13})]},e))})]}),(0,n.jsx)(e7.fx,{"data-sentry-element":"CommandSeparator_Shadcn_","data-sentry-source-file":"PublicationsComboBox.tsx"}),(0,n.jsx)(e7.L$,{"data-sentry-element":"CommandGroup_Shadcn_","data-sentry-source-file":"PublicationsComboBox.tsx",children:(0,n.jsxs)(e7.h_,{className:"cursor-pointer w-full",onSelect:r,onClick:r,"data-sentry-element":"CommandItem_Shadcn_","data-sentry-source-file":"PublicationsComboBox.tsx",children:[(0,n.jsx)(l.A,{size:14,strokeWidth:1.5,className:"mr-2","data-sentry-element":"Plus","data-sentry-source-file":"PublicationsComboBox.tsx"}),(0,n.jsx)("p",{children:"New publication"})]})})]})]})})]})},ta=e=>{var t,a;let{form:r,sourceId:i,visible:l,onSelectNewPublication:o}=e,{ref:c}=(0,s.g)(),{data:d}=(0,ev.YA)(),{publicationName:u}=r.watch(),{data:m=[],isLoading:x,isSuccess:h}=(0,ec.Z)({projectRef:c,sourceId:i}),f=(0,p.useMemo)(()=>{var e;return null!=(e=null==m?void 0:m.map(e=>e.name))?e:[]},[m]),y=m.find(e=>e.name===u),g=h&&!!u&&!f.includes(u),{data:j,isLoading:b}=en({projectRef:null==d?void 0:d.ref,connectionString:null==d?void 0:d.connectionString,tables:null!=(t=null==y?void 0:y.tables)?t:[]},{enabled:l&&!!y}),v=(null!=(a=null==j?void 0:j.offendingTables)?a:[]).length>0;return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(eS.zB,{control:r.control,name:"publicationName",render:e=>{var t;let{field:a}=e;return(0,n.jsxs)(eR.M,{label:"Publication",layout:"vertical",description:"Choose which tables to replicate to this destination",children:[(0,n.jsx)(eS.MJ,{children:(0,n.jsx)(tt,{publications:f,isLoadingPublications:x,isLoadingCheck:!!y&&b,field:a,onNewPublicationClick:()=>o()})}),g?(0,n.jsx)(eZ.Z,{type:"warning",className:"mt-2 mb-0",children:(0,n.jsxs)("p",{className:"!leading-normal",children:["The publication ",(0,n.jsx)("strong",{className:"text-foreground",children:u})," was not found, it may have been renamed or deleted, please select another one."]})}):v?(0,n.jsxs)(eZ.Z,{type:"warning",className:"mt-2 mb-0",children:[(0,n.jsx)("p",{className:"!leading-normal",children:"Replication requires every table in the publication to have a primary key to work, which these tables are missing:"}),(0,n.jsx)("ul",{className:"list-disc pl-6 mb-2",children:(null!=(t=null==j?void 0:j.offendingTables)?t:[]).map(e=>{let t="".concat(e.schema,".").concat(e.name);return(0,n.jsx)("li",{className:"!leading-normal",children:(0,n.jsx)(eU.g,{href:"/project/".concat(c,"/editor/").concat(e.id),children:t})},t)})}),(0,n.jsx)("p",{className:"!leading-normal",children:"Ensure that these tables have primary keys first."})]}):null]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"PublicationSelection.tsx"})})},tn="destination-editor",ts=e=>{var t,a,r;let{visible:i,sourceId:l,onClose:o,existingDestination:c}=e,{ref:d}=(0,s.g)(),{data:u}=(0,ev.YA)(),{setRequestStatus:m}=(0,eN.d0)(),x=(0,s._P)("etlEnableBigQuery"),h=(0,s._P)("etlEnableIceberg"),f=(0,p.useMemo)(()=>{let e=[];return x&&e.push({value:"BigQuery",label:"BigQuery"}),h&&e.push({value:"Analytics Bucket",label:"Analytics Bucket"}),e},[x,h]),y=0===f.length,g=!!c,[b,v]=(0,p.useState)(!1),[N,w]=(0,p.useState)(!1),[S,A]=(0,p.useState)(null),[_,C]=(0,p.useState)(!1),{mutateAsync:k,isPending:I}=(0,es.x)({onSuccess:()=>ei.reset(er)}),{mutateAsync:R,isPending:D}=ex({onSuccess:()=>ei.reset(er)}),{mutateAsync:E,isPending:P}=(0,eu.n)(),{restartPipeline:M}=(0,ed.p)(),{mutateAsync:B,isPending:T}=(0,eb.S)(),{mutateAsync:F,isPending:L}=ej(),{data:q=[],isSuccess:O,refetch:K}=(0,ec.Z)({projectRef:d,sourceId:l}),{data:z}=el({projectRef:d,destinationId:null==c?void 0:c.destinationId}),{data:Q}=(0,eo.u)({projectRef:d,pipelineId:null==c?void 0:c.pipelineId}),{canReadAPIKeys:U}=(0,J.u)(),{data:X}=(0,W.I)({projectRef:d,reveal:!0},{enabled:U}),{serviceKey:ee}=(0,W.x)(X),et=null!=(t=null==ee?void 0:ee.api_key)?t:"",{data:ea}=(0,Z.G)({projectRef:d}),er=(0,p.useMemo)(()=>{var e,t,a,n,s,r;let i=null==z?void 0:z.config,l=i&&"big_query"in i,o=i&&"iceberg"in i;return{type:g?l?eO.enum.BigQuery:eO.enum["Analytics Bucket"]:(null==(e=f[0])?void 0:e.value)||eO.enum.BigQuery,name:null!=(n=null==z?void 0:z.name)?n:"",publicationName:null!=(s=null==Q?void 0:Q.config.publication_name)?s:"",maxFillMs:null==Q||null==(a=Q.config)||null==(t=a.batch)?void 0:t.max_fill_ms,projectId:l?i.big_query.project_id:"",datasetId:l?i.big_query.dataset_id:"",serviceAccountKey:l?i.big_query.service_account_key:"",maxStalenessMins:l?i.big_query.max_staleness_mins:void 0,warehouseName:o?i.iceberg.supabase.warehouse_name:"",namespace:o?i.iceberg.supabase.namespace:"",newNamespaceName:"",catalogToken:o?i.iceberg.supabase.catalog_token:et,s3AccessKeyId:o?i.iceberg.supabase.s3_access_key_id:"",s3SecretAccessKey:o?i.iceberg.supabase.s3_secret_access_key:"",s3Region:null!=(r=null==ea?void 0:ea.region)?r:o?i.iceberg.supabase.s3_region:""}},[z,Q,et,ea,g,f]),ei=(0,V.mN)({mode:"onChange",reValidateMode:"onChange",resolver:(0,$.u)(eK),defaultValues:er}),{publicationName:em,type:ep,warehouseName:eh}=ei.watch(),ef=I||D||P||T||L,ey=(0,p.useMemo)(()=>{var e;return null!=(e=null==q?void 0:q.map(e=>e.name))?e:[]},[q]),eg=O&&!!em&&!ey.includes(em),e_=q.find(e=>e.name===em),{data:eC,isLoading:ek}=en({projectRef:null==u?void 0:u.ref,connectionString:null==u?void 0:u.connectionString,tables:null!=(a=null==e_?void 0:e_.tables)?a:[]},{enabled:i&&!!e_}),eI=(null!=(r=null==eC?void 0:eC.offendingTables)?r:[]).length>0,eR=ef||eg||!!e_&&ek||eI||!g&&y,eD=async e=>{if(e.namespace===eL){var t,a,n,s,r;if(!e.newNamespaceName)throw Error("New namespace name is required");let i=null!=(s=null==ea||null==(t=ea.app_config)?void 0:t.protocol)?s:"https",l=(null==ea||null==(a=ea.app_config)?void 0:a.storage_endpoint)||(null==ea||null==(n=ea.app_config)?void 0:n.endpoint),o=(0,H.Uj)(null!=(r=null==u?void 0:u.ref)?r:"",i,l);return await F({projectRef:d,catalogUri:o,warehouse:e.warehouseName,namespace:e.newNamespaceName}),e.newNamespaceName}return e.namespace},eM=async e=>{if(!d)return console.error("Project ref is required");if(!l)return console.error("Source id is required");if(eg)return Y.oR.error("Please select another publication before continuing");try{if(g&&c){var t;if(!c.pipelineId)return console.error("Pipeline id is required");let a={};if("BigQuery"===e.type){let t={projectId:e.projectId,datasetId:e.datasetId,serviceAccountKey:e.serviceAccountKey};e.maxStalenessMins&&(t.maxStalenessMins=e.maxStalenessMins),a={bigQuery:t}}else if("Analytics Bucket"===e.type){let t={accessKey:e.s3AccessKeyId,secretKey:e.s3SecretAccessKey};if(e.s3AccessKeyId===eF){let e=await B({projectRef:d,description:"Autogenerated key for replication to ".concat(G()(eh))});t={accessKey:e.access_key,secretKey:e.secret_key}}let n=await eD(e);a={iceberg:{projectRef:d,warehouseName:e.warehouseName,namespace:n,catalogToken:e.catalogToken,s3AccessKeyId:t.accessKey,s3SecretAccessKey:t.secretKey,s3Region:e.s3Region}}}let n={};e.maxFillMs&&(n.maxFillMs=e.maxFillMs);let s=Object.keys(n).length>0;await R({destinationId:c.destinationId,pipelineId:c.pipelineId,projectRef:d,destinationName:e.name,destinationConfig:a,pipelineConfig:{publicationName:e.publicationName,...s?{batch:n}:{}},sourceId:l});let r=null!=(t=c.statusName)?t:c.enabled?"started":"stopped";c.enabled?(m(c.pipelineId,eN.Mf.RestartRequested,r),Y.oR.success("Settings applied. Restarting the pipeline..."),M({projectRef:d,pipelineId:c.pipelineId})):(m(c.pipelineId,eN.Mf.StartRequested,r),Y.oR.success("Settings applied. Starting the pipeline..."),E({projectRef:d,pipelineId:c.pipelineId})),o()}else{let t={};if("BigQuery"===e.type){let a={projectId:e.projectId,datasetId:e.datasetId,serviceAccountKey:e.serviceAccountKey};e.maxStalenessMins&&(a.maxStalenessMins=e.maxStalenessMins),t={bigQuery:a}}else if("Analytics Bucket"===e.type){let a={accessKey:e.s3AccessKeyId,secretKey:e.s3SecretAccessKey};if(e.s3AccessKeyId===eF){let e=await B({projectRef:d,description:"Autogenerated key for replication to ".concat(G()(eh))});a={accessKey:e.access_key,secretKey:e.secret_key}}let n=await eD(e);t={iceberg:{projectRef:d,warehouseName:e.warehouseName,namespace:n,catalogToken:e.catalogToken,s3AccessKeyId:a.accessKey,s3SecretAccessKey:a.secretKey,s3Region:e.s3Region}}}let a={};e.maxFillMs&&(a.maxFillMs=e.maxFillMs);let n=Object.keys(a).length>0,{pipeline_id:s}=await k({projectRef:d,destinationName:e.name,destinationConfig:t,sourceId:l,pipelineConfig:{publicationName:e.publicationName,...n?{batch:a}:{}}});m(s,eN.Mf.StartRequested,void 0),Y.oR.success("Destination created. Starting the pipeline..."),E({projectRef:d,pipelineId:s}),o()}}catch(t){let e=g?"apply and run":"create and start";Y.oR.error("Failed to ".concat(e," destination"))}},eq=async e=>{if(!g){A(e),v(!0);return}await eM(e)},ez=async()=>{S&&(A(null),v(!1),await eM(S))};return(0,p.useEffect)(()=>{g&&z&&Q&&!_&&ei.reset(er)},[z,Q,g,er,ei,_]),(0,p.useEffect)(()=>{i&&(ei.reset(er),C(!1))},[i,er,ei]),(0,p.useEffect)(()=>{i&&d&&l&&K()},[i,d,l,K]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ew.cj,{open:i,onOpenChange:o,"data-sentry-element":"Sheet","data-sentry-source-file":"DestinationPanel.tsx",children:(0,n.jsx)(ew.h,{showClose:!1,size:"default",className:N?"right-32":"right-0","data-sentry-element":"SheetContent","data-sentry-source-file":"DestinationPanel.tsx",children:(0,n.jsxs)("div",{className:"flex flex-col h-full",tabIndex:-1,children:[(0,n.jsxs)(ew.Fm,{"data-sentry-element":"SheetHeader","data-sentry-source-file":"DestinationPanel.tsx",children:[(0,n.jsx)(ew.qp,{"data-sentry-element":"SheetTitle","data-sentry-source-file":"DestinationPanel.tsx",children:g?"Edit destination":"Create a new destination"}),(0,n.jsx)(ew.Qs,{"data-sentry-element":"SheetDescription","data-sentry-source-file":"DestinationPanel.tsx",children:g?"Update the configuration for this destination":"A destination is an external platform that automatically receives your database changes in real time."})]}),(0,n.jsx)(ew.Xc,{className:"flex-grow overflow-auto px-0 py-0","data-sentry-element":"SheetSection","data-sentry-source-file":"DestinationPanel.tsx",children:y&&!g?(0,n.jsx)(e4,{}):(0,n.jsx)(eS.lV,{...ei,children:(0,n.jsxs)("form",{id:tn,onSubmit:ei.handleSubmit(eq),children:[(0,n.jsxs)("div",{className:"p-5",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-foreground mb-1",children:"Destination details"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light mb-4",children:"Name your destination and choose which data to replicate"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)(eT,{form:ei}),(0,n.jsx)(ta,{form:ei,sourceId:l,visible:i,onSelectNewPublication:()=>w(!0)})]})]}),(0,n.jsx)(eA.pf,{}),(0,n.jsx)(e2,{form:ei,editMode:g}),"BigQuery"===ep&&x?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eA.pf,{}),(0,n.jsx)(e0,{form:ei})]}):"Analytics Bucket"===ep&&h?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eA.pf,{}),(0,n.jsx)(e1,{form:ei,setIsFormInteracting:C})]}):null,(0,n.jsx)(eA.pf,{}),(0,n.jsx)(eB,{form:ei})]})})}),(0,n.jsxs)(ew.XW,{"data-sentry-element":"SheetFooter","data-sentry-source-file":"DestinationPanel.tsx",children:[(0,n.jsx)(j.$,{disabled:ef,type:"default",onClick:o,"data-sentry-element":"Button","data-sentry-source-file":"DestinationPanel.tsx",children:"Cancel"}),(0,n.jsx)(j.$,{disabled:eR,loading:ef,form:tn,htmlType:"submit","data-sentry-element":"Button","data-sentry-source-file":"DestinationPanel.tsx",children:g?(null==c?void 0:c.enabled)?"Apply and restart":"Apply and start":"Create and start"})]})]})})}),(0,n.jsx)(eE,{sourceId:l,visible:N,onClose:()=>w(!1),"data-sentry-element":"NewPublicationPanel","data-sentry-source-file":"DestinationPanel.tsx"}),(0,n.jsx)(eP,{open:b,onOpenChange:e=>{v(e),e||A(null)},isLoading:ef,onConfirm:ez,"data-sentry-element":"ReplicationDisclaimerDialog","data-sentry-source-file":"DestinationPanel.tsx"})]})};var tr=a(12123),ti=a(58801),tl=a(18907),to=a(33106),tc=a(38483),td=a(30404),tu=a(94335);let tm=e=>{let{visible:t,isLoading:a,name:s,setVisible:r,onDelete:i}=e;return(0,n.jsx)(tu.A,{variant:"destructive",visible:t,loading:a,title:"Delete this destination",confirmLabel:a?"Deleting...":"Delete destination",confirmPlaceholder:"Type in name of destination",confirmString:null!=s?s:"Unknown",text:'This will delete the destination "'.concat(s,'"'),alert:{title:"You cannot recover this destination once deleted."},onCancel:()=>r(!t),onConfirm:i,"data-sentry-element":"TextConfirmModal","data-sentry-component":"DeleteDestination","data-sentry-source-file":"DeleteDestination.tsx"})};var tp=a(48940),tx=a(72276),th=a(5282),tf=a(77444),ty=a(71278),tg=a(84718),tj=a(49697),tb=a(14310),tv=a(3225),tN=a(33922),tw=a(21162);let tS=e=>{let{pipeline:t,pipelineStatus:a,error:r,isLoading:i,isError:l,onEditClick:o,onDeleteClick:c,hasUpdate:d=!1,onUpdateClick:u}=e,{ref:m}=(0,s.g)(),p=(0,tp.Ob)(a),{mutateAsync:x}=(0,eu.n)(),{mutateAsync:h}=(0,tc.J)(),{restartPipeline:f}=(0,ed.p)(),{getRequestStatus:y,setRequestStatus:g}=(0,eN.d0)(),b=((null==t?void 0:t.id)?y(t.id):eN.Mf.None)===eN.Mf.None&&p!==th.G.STARTING&&[th.G.STOPPED,th.G.STARTED,th.G.FAILED].includes(p),v=b&&(p===th.G.STARTED||p===th.G.FAILED),N=b&&p===th.G.STOPPED,w=async()=>{if(!m)return console.error("Project ref is required");if(!t)return Y.oR.error(tp.n.NO_PIPELINE_FOUND);try{tp.xc.includes(p)&&g(t.id,eN.Mf.StartRequested,p),await x({projectRef:m,pipelineId:t.id})}catch(e){g(t.id,eN.Mf.None),Y.oR.error(tp.n.ENABLE_DESTINATION)}},S=async()=>{if(!m)return console.error("Project ref is required");if(!t)return Y.oR.error(tp.n.NO_PIPELINE_FOUND);try{tp.C4.includes(p)&&g(t.id,eN.Mf.StopRequested,p),await h({projectRef:m,pipelineId:t.id})}catch(e){g(t.id,eN.Mf.None),Y.oR.error(tp.n.DISABLE_DESTINATION)}},A=async()=>{if(!m)return console.error("Project ref is required");if(!t)return Y.oR.error(tp.n.NO_PIPELINE_FOUND);try{g(t.id,eN.Mf.RestartRequested,p),await f({projectRef:m,pipelineId:t.id})}catch(e){g(t.id,eN.Mf.None),Y.oR.error(tp.n.ENABLE_DESTINATION)}};return(0,n.jsxs)("div",{className:"flex justify-end items-center space-x-2","data-sentry-component":"RowMenu","data-sentry-source-file":"RowMenu.tsx",children:[i&&(0,n.jsx)(Q.Ay,{}),l&&(0,n.jsx)(E.A,{error:r,subject:tp.n.RETRIEVE_PIPELINE_STATUS}),(0,n.jsxs)(tw.rI,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"RowMenu.tsx",children:[(0,n.jsx)(tw.ty,{asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"RowMenu.tsx",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(j.$,{type:"default",className:"px-1.5",icon:(0,n.jsx)(tf.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"RowMenu.tsx"}),d&&(0,n.jsx)("span",{className:"absolute -top-0.5 -right-0.5 h-2 w-2 bg-brand rounded-full"})]})}),(0,n.jsxs)(tw.SQ,{side:"bottom",align:"end",className:"w-52","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"RowMenu.tsx",children:[d&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(tw._2,{className:"space-x-2",onClick:()=>null==u?void 0:u(),children:[(0,n.jsx)(ty.A,{size:14}),(0,n.jsx)("p",{children:"Update available"})]}),(0,n.jsx)(tw.mB,{})]}),N&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(tw._2,{className:"space-x-2",onClick:w,children:[(0,n.jsx)(tg.A,{size:14}),(0,n.jsx)("p",{children:"Start pipeline"})]}),(0,n.jsx)(tw.mB,{})]}),v&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(tw._2,{className:"space-x-2",onClick:A,children:[(0,n.jsx)(tj.A,{size:14}),(0,n.jsx)("p",{children:"Restart pipeline"})]}),(0,n.jsxs)(tw._2,{className:"space-x-2",onClick:S,children:[(0,n.jsx)(tb.A,{size:14}),(0,n.jsx)("p",{children:"Stop pipeline"})]}),(0,n.jsx)(tw.mB,{})]}),(0,n.jsxs)(tw._2,{className:"space-x-2",onClick:o,"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"RowMenu.tsx",children:[(0,n.jsx)(tv.A,{size:14,"data-sentry-element":"Edit","data-sentry-source-file":"RowMenu.tsx"}),(0,n.jsx)("p",{children:"Edit destination"})]}),(0,n.jsxs)(tw._2,{className:"space-x-2",onClick:c,"data-sentry-element":"DropdownMenuItem","data-sentry-source-file":"RowMenu.tsx",children:[(0,n.jsx)(tN.A,{stroke:"red",size:14,"data-sentry-element":"Trash","data-sentry-source-file":"RowMenu.tsx"}),(0,n.jsx)("p",{children:"Delete destination"})]})]})]})]})};var tA=a(68132);let t_=e=>{var t;let{sourceId:a,destinationId:r,destinationName:i,type:l,pipeline:o,error:c,isLoading:d,isError:u,isSuccess:x}=e,{ref:h}=(0,s.g)(),[f,y]=(0,p.useState)(!1),[g,b]=(0,p.useState)(!1),[v,N]=(0,p.useState)(!1),[w,S]=(0,p.useState)(!1),{data:A,error:_,isLoading:C,isError:k,isSuccess:I}=(0,to.C)({projectRef:h,pipelineId:null==o?void 0:o.id},{refetchInterval:th.B}),{getRequestStatus:R,updatePipelineStatus:P,setRequestStatus:M}=(0,eN.d0)(),B=(null==o?void 0:o.id)?R(o.id):eN.Mf.None,{mutateAsync:T}=(0,tc.J)(),{mutateAsync:L}=(0,ti.e)({}),q=null==A?void 0:A.status,O=(0,tp.Ob)(q),{data:K}=(0,tl.K)({projectRef:h,pipelineId:null==o?void 0:o.id},{refetchInterval:th.B}),z=(null!=(t=null==K?void 0:K.table_statuses)?t:[]).filter(e=>{var t;return(null==(t=e.state)?void 0:t.name)==="error"}).length,$=O===th.G.STOPPED,U=B===eN.Mf.RestartRequested,{data:G}=(0,F.a)({projectRef:h,pipelineId:null==o?void 0:o.id}),V=!!(null==G?void 0:G.new_version),J=async()=>{if(!h)return console.error("Project ref is required");if(!o)return Y.oR.error(tp.n.NO_PIPELINE_FOUND);try{b(!0),await T({projectRef:h,pipelineId:o.id}),await L({projectRef:h,destinationId:r,pipelineId:o.id}),y(!1),Y.oR.success('Deleted destination "'.concat(i,'"'))}catch(e){Y.oR.error(tp.n.DELETE_DESTINATION)}finally{b(!1)}};return(0,p.useEffect)(()=>{(null==o?void 0:o.id)&&P(o.id,O)},[null==o?void 0:o.id,O,P]),(0,n.jsxs)(n.Fragment,{children:[u&&(0,n.jsx)(E.A,{error:c,subject:tp.n.RETRIEVE_PIPELINE}),x&&(0,n.jsxs)(D.A.tr,{children:[(0,n.jsx)(D.A.td,{children:d?(0,n.jsx)(Q.Ay,{}):(null==o?void 0:o.id)?(0,n.jsxs)(td.m_,{children:[(0,n.jsx)(td.k$,{children:(0,n.jsx)("span",{className:"cursor-default",children:i})}),(0,n.jsxs)(td.ZI,{side:"bottom",children:["Pipeline ID: ",o.id]})]}):i}),(0,n.jsx)(D.A.td,{children:d?(0,n.jsx)(Q.Ay,{}):l}),(0,n.jsx)(D.A.td,{children:d||!o?(0,n.jsx)(Q.Ay,{}):(0,n.jsx)(tx.z,{pipelineStatus:null==A?void 0:A.status,error:_,isLoading:C,isError:k,isSuccess:I,requestStatus:B,pipelineId:null==o?void 0:o.id})}),(0,n.jsx)(D.A.td,{children:d||!o?(0,n.jsx)(Q.Ay,{}):o.config.publication_name}),(0,n.jsx)(D.A.td,{children:(0,n.jsxs)("div",{className:"flex items-center justify-end gap-x-2",children:[(0,n.jsx)(j.$,{asChild:!0,type:"default",className:"relative",children:(0,n.jsx)(m(),{href:"/project/".concat(h,"/database/etl/").concat(null==o?void 0:o.id),children:(0,n.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,n.jsx)("span",{children:"View status"}),z>0&&!$&&!U&&(0,n.jsxs)(td.m_,{children:[(0,n.jsx)(td.k$,{children:(0,n.jsx)(tr.A,{size:14})}),(0,n.jsxs)(td.ZI,{side:"bottom",children:[z," table",1===z?"":"s"," encountered replication errors"]})]})]})})}),(0,n.jsx)(tS,{pipeline:o,pipelineStatus:null==A?void 0:A.status,error:_,isLoading:C,isError:k,onDeleteClick:()=>y(!0),onEditClick:()=>N(!0),hasUpdate:V,onUpdateClick:()=>S(!0)})]})})]}),(0,n.jsx)(tm,{visible:f,setVisible:y,onDelete:J,isLoading:g,name:i,"data-sentry-element":"DeleteDestination","data-sentry-source-file":"DestinationRow.tsx"}),(0,n.jsx)(ts,{visible:v,onClose:()=>N(!1),sourceId:a,existingDestination:{sourceId:a,destinationId:r,pipelineId:null==o?void 0:o.id,enabled:O===th.G.STARTED||O===th.G.FAILED,statusName:O},"data-sentry-element":"DestinationPanel","data-sentry-source-file":"DestinationRow.tsx"}),(0,n.jsx)(tA.v,{visible:w,pipeline:o,onClose:()=>S(!1),confirmLabel:O===th.G.STARTED||O===th.G.FAILED?"Update and restart":"Update version","data-sentry-element":"UpdateVersionModal","data-sentry-source-file":"DestinationRow.tsx"})]})};var tC=a(63417);let tk=()=>{let{ref:e}=(0,s.g)(),[t,a]=(0,p.useState)(!1),{mutate:r,isPending:i}=(0,tC.y)({onSuccess:()=>{Y.oR.success("ETL replication has been successfully enabled!"),a(!1)},onError:e=>{Y.oR.error("Failed to enable ETL replication: ".concat(e.message))}}),l=async()=>{if(!e)return console.error("Project ref is required");r({projectRef:e})};return(0,n.jsxs)(eA.lG,{open:t,onOpenChange:a,"data-sentry-element":"Dialog","data-sentry-component":"EnableReplicationModal","data-sentry-source-file":"EnableReplicationModal.tsx",children:[(0,n.jsx)(eA.zM,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"EnableReplicationModal.tsx",children:(0,n.jsx)(j.$,{type:"primary",className:"w-min","data-sentry-element":"Button","data-sentry-source-file":"EnableReplicationModal.tsx",children:"Enable ETL replication"})}),(0,n.jsxs)(eA.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"EnableReplicationModal.tsx",children:[(0,n.jsx)(eA.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"EnableReplicationModal.tsx",children:(0,n.jsx)(eA.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"EnableReplicationModal.tsx",children:"Enable ETL Replication"})}),(0,n.jsx)(eA.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"EnableReplicationModal.tsx"}),(0,n.jsx)(eA.OO,{className:"flex flex-col gap-y-2 !p-0","data-sentry-element":"DialogSection","data-sentry-source-file":"EnableReplicationModal.tsx",children:(0,n.jsxs)(eZ.Z,{type:"warning",className:"rounded-none border-0 mb-0",title:"ETL Replication is currently in Alpha","data-sentry-element":"Admonition","data-sentry-source-file":"EnableReplicationModal.tsx",children:[(0,n.jsx)("p",{className:"text-sm !leading-normal",children:"This feature is in active development and may change as we gather feedback. Availability and behavior can evolve while in Alpha."}),(0,n.jsx)("p",{className:"text-sm !leading-normal",children:"Pricing has not been finalized yet. You can enable ETL replication now; we'll announce pricing later and notify you before any charges apply."})]})}),(0,n.jsxs)(eA.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"EnableReplicationModal.tsx",children:[(0,n.jsx)(j.$,{type:"default",disabled:i,onClick:()=>a(!1),"data-sentry-element":"Button","data-sentry-source-file":"EnableReplicationModal.tsx",children:"Cancel"}),(0,n.jsx)(j.$,{type:"primary",loading:i,onClick:l,"data-sentry-element":"Button","data-sentry-source-file":"EnableReplicationModal.tsx",children:"Enable ETL replication"})]})]})]})},tI=()=>{var e,t,a;let{data:r}=(0,O.s)(),i=(null==r?void 0:r.plan.id)!=="free",[o,c]=(0,p.useState)(!1),[d,u]=(0,p.useState)(""),{ref:m}=(0,s.g)(),{data:x,error:h,isLoading:y,isError:g,isSuccess:b}=(0,q.Y)({projectRef:m}),v=null==x||null==(e=x.sources.find(e=>e.name===m))?void 0:e.id,N=b&&!v,{data:w,error:S,isLoading:A,isError:_,isSuccess:C}=(0,B.V)({projectRef:m}),{data:k,error:$,isLoading:U,isError:G,isSuccess:V}=(0,L.b)({projectRef:m}),Y=C&&w.destinations.length>0,J=0===d.length?null!=(t=null==w?void 0:w.destinations)?t:[]:(null!=(a=null==w?void 0:w.destinations)?a:[]).filter(e=>e.name.toLowerCase().includes(d.toLowerCase())),H=(0,I.jE)(),W=(0,p.useRef)(!1);return(0,p.useEffect)(()=>{m&&!W.current&&(null==k?void 0:k.pipelines)&&k.pipelines.length>0&&V&&(W.current=!0,k.pipelines.forEach(e=>{(null==e?void 0:e.id)&&H.prefetchQuery({queryKey:T.l.pipelinesVersion(m,e.id),queryFn:t=>{let{signal:a}=t;return(0,F.t)({projectRef:m,pipelineId:e.id},a)},staleTime:1/0})}))},[m,null==k?void 0:k.pipelines,V,H]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)(R.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-foreground-lighter",size:14,"data-sentry-element":"Search","data-sentry-source-file":"Destinations.tsx"}),(0,n.jsx)(K.p,{className:"pl-9 h-7",placeholder:"Filter destinations",value:d,onChange:e=>u(e.target.value),"data-sentry-element":"Input_Shadcn_","data-sentry-source-file":"Destinations.tsx"})]})}),(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[!!v&&(0,n.jsx)(j.$,{type:"default",icon:(0,n.jsx)(l.A,{}),onClick:()=>c(!0),children:"Add destination"}),(0,n.jsx)(P.A,{href:"https://supabase.com/docs/guides/database/replication","data-sentry-element":"DocsButton","data-sentry-source-file":"Destinations.tsx"})]})]})}),(0,n.jsxs)("div",{className:"w-full overflow-hidden overflow-x-auto",children:[(g||_)&&(0,n.jsx)(E.P,{error:h||S,subject:tp.n.RETRIEVE_DESTINATIONS}),y||A?(0,n.jsx)(Q.yV,{}):N?(0,n.jsxs)("div",{className:"border rounded-md p-4 md:p-12 flex flex-col gap-y-4",children:[(0,n.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,n.jsx)("h3",{children:"Replicate data to external destinations in real-time"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:[i?"Enable ETL replication":"Upgrade to the Pro plan"," to start replicating your database changes to data warehouses and analytics platforms"]})]}),(0,n.jsxs)("div",{className:"flex gap-x-2",children:[i?(0,n.jsx)(tk,{}):(0,n.jsx)(M.I,{type:"primary",plan:"Pro"}),(0,n.jsx)(P.A,{href:"".concat(f.aq)})]})]}):Y?(0,n.jsx)(D.A,{head:[(0,n.jsx)(D.A.th,{children:"Name"},"name"),(0,n.jsx)(D.A.th,{children:"Type"},"type"),(0,n.jsx)(D.A.th,{children:"Status"},"status"),(0,n.jsx)(D.A.th,{children:"Publication"},"publication"),(0,n.jsx)(D.A.th,{},"actions")],body:J.map(e=>{let t=null==k?void 0:k.pipelines.find(t=>t.destination_id===e.id),a="big_query"in e.config?"BigQuery":"iceberg"in e.config?"Analytics Bucket":"Other";return(0,n.jsx)(t_,{sourceId:v,destinationId:e.id,destinationName:e.name,type:a,pipeline:t,error:$,isLoading:U,isError:G,isSuccess:V},e.id)})}):!y&&!A&&!g&&!_&&(0,n.jsxs)("div",{className:(0,z.cn)("w-full","border border-dashed bg-surface-100 border-overlay","flex flex-col px-10 rounded-lg justify-center items-center py-8 mt-4"),children:[(0,n.jsx)("h4",{children:"Create your first destination"}),(0,n.jsx)("p",{className:"prose text-sm text-center mt-1 max-w-[70ch]",children:"Destinations are external platforms where your database changes are automatically sent. Connect to various data warehouses and analytics platforms to enable real-time data pipelines."}),(0,n.jsx)(j.$,{icon:(0,n.jsx)(l.A,{}),onClick:()=>c(!0),className:"mt-4",children:"Add destination"})]})]}),!y&&!A&&0===J.length&&Y&&(0,n.jsx)("div",{className:"text-center py-8 text-foreground-light",children:(0,n.jsxs)("p",{children:['No destinations match "',d,'"']})}),(0,n.jsx)(ts,{visible:o,sourceId:v,onClose:()=>c(!1),"data-sentry-element":"DestinationPanel","data-sentry-source-file":"Destinations.tsx"})]})};var tR=a(2838),tD=a(68296),tE=a(10508),tP=a(37873),tM=a(91205),tB=a(42459),tT=a(2657);let tF=()=>{let{ref:e}=(0,s.g)(),t=(0,tR.g)();return(0,tT.x)("database:replication")?(0,n.jsx)(n.Fragment,{children:t?(0,n.jsx)(eN.zy,{children:(0,n.jsx)(tP.eh,{children:(0,n.jsx)(tP.gu,{children:(0,n.jsxs)("div",{className:"col-span-12",children:[(0,n.jsx)(tM.M,{className:"[&>div>p]:max-w-full",title:"ETL Replication",description:"Automatically replicate your database changes to external data warehouses and analytics platforms in real-time"}),(0,n.jsx)(tI,{})]})})})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tP.eh,{children:(0,n.jsx)(tP.gu,{children:(0,n.jsx)("div",{className:"col-span-12",children:(0,n.jsx)(tM.M,{title:"ETL Replication",description:"Send data to other destinations"})})})}),(0,n.jsx)(w,{projectRef:e||"_"})]})}):(0,n.jsx)(tB.c,{urlBack:"/project/".concat(e,"/database/schemas")})};tF.getLayout=e=>(0,n.jsx)(tE.A,{children:(0,n.jsx)(tD.A,{title:"Database ETL Replication",children:e})});let tL=tF},67006:(e,t,a)=>{"use strict";a.d(t,{h:()=>d,n:()=>o});var n=a(53239),s=a(61262);let r=e=>{let t,a=new Set,n=(e,n)=>{let s="function"==typeof e?e(t):e;if(!Object.is(s,t)){let e=t;t=(null!=n?n:"object"!=typeof s||null===s)?s:Object.assign({},t,s),a.forEach(a=>a(t,e))}},s=()=>t,r={setState:n,getState:s,subscribe:e=>(a.add(e),()=>a.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),a.clear()}};return t=e(n,s,r),r},{useDebugValue:i}=n,{useSyncExternalStoreWithSelector:l}=s;function o(e,t=e.getState,a){let n=l(e.subscribe,e.getState,e.getServerState||e.getState,t,a);return i(n),n}let c=(e,t)=>{let a=(e=>e?r(e):r)(e),n=(e,n=t)=>o(a,e,n);return Object.assign(n,a),n},d=(e,t)=>e?c(e,t):c},67057:(e,t,a)=>{"use strict";a.d(t,{A:()=>function e(t){if("string"==typeof t||"number"==typeof t)return""+t;let a="";if(Array.isArray(t))for(let n=0,s;n<t.length;n++)""!==(s=e(t[n]))&&(a+=(a&&" ")+s);else for(let e in t)t[e]&&(a+=(a&&" ")+e);return a}})},71278:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});let n=(0,a(86848).A)("CircleArrowUp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]])},78960:(e,t,a)=>{"use strict";a.d(t,{Dc:()=>u,Ij:()=>c,mM:()=>d});var n=a(67850),s=a(22891),r=a(24523),i=a(85039),l=a(30659);async function o(e,t){let{projectRef:a}=e;if(!a)throw Error("projectRef is required");let{data:n,error:s}=await (0,r.Jt)("/platform/projects/{ref}/config/storage",{params:{path:{ref:a}},signal:t});return s&&(404===s.code?(0,r.H4)({...s,message:"Storage configuration not found."}):(0,r.H4)(s)),n}let c=function(e){let{projectRef:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.I)({queryKey:l.n.storage(t),queryFn:e=>{let{signal:a}=e;return o({projectRef:t},a)},enabled:a&&i.pe&&void 0!==t,...s})},d=e=>{var t;let{projectRef:a}=e,{data:n}=c({projectRef:a});return!!(null==n||null==(t=n.features.icebergCatalog)?void 0:t.enabled)},u=e=>{let{projectRef:t}=e;return(0,s._P)("storageAnalyticsVector")}}},e=>{e.O(0,[5233,60858,15599,16110,27764,36538,44033,94942,33736,76984,72391,35035,40545,596,10508,48340,75187,29471,70087,9505,90636,46593,38792],()=>e(e.s=54916)),_N_E=e.O()}]);