try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2bee92db-523b-47ef-b8f4-8ae1a0a63803",e._sentryDebugIdIdentifier="sentry-dbid-2bee92db-523b-47ef-b8f4-8ae1a0a63803")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[21753],{1374:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]])},2353:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var s=n(80263),a=n(53239),r=n(23157),i=n(7981),l=n(7760);let o=(0,a.createContext)({parentCallback:e=>{},type:"",name:"",activeId:"",parentSize:""});function c(e){var t;let{id:n=(t=46656*Math.random()|0,("00000"+(46656*Math.random()|0).toString(36)).slice(-3)+("00000"+t.toString(36)).slice(-3)),disabled:a,value:r,label:c,afterLabel:d,beforeLabel:u,description:m,name:x,checked:h,className:p,onChange:f,onBlur:y,hidden:g=!1,size:j="medium",align:v="vertical",optionalLabel:b,addOnBefore:N,children:S}=e,w=(0,i.A)("radio"),{handleBlur:A}=(0,l.x)();function C(e){A&&A(e),y&&y(e)}return(0,s.jsx)(o.Consumer,{"data-sentry-element":"RadioContext.Consumer","data-sentry-component":"Radio","data-sentry-source-file":"Radio.tsx",children:e=>{let{parentCallback:t,type:i,name:l,activeId:o,parentSize:y}=e;j=y||j;let A=o===n||!!h||!1!==h&&void 0,_=[p,w.variants[i].container.base,"list"===i&&!g&&w.variants[i].container.size[j]];return _.push(w.variants[i].base),_.push(w.variants[i].size[j]),A?_.push(w.variants[i].active):_.push(w.variants[i].inactive),a&&_.push(w.disabled),"list"!==i&&(g=!0),(0,s.jsxs)("label",{htmlFor:n,className:_.join(" "),children:[(0,s.jsx)("input",{id:n,name:l||x,type:"radio",className:[w.base,w.size[j],g&&w.hidden,w.variants[i].radio_offset,""].join(" "),checked:A,disabled:a,value:r||n,onChange:e=>{t&&t(e),f&&f(e)},onBlur:C}),N,S||(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:[w.label.base,w.label[j],w.variants[i].container.align[v]].join(" "),children:[u&&(0,s.jsx)("div",{className:[w.label_before.base,w.label_before[j]].join(" "),children:u}),(0,s.jsx)("div",{children:c}),d&&(0,s.jsx)("div",{className:[w.label_after.base,w.label_after[j]].join(" "),children:d}),m&&(0,s.jsx)("div",{className:[w.description.base,w.description[j]].join(" "),children:m})]}),b&&(0,s.jsx)("div",{className:[w.optionalLabel.base,w.optionalLabel[j]].join(" "),children:b})]})]})}})}c.Group=function(e){let{id:t,layout:n,error:d,descriptionText:u,label:m,afterLabel:x,beforeLabel:h,labelOptional:p,children:f,className:y,type:g="list",options:j,value:v,name:b,onChange:N,size:S="medium",validation:w,groupClassName:A,labelsLayout:C="vertical"}=e,[_,k]=(0,a.useState)(""),E=(0,i.A)("radio"),{formContextOnChange:F,values:T,errors:z,touched:R,fieldLevelValidation:I}=(0,l.x)();return T&&!v&&(v=T[t||b]),d||(z&&!d&&(d=z[t||b]),d=R&&R[t||b]?d:void 0),(0,a.useEffect)(()=>{w&&I(t,w(v))},[]),(0,a.useEffect)(()=>{k(v)},[v]),(0,s.jsx)("fieldset",{name:b,className:y,"data-sentry-component":"RadioGroup","data-sentry-source-file":"Radio.tsx",children:(0,s.jsx)(r.H,{nonBoxInput:!0,label:m,afterLabel:x,beforeLabel:h,labelOptional:p,layout:n,id:t,error:d,descriptionText:u,size:S,labelLayout:C,"data-sentry-element":"FormLayout","data-sentry-source-file":"Radio.tsx",children:(0,s.jsx)("div",{className:A||E.variants[g].group,children:(0,s.jsx)(o.Provider,{value:{parentCallback:function(e){N&&N(e),F&&F(e),w&&I(t,w(e.target.value)),k(e.target.id)},type:g,name:b,activeId:_,parentSize:S},"data-sentry-element":"RadioContext.Provider","data-sentry-source-file":"Radio.tsx",children:j?j.map(e=>(0,s.jsx)(c,{id:e.id,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,value:e.value,description:e.description})):f})})})})};let d=c},9012:(e,t,n)=>{var s=n(3733),a=n(40293),r=n(2482),i=n(33312);e.exports=function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],l=e;l--;)t[l-1]=arguments[l];return s(i(n)?r(n):[n],a(t,1))}},13655:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]])},14354:(e,t,n)=>{"use strict";n.d(t,{KP:()=>d,Nu:()=>c,d8:()=>l,l3:()=>o});var s=n(80263),a=n(79279);n(53239);var r=n(80100);let i=(0,a.F)(["pt-12 last:pb-12 gap-6"],{variants:{orientation:{horizontal:"grid @3xl:grid-cols-[1fr_2fr] @3xl:gap-12",vertical:"flex flex-col"}},defaultVariants:{orientation:"vertical"}}),l=e=>{let{className:t,orientation:n="vertical",children:a,...l}=e;return(0,s.jsx)("div",{"data-slot":"page-section","data-orientation":n,className:(0,r.cn)(i({orientation:n}),t),...l,"data-sentry-component":"PageSectionRoot","data-sentry-source-file":"index.tsx",children:a})};l.displayName="PageSectionRoot";let o=e=>{let{className:t,children:n,...a}=e;return(0,s.jsx)("div",{"data-slot":"page-section-summary",className:(0,r.cn)("flex flex-col gap-1",t),...a,"data-sentry-component":"PageSectionSummary","data-sentry-source-file":"index.tsx",children:n})};o.displayName="PageSectionSummary";let c=e=>{let{className:t,children:n,...a}=e;return(0,s.jsx)("h2",{"data-slot":"page-section-title",className:(0,r.cn)("heading-section",t),...a,"data-sentry-component":"PageSectionTitle","data-sentry-source-file":"index.tsx",children:n})};c.displayName="PageSectionTitle";let d=e=>{let{className:t,...n}=e;return(0,s.jsx)("div",{"data-slot":"page-section-content",className:(0,r.cn)(t),...n,"data-sentry-component":"PageSectionContent","data-sentry-source-file":"index.tsx"})};d.displayName="PageSectionContent"},15359:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var s=n(80263),a=n(86510),r=n(23729),i=n(52555),l=n.n(i),o=n(99779);let c=e=>{let{title:t="",size:n="medium",children:i,ctaButtonLabel:c="",infoButtonLabel:d="",infoButtonUrl:u="",onClickCta:m=()=>{},loading:x=!1,disabled:h=!1,disabledMessage:p="",ctaUrl:f}=e,y=c&&m||u&&d;return(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center","data-sentry-component":"ProductEmptyState","data-sentry-source-file":"ProductEmptyState.tsx",children:(0,s.jsx)("div",{className:"flex space-x-4 rounded border bg-surface-100 p-6 shadow-md",children:(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsxs)("div",{className:"".concat("medium"===n?"w-80":"w-[400px]"," space-y-4"),children:[(0,s.jsx)("h5",{className:"text-foreground",children:t}),(0,s.jsx)("div",{className:"flex flex-col space-y-2 text-foreground-light",children:i}),y&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[c&&f?(0,s.jsx)(o.$,{asChild:!0,type:"primary",children:(0,s.jsx)(l(),{href:f,children:c})}):c&&m?(0,s.jsx)(r.G,{type:"primary",onClick:m,loading:x,disabled:x||h,tooltip:{content:{side:"bottom",text:h&&p.length>0?p:void 0}},children:c}):null,u&&d?(0,s.jsx)(o.$,{type:"default",icon:(0,s.jsx)(a.A,{strokeWidth:1.5}),children:(0,s.jsx)("a",{target:"_blank",rel:"noreferrer",href:u,children:d})}):null]})]})})})})}},19197:(e,t,n)=>{"use strict";n.d(t,{AL:()=>c,J5:()=>u,J_:()=>o,N1:()=>l,aw:()=>d,fX:()=>y,mL:()=>m,mN:()=>x,wB:()=>h,wy:()=>f,x0:()=>p});var s=n(9012),a=n.n(s),r=n(14506),i=n.n(r);let l=["int2","int4","int8","float4","float8","numeric","double precision"],o=["json","jsonb"],c=["text","varchar"],d=["timestamp","timestamptz"],u=["date"],m=["time","timetz"],x=a()(d,u,m),h=["uuid","bool","vector","bytea"],p=i()(a()(l,o,c,x,h)),f={varchar:{alternative:"text",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_varchar.28n.29_by_default"},json:{alternative:"jsonb",reference:"https://www.postgresql.org/docs/current/datatype-json.html"},timetz:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timetz"},timestamp:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timestamp_.28without_time_zone.29"}},y=[{name:"int2",description:"Signed two-byte integer",type:"number"},{name:"int4",description:"Signed four-byte integer",type:"number"},{name:"int8",description:"Signed eight-byte integer",type:"number"},{name:"float4",description:"Single precision floating-point number (4 bytes)",type:"number"},{name:"float8",description:"Double precision floating-point number (8 bytes)",type:"number"},{name:"numeric",description:"Exact numeric of selectable precision",type:"number"},{name:"json",description:"Textual JSON data",type:"json"},{name:"jsonb",description:"Binary JSON data, decomposed",type:"json"},{name:"text",description:"Variable-length character string",type:"text"},{name:"varchar",description:"Variable-length character string",type:"text"},{name:"uuid",description:"Universally unique identifier",type:"text"},{name:"date",description:"Calendar date (year, month, day)",type:"time"},{name:"time",description:"Time of day (no time zone)",type:"time"},{name:"timetz",description:"Time of day, including time zone",type:"time"},{name:"timestamp",description:"Date and time (no time zone)",type:"time"},{name:"timestamptz",description:"Date and time, including time zone",type:"time"},{name:"bool",description:"Logical boolean (true/false)",type:"bool"},{name:"bytea",description:"Variable-length binary string",type:"others"}]},19686:(e,t,n)=>{"use strict";n.d(t,{Ay:()=>c});var s={};n.r(s),n.d(s,{BRAND:()=>l.qt,DIRTY:()=>r.jm,EMPTY_PATH:()=>r.I3,INVALID:()=>r.uY,NEVER:()=>l.tm,OK:()=>r.OK,ParseStatus:()=>r.MY,Schema:()=>l.Sj,ZodAny:()=>l.Ml,ZodArray:()=>l.n,ZodBigInt:()=>l.Lr,ZodBoolean:()=>l.WF,ZodBranded:()=>l.eN,ZodCatch:()=>l.hw,ZodDate:()=>l.aP,ZodDefault:()=>l.Xi,ZodDiscriminatedUnion:()=>l.jv,ZodEffects:()=>l.k1,ZodEnum:()=>l.Vb,ZodError:()=>o.G,ZodFirstPartyTypeKind:()=>l.kY,ZodFunction:()=>l.CZ,ZodIntersection:()=>l.Jv,ZodIssueCode:()=>o.eq,ZodLazy:()=>l.Ih,ZodLiteral:()=>l.DN,ZodMap:()=>l.Ut,ZodNaN:()=>l.Tq,ZodNativeEnum:()=>l.WM,ZodNever:()=>l.iS,ZodNull:()=>l.PQ,ZodNullable:()=>l.l1,ZodNumber:()=>l.rS,ZodObject:()=>l.bv,ZodOptional:()=>l.Ii,ZodParsedType:()=>i.Zp,ZodPipeline:()=>l._c,ZodPromise:()=>l.$i,ZodReadonly:()=>l.EV,ZodRecord:()=>l.b8,ZodSchema:()=>l.lK,ZodSet:()=>l.Kz,ZodString:()=>l.ND,ZodSymbol:()=>l.K5,ZodTransformer:()=>l.BG,ZodTuple:()=>l.y0,ZodType:()=>l.aR,ZodUndefined:()=>l._Z,ZodUnion:()=>l.fZ,ZodUnknown:()=>l._,ZodVoid:()=>l.a0,addIssueToContext:()=>r.zn,any:()=>l.bz,array:()=>l.YO,bigint:()=>l.o,boolean:()=>l.zM,coerce:()=>l.au,custom:()=>l.Ie,date:()=>l.p6,datetimeRegex:()=>l.fm,defaultErrorMap:()=>a.su,discriminatedUnion:()=>l.gM,effect:()=>l.QZ,enum:()=>l.k5,function:()=>l.fH,getErrorMap:()=>a.$W,getParsedType:()=>i.CR,instanceof:()=>l.Nl,intersection:()=>l.E$,isAborted:()=>r.G4,isAsync:()=>r.xP,isDirty:()=>r.DM,isValid:()=>r.fn,late:()=>l.fn,lazy:()=>l.RZ,literal:()=>l.eu,makeIssue:()=>r.y7,map:()=>l.Tj,nan:()=>l.oi,nativeEnum:()=>l.fc,never:()=>l.Zm,null:()=>l.ch,nullable:()=>l.me,number:()=>l.ai,object:()=>l.Ik,objectUtil:()=>i.o6,oboolean:()=>l.yN,onumber:()=>l.p7,optional:()=>l.lq,ostring:()=>l.Di,pipeline:()=>l.Tk,preprocess:()=>l.vk,promise:()=>l.iv,quotelessJson:()=>o.WI,record:()=>l.g1,set:()=>l.hZ,setErrorMap:()=>a.pJ,strictObject:()=>l.re,string:()=>l.Yj,symbol:()=>l.HR,transformer:()=>l.Gu,tuple:()=>l.PV,undefined:()=>l.Vx,union:()=>l.KC,unknown:()=>l.L5,util:()=>i.ZS,void:()=>l.rI});var a=n(54686),r=n(93298),i=n(14595),l=n(10663),o=n(63324);let c=s},21874:(e,t,n)=>{"use strict";n.d(t,{e:()=>c});var s=n(72391),a=n(67850),r=n(32510),i=n(59356);let l=s.A.functions.list();async function o(e,t,n){let{projectRef:s,connectionString:a}=e,r=new Headers(n),{result:o}=await (0,i.E)({projectRef:s,connectionString:a,sql:l.sql,queryKey:["database-functions"]},t,r);return o}let c=function(e){let{projectRef:t,connectionString:n}=e,{enabled:s=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)({queryKey:r.c.databaseFunctions(t),queryFn:e=>{let{signal:s}=e;return o({projectRef:t,connectionString:n},s)},enabled:s&&void 0!==t,...i})}},22730:(e,t,n)=>{"use strict";n.d(t,{z:()=>d});var s=n(78510),a=n(67850),r=n(24523),i=n(9620),l=n(85039),o=n(87727);async function c(e,t,n){let{projectRef:a,connectionString:i}=e;if(!a)throw Error("projectRef is required");let l=new Headers(n);i&&l.set("x-connection-encrypted",i);let{data:o,error:c}=await (0,r.Jt)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":i,"x-pg-application-name":s.r},path:{ref:a}},headers:l,signal:t});return c&&(0,r.H4)(c),o}let d=function(e){let{projectRef:t,connectionString:n}=e,{enabled:s=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d}=(0,i.YA)(),u=(null==d?void 0:d.status)===l.BU.ACTIVE_HEALTHY;return(0,a.I)({queryKey:o.I.list(t),queryFn:e=>{let{signal:s}=e;return c({projectRef:t,connectionString:n},s)},enabled:s&&void 0!==t&&u,...r})}},23988:(e,t,n)=>{"use strict";n.d(t,{Q:()=>x,m:()=>h});var s=n(80263),a=n(76174),r=n(53239),i=n(48156),l=n(883),o=n(61548),c=n(99779),d=n(80100),u=n(29244),m=n(10663);let x=m.YO(m.Yj()),h=e=>{let{label:t,options:n,value:m,onChange:x,isLoading:h=!1,className:p,showSearch:f=!1}=e,[y,g]=(0,r.useState)(!1),[j,v]=(0,r.useState)(m),b=j.length>0;(0,r.useEffect)(()=>{y||v(m)},[y,m]);let N=()=>{x(j),g(!1)},S=e=>{"Enter"===e.key&&(e.preventDefault(),N())};return(0,s.jsxs)(o.AM,{open:y,onOpenChange:g,"data-sentry-element":"Popover","data-sentry-component":"ReportsSelectFilter","data-sentry-source-file":"ReportsSelectFilter.tsx",children:[(0,s.jsx)(o.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger","data-sentry-source-file":"ReportsSelectFilter.tsx",children:(0,s.jsx)(c.$,{type:b?"default":"outline",className:(0,d.cn)("min-w-20 border-dashed relative group justify-between",{"border-solid":b},p),iconRight:(0,s.jsx)(a.A,{size:14}),"data-sentry-element":"Button","data-sentry-source-file":"ReportsSelectFilter.tsx",children:(0,s.jsxs)("span",{children:[t,j.length>0&&(0,s.jsxs)("span",{className:"ml-1 text-xs",children:["(",j.length,")"]})]})})}),(0,s.jsxs)(o.hl,{align:"start",className:"p-0 w-72",portal:!0,"data-sentry-element":"PopoverContent","data-sentry-source-file":"ReportsSelectFilter.tsx",children:[(0,s.jsxs)(u.uB,{"data-sentry-element":"Command","data-sentry-source-file":"ReportsSelectFilter.tsx",children:[f&&(0,s.jsx)(u.G7,{placeholder:"Search..."}),(0,s.jsxs)(u.oI,{"data-sentry-element":"CommandList","data-sentry-source-file":"ReportsSelectFilter.tsx",children:[(0,s.jsx)(u.xL,{"data-sentry-element":"CommandEmpty","data-sentry-source-file":"ReportsSelectFilter.tsx",children:"No options found."}),(0,s.jsx)(u.L$,{"data-sentry-element":"CommandGroup","data-sentry-source-file":"ReportsSelectFilter.tsx",children:n.map(e=>(0,s.jsx)(u.h_,{children:(0,s.jsxs)(l.J,{className:"flex items-center overflow-hidden p-1 rounded-sm gap-x-3 w-full h-full",children:[(0,s.jsx)(i.S,{id:"".concat(t,"-").concat(e.value),checked:j.includes(e.value),onCheckedChange:t=>{v(t?[...j,e.value]:j.filter(t=>t!==e.value))},onKeyDown:S}),(0,s.jsxs)("div",{className:"flex flex-col text-xs",children:[e.label,e.description&&(0,s.jsx)("span",{className:"text-foreground-lighter",children:e.description})]})]},e.value)},e.value))})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-default p-2",children:[(0,s.jsx)(c.$,{size:"tiny",type:"outline",onClick:()=>{v([])},disabled:h,"data-sentry-element":"Button","data-sentry-source-file":"ReportsSelectFilter.tsx",children:"Clear"}),(0,s.jsx)(c.$,{loading:h,size:"tiny",type:"primary",onClick:N,htmlType:"button","data-sentry-element":"Button","data-sentry-source-file":"ReportsSelectFilter.tsx",children:"Apply"})]})]})]})}},29948:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},30075:(e,t,n)=>{var s=n(50117);e.exports=n(94277)(function(e,t,n){s(e,n,t)})},31626:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},35693:(e,t,n)=>{"use strict";n.d(t,{i:()=>d});var s=n(80263),a=n(53239),r=n(95137),i=n(99779),l=n(63335),o=n(44725);let c=e=>{let{onClose:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,s.jsx)(r.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Schemas managed by Supabase"})}),(0,s.jsx)(r.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"ProtectedSchemaWarning.tsx"}),(0,s.jsxs)(r.OO,{className:"space-y-2 prose","data-sentry-element":"DialogSection","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:[(0,s.jsx)("p",{className:"text-sm",children:"The following schemas are managed by Supabase and are currently protected from write access through the dashboard."}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:l.$O.map(e=>(0,s.jsx)("code",{className:"text-xs",children:e},e))}),(0,s.jsx)("p",{className:"text-sm !mt-4",children:"These schemas are critical to the functionality of your Supabase project and hence we highly recommend not altering them."}),(0,s.jsx)("p",{className:"text-sm",children:"You can, however, still interact with those schemas through the SQL Editor although we advise you only do so if you know what you are doing."})]}),(0,s.jsx)(r.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:(0,s.jsx)("div",{className:"flex items-center justify-end space-x-2",children:(0,s.jsx)(i.$,{type:"default",onClick:t,"data-sentry-element":"Button","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"Understood"})})})]})},d=e=>{let{size:t="md",schema:n,entity:d}=e,[u,m]=(0,a.useState)(!1),{isSchemaLocked:x,reason:h,fdwType:p}=(0,l.BQ)({schema:n});return x?(0,s.jsx)(o.Z,{showIcon:"sm"!==t,type:"note",title:"sm"===t?"Viewing protected schema":"Viewing ".concat(d," from a protected schema"),className:"[&_p]:!m-0","data-sentry-element":"Admonition","data-sentry-component":"ProtectedSchemaWarning","data-sentry-source-file":"ProtectedSchemaWarning.tsx",children:"fdw"===h&&"iceberg"===p?(0,s.jsxs)("p",{children:["The ",(0,s.jsx)("code",{className:"text-code-inline",children:n})," schema is used by Supabase to connect to analytics buckets and is read-only through the dashboard."]}):"fdw"===h&&"s3_vectors"===p?(0,s.jsxs)("p",{children:["The ",(0,s.jsx)("code",{className:"text-xs",children:n})," schema is used by Supabase to connect to vector buckets and is read-only through the dashboard."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"mb-2",children:["The ",(0,s.jsx)("code",{className:"text-code-inline",children:n})," schema is managed by Supabase and is read-only through the dashboard."]}),(0,s.jsxs)(r.lG,{open:u,onOpenChange:m,children:[(0,s.jsx)(r.zM,{asChild:!0,children:(0,s.jsx)(i.$,{type:"default",size:"tiny",onClick:()=>m(!0),children:"Learn more"})}),(0,s.jsx)(r.Cf,{children:(0,s.jsx)(c,{onClose:()=>m(!1)})})]})]})}):null}},39624:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var s=n(80263),a=n(12123);let r=e=>{let{resourceText:t,isFullPage:n=!1}=e,r=()=>(0,s.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(a.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,s.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return n?(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsx)("div",{className:"w-[550px]",children:(0,s.jsx)(r,{})})}):(0,s.jsx)(r,{})}},46087:(e,t,n)=>{"use strict";n.d(t,{$:()=>l,s:()=>i});var s=n(53239),a=n(23850),r=n(73969);function i(e){let{enabled:t,urlKey:n,select:r,onError:i}=e,[l,o]=(0,a.ZA)(n,a.tU.withOptions({history:"push",clearOnDefault:!0})),c=(0,s.useMemo)(()=>l?r(l):void 0,[l,r]);return(0,s.useEffect)(()=>{t&&l&&!c&&(i(Error("not found"),l),o(null))},[t,i,l,o,c]),{value:c,setValue:o}}let l=(e,t,n)=>{t!==e.current?r.oR.error(n):e.current=null}},53407:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]])},54831:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]])},55315:(e,t,n)=>{var s=n(71057);e.exports=function(e,t){return s(t,function(t){return e[t]})}},55435:(e,t,n)=>{"use strict";n.d(t,{GQ:()=>r,Il:()=>i});var s=n(97344),a=n.n(s);function r(e){let t=null==e?void 0:e.split(",").map(e=>e.trim());return a()(e)||!t||0===t.length?{value:[]}:{value:t.map(e=>{let t=e.match(/(\w+)\s+([\w\[\]]+)(?:\s+DEFAULT\s+(.*))?/i);if(!t)return console.error("Error while trying to parse function arguments",e),null;{let[,e,n,s]=t,a=s?s.trim():void 0;return["timestamp","time","timetz","timestamptz"].includes(n.toLowerCase())&&a&&(a="'".concat(a,"'")),{name:e,type:n,defaultValue:a}}}).filter(Boolean)}}function i(e){let t=[];if(e)for(var n in e)t.push({name:n,value:e[n]});return{value:t}}},56748:(e,t,n)=>{"use strict";n.d(t,{Y:()=>s});let s={list:e=>["projects",e,"fdws"]}},57384:(e,t,n)=>{"use strict";n.d(t,{k:()=>i});var s=n(23850),a=n(53239),r=n(22891);let i=()=>{var e;let{ref:t}=(0,r.g)(),n=t&&t.length>0&&window.localStorage.getItem(r.rS.LAST_SELECTED_SCHEMA(t))||"public",[i,l]=(e=(0,a.useMemo)(()=>n,[t]),(0,s.ZA)("schema",s.tU.withDefault(e).withOptions({clearOnDefault:!1})));return(0,a.useEffect)(()=>{t&&t.length>0&&window.localStorage.setItem(r.rS.LAST_SELECTED_SCHEMA(t),i)},[i,t]),{selectedSchema:i,setSelectedSchema:l}}},61741:(e,t,n)=>{var s=n(55315),a=n(24967);e.exports=function(e){return null==e?[]:s(e,a(e))}},66959:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("DatabaseZap",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 15 21.84",key:"14ibmq"}],["path",{d:"M21 5V8",key:"1marbg"}],["path",{d:"M21 12L18 17H22L19 22",key:"zafso"}],["path",{d:"M3 12A9 3 0 0 0 14.59 14.87",key:"1y4wr8"}]])},68296:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var s=n(80263),a=n(80814),r=n(91958),i=n(93873),l=n(22730),o=n(78937),c=n(2657),d=n(9620),u=n(9497),m=n(29471),x=n(54278);let h=()=>{let{data:e}=(0,d.YA)(),t=(0,a.useRouter)().pathname.split("/")[4],{data:n}=(0,l.z)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),{data:u}=(0,o.Q)({projectRef:null==e?void 0:e.ref}),m=void 0!==(null!=n?n:[]).find(e=>"pg_net"===e.name),h=(null==u?void 0:u.selected_addons.find(e=>"pitr"===e.type))!==void 0,p=(0,r.p4)(),{databaseReplication:f,databaseRoles:y,integrationsWrappers:g}=(0,c.x)(["database:replication","database:roles","integrations:wrappers"]);return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(i.l,{page:t,menu:(0,x.k)(e,{pgNetExtensionExists:m,pitrEnabled:h,columnLevelPrivileges:p,showPgReplicate:f,showRoles:y,showWrappers:g}),"data-sentry-element":"ProductMenu","data-sentry-source-file":"DatabaseLayout.tsx"})})},p=(0,u.r)(e=>{let{children:t}=e;return(0,s.jsx)(m.k,{product:"Database",productMenu:(0,s.jsx)(h,{}),isBlocking:!1,"data-sentry-element":"ProjectLayout","data-sentry-component":"DatabaseLayout","data-sentry-source-file":"DatabaseLayout.tsx",children:t})})},69988:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]])},70350:e=>{e.exports=function(e){return null===e}},73036:(e,t,n)=>{"use strict";n.d(t,{$:()=>r});var s=n(53239),a=n(74065);let r=e=>{let{checkIsDirty:t,onClose:n}=e,[r,i]=(0,s.useState)(!1),l=(0,a.A)(t),o=(0,a.A)(n),c=(0,s.useCallback)(()=>{l.current()?i(!0):o.current()},[]),d=(0,s.useCallback)(()=>{i(!1),o.current()},[]),u=(0,s.useCallback)(()=>{i(!1)},[]),m=(0,s.useMemo)(()=>({visible:r,onClose:d,onCancel:u}),[r,d,u]);return(0,s.useMemo)(()=>({confirmOnClose:c,modalProps:m}),[c,m])}},74195:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]])},74310:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},74415:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},77444:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},78555:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>te});var s=n(80263),a=n(72112),r=n(31092),i=n(80814),l=n(23850),o=n(53239),c=n(73969),d=n(22891),u=n(23988),m=n(69498),x=n(15359),h=n(44168),p=n(23729),f=n(84438),y=n(53931),g=n(51355),j=n(80210),v=n(72391),b=n(32510),N=n(59356);async function S(e){let{projectRef:t,connectionString:n,func:s}=e,{sql:a,zod:r}=v.A.functions.remove(s),{result:i}=await (0,N.E)({projectRef:t,connectionString:n,sql:a,queryKey:["functions","delete",s.id.toString()]});return i}let w=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,g.jE)();return(0,j.n)({mutationFn:e=>S(e),async onSuccess(t,n,a){let{projectRef:r}=n;await s.invalidateQueries({queryKey:b.c.databaseFunctions(r)}),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?c.oR.error("Failed to delete database function: ".concat(e.message)):t(e,n,s)},...n})};var A=n(21874),C=n(32775),_=n(80090),k=n(46087),E=n(57384),F=n(9620),T=n(63335),z=n(95448),R=n(18664),I=n(80421),L=n(72432),D=n(78039),M=n(78511),P=n(35693),Z=n(86926),q=n.n(Z),B=n(83927),V=n.n(B),O=n(14506),Y=n.n(O),$=n(77444),H=n(2534),U=n(74415),K=n(3225),Q=n(9753),W=n(33922),G=n(52555),J=n.n(G),X=n(99779),ee=n(21162);let et=e=>{let{schema:t,filterString:n,isLocked:r,returnTypeFilter:l,securityFilter:o,duplicateFunction:c=V(),editFunction:d=V(),deleteFunction:u=V(),functions:x}=e,h=(0,i.useRouter)(),{data:f}=(0,F.YA)(),y=(0,z.xd)(),{openSidebar:g}=(0,R.rM)(),j=(null!=x?x:[]).filter(e=>{let t=q()(e.name.toLowerCase(),n.toLowerCase()),s=0===l.length||l.includes(e.return_type),a=0===o.length||o.includes("definer")&&e.security_definer||o.includes("invoker")&&!e.security_definer;return t&&s&&a}),v=Y()(j.filter(e=>e.schema==t),e=>e.name.toLocaleLowerCase()),b=null==f?void 0:f.ref,{can:N}=(0,_.Qp)(a.aG.TENANT_SQL_ADMIN_WRITE,"functions");return 0===v.length&&0===n.length?(0,s.jsx)(M.Hj,{children:(0,s.jsxs)(M.nA,{colSpan:5,children:[(0,s.jsx)("p",{className:"text-sm text-foreground",children:"No functions created yet"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:['There are no functions found in the schema "',t,'"']})]})},t):0===v.length&&n.length>0?(0,s.jsx)(M.Hj,{children:(0,s.jsxs)(M.nA,{colSpan:5,children:[(0,s.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',n,'" did not return any results']})]})},t):(0,s.jsx)(s.Fragment,{children:v.map(e=>{let n="public"==t&&"trigger"!==e.return_type;return(0,s.jsxs)(M.Hj,{children:[(0,s.jsx)(M.nA,{className:"truncate",children:(0,s.jsx)(X.$,{type:"text",className:"text-link-table-cell text-sm p-0 hover:bg-transparent title",onClick:()=>d(e),title:e.name,children:e.name})}),(0,s.jsx)(M.nA,{className:"table-cell",children:(0,s.jsx)("p",{title:e.argument_types,className:"truncate ".concat(e.argument_types?"text-foreground-light":"text-foreground-muted"),children:e.argument_types||"â€“"})}),(0,s.jsx)(M.nA,{className:"table-cell",children:"trigger"===e.return_type?(0,s.jsx)(J(),{href:"/project/".concat(b,"/database/triggers?search=").concat(e.name),className:"truncate text-link",title:e.return_type,children:e.return_type}):(0,s.jsx)("p",{title:e.return_type,className:"truncate text-foreground-light",children:e.return_type})}),(0,s.jsx)(M.nA,{className:"table-cell",children:(0,s.jsx)("p",{className:"truncate text-foreground-light",children:e.security_definer?"Definer":"Invoker"})}),(0,s.jsx)(M.nA,{className:"text-right",children:!r&&(0,s.jsx)("div",{className:"flex items-center justify-end",children:N?(0,s.jsxs)(ee.rI,{children:[(0,s.jsx)(ee.ty,{asChild:!0,children:(0,s.jsx)(X.$,{"aria-label":"More options",type:"default",className:"px-1",icon:(0,s.jsx)($.A,{})})}),(0,s.jsxs)(ee.SQ,{side:"left",className:"w-52",children:[n&&(0,s.jsxs)(ee._2,{className:"space-x-2",onClick:()=>h.push("/project/".concat(b,"/api?rpc=").concat(e.name)),children:[(0,s.jsx)(H.A,{size:14}),(0,s.jsx)("p",{children:"Client API docs"})]}),(0,s.jsx)(ee.mB,{}),(0,s.jsxs)(ee._2,{className:"space-x-2",onClick:()=>d(e),children:[(0,s.jsx)(U.A,{size:14}),(0,s.jsx)("p",{children:"Edit function"})]}),(0,s.jsxs)(ee._2,{className:"space-x-2",onClick:()=>{g(m.c.AI_ASSISTANT),y.newChat({name:"Update function ".concat(e.name),initialInput:"Update this function to do...",suggestions:{title:"I can help you make a change to this function, here are a few example prompts to get you started:",prompts:[{label:"Rename Function",description:"Rename this function to ..."},{label:"Modify Function",description:"Modify this function so that it ..."},{label:"Add Trigger",description:"Add a trigger for this function that calls it when ..."}]},sqlSnippets:[e.complete_statement]})},children:[(0,s.jsx)(K.A,{size:14}),(0,s.jsx)("p",{children:"Edit function with Assistant"})]}),(0,s.jsxs)(ee._2,{className:"space-x-2",onClick:()=>c(e),children:[(0,s.jsx)(Q.A,{size:14}),(0,s.jsx)("p",{children:"Duplicate function"})]}),(0,s.jsx)(ee.mB,{}),(0,s.jsxs)(ee._2,{className:"space-x-2",onClick:()=>u(e),children:[(0,s.jsx)(W.A,{size:14,className:"text-destructive"}),(0,s.jsx)("p",{children:"Delete function"})]})]})]}):(0,s.jsx)(p.G,{disabled:!0,type:"default",icon:(0,s.jsx)($.A,{}),className:"px-1",tooltip:{content:{side:"left",text:"You need additional permissions to update functions"}}})})})]},e.id)})})};var en=n(41200),es=n(32981),ea=n(97344),er=n.n(ea),ei=n(70350),el=n.n(ei),eo=n(30075),ec=n.n(eo),ed=n(44217),eu=n.n(ed),em=n(53667),ex=n.n(em),eh=n(90376),ep=n(87494),ef=n(19686),ey=n(19197),eg=n(22730);async function ej(e){let{projectRef:t,connectionString:n,payload:s}=e,{sql:a,zod:r}=v.A.functions.create(s),{result:i}=await (0,N.E)({projectRef:t,connectionString:n,sql:a,queryKey:["functions","create"]});return i}let ev=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,g.jE)();return(0,j.n)({mutationFn:e=>ej(e),async onSuccess(t,n,a){let{projectRef:r}=n;await s.invalidateQueries({queryKey:b.c.databaseFunctions(r)}),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?c.oR.error("Failed to create database function: ".concat(e.message)):t(e,n,s)},...n})};async function eb(e){let{projectRef:t,connectionString:n,func:s,payload:a}=e,{sql:r,zod:i}=v.A.functions.update(s,a),{result:l}=await (0,N.E)({projectRef:t,connectionString:n,sql:r,queryKey:["functions","update",s.id.toString()]});return l}let eN=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,g.jE)();return(0,j.n)({mutationFn:e=>eb(e),async onSuccess(t,n,a){let{projectRef:r}=n;await s.invalidateQueries({queryKey:b.c.databaseFunctions(r)}),await (null==e?void 0:e(t,n,a))},async onError(e,n,s){void 0===t?c.oR.error("Failed to update database function: ".concat(e.message)):t(e,n,s)},...n})};var eS=n(73036),ew=n(65346),eA=n(75878),eC=n(65887),e_=n(27371),ek=n(66329),eE=n(97757),eF=n(80100),eT=n(21527),ez=n(2353),eR=n(68421),eI=n(44053),eL=n(55435),eD=n(68152);let eM=e=>{let{selectedFunction:t,isDuplicating:n}=e;return(0,s.jsx)(ew.Fm,{className:"py-3 flex flex-row justify-between items-center border-b-0","data-sentry-element":"SheetHeader","data-sentry-component":"CreateFunctionHeader","data-sentry-source-file":"CreateFunctionHeader.tsx",children:(0,s.jsxs)("div",{className:"flex flex-row gap-3 items-center max-w-[75%]",children:[(0,s.jsxs)(ew.kN,{className:(0,eF.cn)("text-muted hover:text ring-offset-background transition-opacity hover:opacity-100","focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","disabled:pointer-events-none data-[state=open]:bg-secondary","transition"),"data-sentry-element":"SheetClose","data-sentry-source-file":"CreateFunctionHeader.tsx",children:[(0,s.jsx)(eD.A,{className:"h-3 w-3","data-sentry-element":"X","data-sentry-source-file":"CreateFunctionHeader.tsx"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,s.jsx)(ew.qp,{className:"truncate","data-sentry-element":"SheetTitle","data-sentry-source-file":"CreateFunctionHeader.tsx",children:void 0!==t?n?"Duplicate function":"Edit '".concat(t,"' function"):"Add a new function"})]})})};var eP=n(98103),eZ=n(61113),eq=n(15040),eB=n(30404);let eV=e=>{let{field:t,language:n,focused:a,setFocused:r}=e;return(0,s.jsxs)("div",{className:(0,eF.cn)("rounded-md relative group flex-grow"),"data-sentry-component":"FunctionEditor","data-sentry-source-file":"FunctionEditor.tsx",children:[(0,s.jsx)(eC.MJ,{"data-sentry-element":"FormControl_Shadcn_","data-sentry-source-file":"FunctionEditor.tsx",children:void 0!==n&&(0,s.jsx)(eq.A,{id:"database-functions-editor",language:"pgsql",placeholder:"plpgsql"===n?"BEGIN\n\nEND;":void 0,value:t.value,onInputChange:t.onChange})}),(0,s.jsx)("div",{className:(0,eF.cn)("absolute top-0 right-2 bg-surface-300 border border-strong rounded h-[28px]","opacity-0 group-hover:opacity-100 group-hover:top-2 transition-all"),children:(0,s.jsxs)(eB.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"FunctionEditor.tsx",children:[(0,s.jsx)(eB.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"FunctionEditor.tsx",children:(0,s.jsx)(X.$,{type:"text",size:"tiny",className:(0,eF.cn)("px-1.5 text-foreground-lighter hover:text-foreground","transition z-50"),onClick:()=>r(!a),icon:a?(0,s.jsx)(eP.A,{}):(0,s.jsx)(eZ.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"FunctionEditor.tsx"})}),(0,s.jsx)(eB.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"FunctionEditor.tsx",children:a?"Minimize editor":"Maximize editor"})]})})]})},eO="create-function-sidepanel",eY=ef.Ay.object({name:ef.Ay.string().trim().min(1),schema:ef.Ay.string().trim().min(1),args:ef.Ay.array(ef.Ay.object({name:ef.Ay.string().trim().min(1),type:ef.Ay.string().trim()})),behavior:ef.Ay.enum(["IMMUTABLE","STABLE","VOLATILE"]),definition:ef.Ay.string().trim().min(1),language:ef.Ay.string().trim(),return_type:ef.Ay.string().trim(),security_definer:ef.Ay.boolean(),config_params:ef.Ay.array(ef.Ay.object({name:ef.Ay.string().trim().min(1),value:ef.Ay.string().trim().min(1)})).optional()}),e$=e=>{let{func:t,visible:n,isDuplicating:a=!1,onClose:r}=e,{data:i}=(0,F.YA)(),[l,d]=(0,o.useState)(!1),[u,m]=(0,o.useState)(!1),x=!a&&!!(null==t?void 0:t.id),h=(0,ep.mN)({resolver:(0,es.u)(eY)}),p=h.watch("language"),{confirmOnClose:y,modalProps:g}=(0,eS.$)({checkIsDirty:()=>h.formState.isDirty,onClose:r}),{mutate:j,isPending:v}=ev(),{mutate:b,isPending:N}=eN(),S=async e=>{if(!i)return console.error("Project is required");let n={...e,args:e.args.map(e=>"".concat(e.name," ").concat(e.type)),config_params:eu()(ec()(e.config_params,"name"),"value")};x?b({func:t,projectRef:i.ref,connectionString:i.connectionString,payload:n},{onSuccess:()=>{c.oR.success("Successfully updated function ".concat(e.name)),r()}}):j({projectRef:i.ref,connectionString:i.connectionString,payload:n},{onSuccess:()=>{c.oR.success("Successfully created function ".concat(e.name)),r()}})};(0,o.useEffect)(()=>{if(n){var e,s,a,r,i,l,o;m(!1),h.reset({name:null!=(e=null==t?void 0:t.name)?e:"",schema:null!=(s=null==t?void 0:t.schema)?s:"public",args:(0,eL.GQ)((null==t?void 0:t.argument_types)||"").value,behavior:null!=(a=null==t?void 0:t.behavior)?a:"VOLATILE",definition:null!=(r=null==t?void 0:t.definition)?r:"",language:null!=(i=null==t?void 0:t.language)?i:"plpgsql",return_type:null!=(l=null==t?void 0:t.return_type)?l:"void",security_definer:null!=(o=null==t?void 0:t.security_definer)&&o,config_params:(0,eL.Il)(null==t?void 0:t.config_params).value})}},[n,t]);let{data:w}=(0,T.Uu)();return(0,s.jsx)(ew.cj,{open:n,onOpenChange:y,"data-sentry-element":"Sheet","data-sentry-component":"CreateFunction","data-sentry-source-file":"index.tsx",children:(0,s.jsxs)(ew.h,{showClose:!1,size:"default",className:"p-0 flex flex-row gap-0 !min-w-screen lg:!min-w-[600px]","data-sentry-element":"SheetContent","data-sentry-source-file":"index.tsx",children:[(0,s.jsxs)("div",{className:"flex flex-col grow w-full",children:[(0,s.jsx)(eM,{selectedFunction:null==t?void 0:t.name,isDuplicating:a,"data-sentry-element":"CreateFunctionHeader","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(eA.w,{"data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(eC.lV,{...h,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"index.tsx",children:(0,s.jsxs)("form",{id:eO,className:"flex-grow overflow-auto",onSubmit:h.handleSubmit(S),children:[(0,s.jsx)(ew.Xc,{className:u?"hidden":"","data-sentry-element":"SheetSection","data-sentry-source-file":"index.tsx",children:(0,s.jsx)(eC.zB,{control:h.control,name:"name",render:e=>{let{field:t}=e;return(0,s.jsx)(eI.M,{label:"Name of function",description:"Name will also be used for the function name in postgres",layout:"horizontal",children:(0,s.jsx)(eC.MJ,{children:(0,s.jsx)(e_.p,{...t,placeholder:"Name of function"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"index.tsx"})}),(0,s.jsx)(eA.w,{className:u?"hidden":"","data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),(0,s.jsxs)(ew.Xc,{className:u?"hidden":"space-y-4","data-sentry-element":"SheetSection","data-sentry-source-file":"index.tsx",children:[(0,s.jsx)(eC.zB,{control:h.control,name:"schema",render:e=>{let{field:t}=e;return(0,s.jsx)(eI.M,{label:"Schema",description:"Tables made in the table editor will be in 'public'",layout:"horizontal",children:(0,s.jsx)(eC.MJ,{children:(0,s.jsx)(f.A,{portal:!1,selectedSchemaName:t.value,excludedSchemas:null==w?void 0:w.map(e=>e.name),size:"small",onSelectSchema:e=>t.onChange(e)})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"index.tsx"}),!x&&(0,s.jsx)(eC.zB,{control:h.control,name:"return_type",render:e=>{let{field:t}=e;return(0,s.jsx)(eI.M,{label:"Return type",layout:"horizontal",children:(0,s.jsxs)(ek.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,s.jsx)(ek.bq,{className:"col-span-8",children:(0,s.jsx)(ek.yv,{})}),(0,s.jsx)(ek.gC,{children:(0,s.jsx)(eE.FK,{className:"h-52",children:["void","record","trigger","integer",...ey.x0].map(e=>(0,s.jsx)(ek.eb,{value:e,children:e},e))})})]})})}})]}),(0,s.jsx)(eA.w,{className:u?"hidden":"","data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(ew.Xc,{className:u?"hidden":"","data-sentry-element":"SheetSection","data-sentry-source-file":"index.tsx",children:(0,s.jsx)(eU,{readonly:x,"data-sentry-element":"FormFieldArgs","data-sentry-source-file":"index.tsx"})}),(0,s.jsx)(eA.w,{className:u?"hidden":"","data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),(0,s.jsx)(ew.Xc,{className:"".concat(u?"h-full":""," !px-0"),"data-sentry-element":"SheetSection","data-sentry-source-file":"index.tsx",children:(0,s.jsx)(eC.zB,{control:h.control,name:"definition",render:e=>{let{field:t}=e;return(0,s.jsxs)(eC.eI,{className:"space-y-4 flex flex-col h-full",children:[(0,s.jsxs)("div",{className:"px-content",children:[(0,s.jsx)(eC.lR,{className:"text-base text-foreground",children:"Definition"}),(0,s.jsxs)(eC.Rr,{className:"text-sm text-foreground-light",children:[(0,s.jsxs)("p",{children:["The language below should be written in ",(0,s.jsx)("code",{children:p}),"."]}),!x&&(0,s.jsx)("p",{children:"Change the language in the Advanced Settings below."})]})]}),(0,s.jsx)("div",{className:(0,eF.cn)("border border-default flex",u?"flex-grow ":"h-72"),children:(0,s.jsx)(eV,{field:t,language:p,focused:u,setFocused:m})}),(0,s.jsx)(eC.C5,{className:"px-content"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"index.tsx"})}),(0,s.jsx)(eA.w,{className:u?"hidden":"","data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),x?(0,s.jsx)(s.Fragment,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ew.Xc,{className:u?"hidden":"",children:(0,s.jsx)("div",{className:"space-y-8 rounded bg-studio py-4 px-6 border border-overlay",children:(0,s.jsx)(eT.A,{onChange:()=>d(!l),label:"Show advanced settings",checked:l,labelOptional:"These are settings that might be familiar for Postgres developers"})})}),l&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(ew.Xc,{className:u?"hidden":"space-y-2 pt-0",children:[(0,s.jsx)(eW,{}),(0,s.jsx)(eC.zB,{control:h.control,name:"behavior",render:e=>{let{field:t}=e;return(0,s.jsx)(eI.M,{label:"Behavior",layout:"horizontal",children:(0,s.jsxs)(ek.l6,{defaultValue:t.value,onValueChange:t.onChange,children:[(0,s.jsx)(ek.bq,{className:"col-span-8",children:(0,s.jsx)(ek.yv,{})}),(0,s.jsxs)(ek.gC,{children:[(0,s.jsx)(ek.eb,{value:"IMMUTABLE",children:"immutable"},"IMMUTABLE"),(0,s.jsx)(ek.eb,{value:"STABLE",children:"stable"},"STABLE"),(0,s.jsx)(ek.eb,{value:"VOLATILE",children:"volatile"},"VOLATILE")]})]})})}})]}),(0,s.jsx)(eA.w,{className:u?"hidden":""}),(0,s.jsx)(ew.Xc,{className:u?"hidden":"",children:(0,s.jsx)(eK,{readonly:x})}),(0,s.jsx)(eA.w,{className:u?"hidden":""}),(0,s.jsxs)(ew.Xc,{className:u?"hidden":"",children:[(0,s.jsx)("h5",{className:"text-base text-foreground mb-4",children:"Type of Security"}),(0,s.jsx)(eC.zB,{control:h.control,name:"security_definer",render:e=>{let{field:t}=e;return(0,s.jsxs)(eC.eI,{children:[(0,s.jsx)(eC.MJ,{className:"col-span-8",children:(0,s.jsxs)(ez.A.Group,{type:"cards",layout:"vertical",onChange:e=>t.onChange("SECURITY_DEFINER"==e.target.value),value:t.value?"SECURITY_DEFINER":"SECURITY_INVOKER",children:[(0,s.jsx)(ez.A,{id:"SECURITY_INVOKER",label:"SECURITY INVOKER",value:"SECURITY_INVOKER",checked:!t.value,description:(0,s.jsxs)(s.Fragment,{children:["Function is to be executed with the privileges of the user that ",(0,s.jsx)("span",{className:"text-foreground",children:"calls it"}),"."]})}),(0,s.jsx)(ez.A,{id:"SECURITY_DEFINER",label:"SECURITY DEFINER",value:"SECURITY_DEFINER",checked:t.value,description:(0,s.jsxs)(s.Fragment,{children:["Function is to be executed with the privileges of the user that ",(0,s.jsx)("span",{className:"text-foreground",children:"created it"}),"."]})})]})}),(0,s.jsx)(eC.C5,{})]})}})]})]})]})]})}),(0,s.jsxs)(ew.XW,{"data-sentry-element":"SheetFooter","data-sentry-source-file":"index.tsx",children:[(0,s.jsx)(X.$,{disabled:v||N,type:"default",onClick:y,"data-sentry-element":"Button","data-sentry-source-file":"index.tsx",children:"Cancel"}),(0,s.jsxs)(X.$,{form:eO,htmlType:"submit",disabled:v||N,loading:v||N,"data-sentry-element":"Button","data-sentry-source-file":"index.tsx",children:[x?"Save":"Create"," function"]})]})]}),(0,s.jsx)(eH,{...g,"data-sentry-element":"CloseConfirmationModal","data-sentry-source-file":"index.tsx"})]})})},eH=e=>{let{visible:t,onClose:n,onCancel:a}=e;return(0,s.jsx)(eR.A,{visible:t,title:"Discard changes",confirmLabel:"Discard",onCancel:a,onConfirm:n,"data-sentry-element":"ConfirmationModal","data-sentry-component":"CloseConfirmationModal","data-sentry-source-file":"index.tsx",children:(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"There are unsaved changes. Are you sure you want to close the panel? Your changes will be lost."})})},eU=e=>{let{readonly:t}=e,{fields:n,append:a,remove:r}=(0,ep.jz)({name:"args"});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("h5",{className:"text-base text-foreground",children:"Arguments"}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"Arguments can be referenced in the function body using either names or numbers."})]}),(0,s.jsxs)("div",{className:"space-y-2 pt-4",children:[t&&er()(n)&&(0,s.jsx)("span",{className:"text-foreground-lighter",children:"No argument for this function"}),n.map((e,n)=>(0,s.jsxs)("div",{className:"flex flex-row space-x-1",children:[(0,s.jsx)(eC.zB,{name:"args.".concat(n,".name"),render:e=>{let{field:n}=e;return(0,s.jsxs)(eC.eI,{className:"flex-1",children:[(0,s.jsx)(eC.MJ,{children:(0,s.jsx)(e_.p,{...n,disabled:t,placeholder:"argument_name"})}),(0,s.jsx)(eC.C5,{})]})}}),(0,s.jsx)(eC.zB,{name:"args.".concat(n,".type"),render:e=>{let{field:n}=e;return(0,s.jsxs)(eC.eI,{className:"flex-1",children:[(0,s.jsx)(eC.MJ,{children:t?(0,s.jsx)(e_.p,{value:n.value,disabled:!0,readOnly:!0,className:"h-auto"}):(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(ek.l6,{disabled:t,onValueChange:n.onChange,defaultValue:n.value,children:[(0,s.jsx)(ek.bq,{className:"h-[38px]",children:(0,s.jsx)(ek.yv,{})}),(0,s.jsx)(ek.gC,{children:(0,s.jsx)(eE.FK,{className:"h-52",children:["integer",...ey.x0].map(e=>(0,s.jsx)(ek.eb,{value:e,children:e},e))})})]})})}),(0,s.jsx)(eC.C5,{})]})}}),!t&&(0,s.jsx)(X.$,{type:"danger",icon:(0,s.jsx)(W.A,{size:12}),onClick:()=>r(n),className:"h-[38px] w-[38px]"})]},e.id)),!t&&(0,s.jsx)(X.$,{type:"default",icon:(0,s.jsx)(eh.A,{size:12}),onClick:()=>a({name:"",type:"integer"}),disabled:t,children:"Add a new argument"})]})]})},eK=e=>{let{readonly:t}=e,{fields:n,append:a,remove:r}=(0,ep.jz)({name:"config_params"});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h5",{className:"text-base text-foreground",children:"Configuration Parameters"}),(0,s.jsxs)("div",{className:"space-y-2 pt-4",children:[t&&er()(n)&&(0,s.jsx)("span",{className:"text-foreground-lighter",children:"No argument for this function"}),n.map((e,n)=>(0,s.jsxs)("div",{className:"flex flex-row space-x-1",children:[(0,s.jsx)(eC.zB,{name:"config_params.".concat(n,".name"),render:e=>{let{field:t}=e;return(0,s.jsxs)(eC.eI,{className:"flex-1",children:[(0,s.jsx)(eC.MJ,{children:(0,s.jsx)(e_.p,{...t,placeholder:"parameter_name"})}),(0,s.jsx)(eC.C5,{})]})}}),(0,s.jsx)(eC.zB,{name:"config_params.".concat(n,".value"),render:e=>{let{field:t}=e;return(0,s.jsxs)(eC.eI,{className:"flex-1",children:[(0,s.jsx)(eC.MJ,{children:(0,s.jsx)(e_.p,{...t,placeholder:"parameter_value"})}),(0,s.jsx)(eC.C5,{})]})}}),!t&&(0,s.jsx)(X.$,{type:"danger",icon:(0,s.jsx)(W.A,{size:12}),onClick:()=>r(n),className:"h-[38px] w-[38px]"})]},e.id)),!t&&(0,s.jsx)(X.$,{type:"default",icon:(0,s.jsx)(eh.A,{size:12}),onClick:()=>a({name:"",type:""}),disabled:t,children:"Add a new config"})]})]})},eQ=["plpgsql","sql","plcoffee","plv8","plls"],eW=()=>{let{data:e}=(0,F.YA)(),{data:t}=(0,eg.z)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString},{select:e=>ex()(e,e=>!el()(e.installed_version))[0]}),n=(0,o.useMemo)(()=>eQ.filter(e=>!e.startsWith("pl")||(null==t?void 0:t.find(t=>t.name===e))!==void 0),[t]);return(0,s.jsx)(eC.zB,{name:"language",render:e=>{let{field:t}=e;return(0,s.jsx)(eI.M,{label:"Language",layout:"horizontal",children:(0,s.jsxs)(ek.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,s.jsx)(ek.bq,{className:"col-span-8",children:(0,s.jsx)(ek.yv,{})}),(0,s.jsx)(ek.gC,{children:n.map(e=>(0,s.jsx)(ek.eb,{value:e,children:e},e))})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-component":"FormFieldLanguage","data-sentry-source-file":"index.tsx"})};var eG=n(94335);let eJ=e=>{let{func:t,visible:n,setVisible:a,onDelete:r,isLoading:i}=e,{data:l}=(0,F.YA)(),{name:o,schema:c}=null!=t?t:{};async function d(){return t?l?void r({func:t,projectRef:l.ref,connectionString:l.connectionString}):console.error("Project is required"):console.error("Function is required")}return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(eG.A,{variant:"warning",visible:n,onCancel:()=>a(null),onConfirm:d,title:"Delete this function",loading:i,confirmLabel:"Delete function ".concat(o),confirmPlaceholder:"Type in name of function",confirmString:null!=o?o:"Unknown",text:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"This will delete the function"})," ",(0,s.jsx)("span",{className:"text-bold text-foreground",children:o})," ",(0,s.jsx)("span",{children:"from the schema"})," ",(0,s.jsx)("span",{className:"text-bold text-foreground",children:c})]}),alert:{title:"You cannot recover this function once deleted."},"data-sentry-element":"TextConfirmModal","data-sentry-source-file":"DeleteFunction.tsx"})})};var eX=n(89144);let e0=()=>{let e=(0,i.useRouter)(),{search:t}=(0,d.g)(),{data:n}=(0,F.YA)(),g=(0,z.xd)(),{openSidebar:j}=(0,R.rM)(),{selectedSchema:v,setSelectedSchema:b}=(0,E.k)(),N=(0,en.h)(),{setValue:S,setTemplates:Z,setInitialPrompt:q}=(0,eX.ab)(),B=(0,o.useRef)(null),V=()=>{ed(null),N?(q("Create a new database function that..."),S("create function function_name()\nreturns void\nlanguage plpgsql\nas $$\nbegin\n  -- Write your function logic here\nend;\n$$;"),Z([]),j(m.c.EDITOR_PANEL)):el(!0)},O=null!=t?t:"",[Y,$]=(0,l.ZA)("return_type",(0,l.os)(u.Q.parse)),[H,U]=(0,l.ZA)("security",(0,l.os)(u.Q.parse)),K=t=>{let n=new URL(document.URL);""===t?n.searchParams.delete("search"):n.searchParams.set("search",t),e.push(n)},{can:Q}=(0,_.Qp)(a.aG.TENANT_SQL_ADMIN_WRITE,"functions"),{isSchemaLocked:W}=(0,T.BQ)({schema:v});(0,C.w$)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString});let{data:G,error:J,isLoading:X,isError:ee}=(0,A.e)({projectRef:null==n?void 0:n.ref,connectionString:null==n?void 0:n.connectionString}),es=(null!=G?G:[]).filter(e=>e.schema===v),ea=Array.from(new Set(es.map(e=>e.return_type))).sort(),er=[...es.some(e=>e.security_definer)?[{label:"Definer",value:"definer"}]:[],...es.some(e=>!e.security_definer)?[{label:"Invoker",value:"invoker"}]:[]],[ei,el]=(0,l.ZA)("new",l.cr.withDefault(!1).withOptions({history:"push",clearOnDefault:!0})),{setValue:eo,value:ec}=(0,k.s)({urlKey:"edit",select:e=>e?null==G?void 0:G.find(t=>t.id.toString()===e):void 0,enabled:!!G,onError:()=>c.oR.error("Function not found")}),{setValue:ed,value:eu}=(0,k.s)({urlKey:"duplicate",select:e=>{if(!e)return;let t=null==G?void 0:G.find(t=>t.id.toString()===e);return t?{...t,name:"".concat(t.name,"_duplicate")}:void 0},enabled:!!G,onError:()=>c.oR.error("Function not found")}),{setValue:em,value:ex}=(0,k.s)({urlKey:"delete",select:e=>e?null==G?void 0:G.find(t=>t.id.toString()===e):void 0,enabled:!!G,onError:(e,t)=>(0,k.$)(B,t,"Function not found")}),{mutate:eh,isPending:ep}=w({onSuccess:(e,t)=>{c.oR.success("Successfully removed function ".concat(t.func.name)),em(null)},onError:()=>{B.current=null}});return X?(0,s.jsx)(y.yV,{}):ee?(0,s.jsx)(h.A,{error:J,subject:"Failed to retrieve database functions"}):(0,s.jsxs)(s.Fragment,{children:[0===(null!=G?G:[]).length?(0,s.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,s.jsxs)(x.A,{title:"Functions",ctaButtonLabel:"Create a new function",onClickCta:()=>V(),disabled:!Q,disabledMessage:"You need additional permissions to create functions",children:[(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"PostgreSQL functions, also known as stored procedures, is a set of SQL and procedural commands such as declarations, assignments, loops, flow-of-control, etc."}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"It's stored on the database server and can be invoked using the SQL interface."})]})}):(0,s.jsxs)("div",{className:"w-full space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-2 flex-wrap",children:[(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center gap-2",children:[(0,s.jsx)(f.A,{className:"w-full lg:w-[180px]",size:"tiny",showError:!1,selectedSchemaName:v,onSelectSchema:e=>{K(""),setTimeout(()=>{b(e)},50)}}),(0,s.jsx)(I.A,{placeholder:"Search for a function",size:"tiny",icon:(0,s.jsx)(r.A,{size:14}),value:O,className:"w-full lg:w-52",onChange:e=>K(e.target.value)}),(0,s.jsx)(u.m,{label:"Return Type",options:ea.map(e=>({label:e,value:e})),value:null!=Y?Y:[],onChange:$,showSearch:!0}),(0,s.jsx)(u.m,{label:"Security",options:er,value:null!=H?H:[],onChange:U})]}),(0,s.jsx)("div",{className:"flex items-center gap-x-2",children:!W&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.G,{disabled:!Q,onClick:()=>V(),className:"flex-grow",tooltip:{content:{side:"bottom",text:Q?void 0:"You need additional permissions to create functions"}},children:"Create a new function"}),(0,s.jsx)(p.G,{type:"default",disabled:!Q,className:"px-1 pointer-events-auto",icon:(0,s.jsx)(L.M,{size:16}),onClick:()=>{j(m.c.AI_ASSISTANT),g.newChat({name:"Create new function",initialInput:"Create a new function for the schema ".concat(v," that does ...")})},tooltip:{content:{side:"bottom",text:Q?"Create with Supabase Assistant":"You need additional permissions to create functions"}}})]})})]}),W&&(0,s.jsx)(P.i,{schema:v,entity:"functions"}),(0,s.jsx)(D.Zp,{children:(0,s.jsxs)(M.XI,{className:"table-fixed overflow-x-auto",children:[(0,s.jsx)(M.A0,{children:(0,s.jsxs)(M.Hj,{children:[(0,s.jsx)(M.nd,{children:"Name"},"name"),(0,s.jsx)(M.nd,{className:"table-cell",children:"Arguments"},"arguments"),(0,s.jsx)(M.nd,{className:"table-cell",children:"Return type"},"return_type"),(0,s.jsx)(M.nd,{className:"table-cell w-[100px]",children:"Security"},"security"),(0,s.jsx)(M.nd,{className:"w-1/6"},"buttons")]})}),(0,s.jsx)(M.BF,{children:(0,s.jsx)(et,{schema:v,filterString:O,isLocked:W,returnTypeFilter:null!=Y?Y:[],securityFilter:null!=H?H:[],duplicateFunction:e=>{if(N){let t={...e,name:"".concat(e.name,"_duplicate")};q("Create new database function that..."),S(t.complete_statement),Z([]),j(m.c.EDITOR_PANEL)}else ed(e.id.toString())},editFunction:e=>{ed(null),N?(S(e.complete_statement),Z([]),j(m.c.EDITOR_PANEL)):eo(e.id.toString())},deleteFunction:e=>{em(e.id.toString())},functions:null!=G?G:[]})})]})})]}),(0,s.jsx)(e$,{visible:ei,onClose:()=>{el(!1)},"data-sentry-element":"CreateFunction","data-sentry-source-file":"FunctionsList.tsx"}),(0,s.jsx)(e$,{func:ec||eu,visible:!!ec||!!eu,onClose:()=>{eo(null),ed(null)},isDuplicating:!!eu,"data-sentry-element":"CreateFunction","data-sentry-source-file":"FunctionsList.tsx"}),(0,s.jsx)(eJ,{func:ex,visible:!!ex,setVisible:em,onDelete:e=>{B.current=e.func.id.toString(),eh(e)},isLoading:ep,"data-sentry-element":"DeleteFunction","data-sentry-source-file":"FunctionsList.tsx"})]})};var e1=n(68296),e2=n(10508),e3=n(41273),e5=n(39624),e8=n(85039),e4=n(45218),e9=n(30688),e6=n(14354);let e7=()=>{let{can:e,isSuccess:t}=(0,_.Qp)(a.aG.TENANT_SQL_ADMIN_READ,"functions");return t&&!e?(0,s.jsx)(e5.A,{isFullPage:!0,resourceText:"view database functions"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e9.zY,{size:"large","data-sentry-element":"PageHeader","data-sentry-source-file":"functions.tsx",children:(0,s.jsxs)(e9.Ys,{"data-sentry-element":"PageHeaderMeta","data-sentry-source-file":"functions.tsx",children:[(0,s.jsx)(e9.tq,{"data-sentry-element":"PageHeaderSummary","data-sentry-source-file":"functions.tsx",children:(0,s.jsx)(e9.RR,{"data-sentry-element":"PageHeaderTitle","data-sentry-source-file":"functions.tsx",children:"Database Functions"})}),(0,s.jsx)(e9.vT,{"data-sentry-element":"PageHeaderAside","data-sentry-source-file":"functions.tsx",children:(0,s.jsx)(e3.A,{href:"".concat(e8.aq,"/guides/database/functions"),"data-sentry-element":"DocsButton","data-sentry-source-file":"functions.tsx"})})]})}),(0,s.jsx)(e4.L,{size:"large","data-sentry-element":"PageContainer","data-sentry-source-file":"functions.tsx",children:(0,s.jsx)(e6.d8,{"data-sentry-element":"PageSection","data-sentry-source-file":"functions.tsx",children:(0,s.jsx)(e6.KP,{"data-sentry-element":"PageSectionContent","data-sentry-source-file":"functions.tsx",children:(0,s.jsx)(e0,{"data-sentry-element":"FunctionsList","data-sentry-source-file":"functions.tsx"})})})})]})};e7.getLayout=e=>(0,s.jsx)(e2.A,{children:(0,s.jsx)(e1.A,{title:"Database",children:e})});let te=e7},84438:(e,t,n)=>{"use strict";n.d(t,{A:()=>g});var s=n(80263),a=n(72112),r=n(32157),i=n(23892),l=n(90376),o=n(53239),c=n(32775),d=n(80090),u=n(9620),m=n(99779),x=n(73640),h=n(20033),p=n(61548),f=n(29244),y=n(97757);let g=e=>{let{className:t,disabled:n=!1,size:g="tiny",showError:j=!0,selectedSchemaName:v,supportSelectAll:b=!1,excludedSchemas:N=[],onSelectSchema:S,onSelectCreateSchema:w,portal:A=!0,align:C="start"}=e,[_,k]=(0,o.useState)(!1),{can:E}=(0,d.Qp)(a.aG.TENANT_SQL_ADMIN_WRITE,"schemas"),{data:F}=(0,u.YA)(),{data:T,isLoading:z,isSuccess:R,isError:I,error:L,refetch:D}=(0,c.w$)({projectRef:null==F?void 0:F.ref,connectionString:null==F?void 0:F.connectionString}),M=(T||[]).filter(e=>!N.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,s.jsxs)("div",{className:t,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[z&&(0,s.jsx)(m.$,{type:"default",className:"w-full [&>span]:w-full",size:g,disabled:!0,children:(0,s.jsx)(x.E,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),j&&I&&(0,s.jsxs)(h.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,s.jsx)(h.XL,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,s.jsxs)(h.TN,{className:"text-xs mb-2 break-words",children:["Error: ",null==L?void 0:L.message]}),(0,s.jsx)(m.$,{type:"default",size:"tiny",onClick:()=>D(),children:"Reload schemas"})]}),R&&(0,s.jsxs)(p.AM,{open:_,onOpenChange:k,modal:!1,children:[(0,s.jsx)(p.Wv,{asChild:!0,children:(0,s.jsx)(m.$,{size:g,disabled:n,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,s.jsx)(r.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:v?(0,s.jsxs)("div",{className:"w-full flex gap-1",children:[(0,s.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,s.jsx)("p",{className:"text-foreground",children:"*"===v?"All schemas":v})]}):(0,s.jsx)("div",{className:"w-full flex gap-1",children:(0,s.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schema..."})})})}),(0,s.jsx)(p.hl,{className:"p-0 min-w-[200px] pointer-events-auto",side:"bottom",align:C,portal:A,sameWidthAsTrigger:!0,children:(0,s.jsxs)(f.uB,{children:[(0,s.jsx)(f.G7,{placeholder:"Find schema..."}),(0,s.jsxs)(f.oI,{children:[(0,s.jsx)(f.xL,{children:"No schemas found"}),(0,s.jsx)(f.L$,{children:(0,s.jsxs)(y.FK,{className:(M||[]).length>7?"h-[210px]":"",children:[b&&(0,s.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{S("*"),k(!1)},onClick:()=>{S("*"),k(!1)},children:[(0,s.jsx)("span",{children:"All schemas"}),"*"===v&&(0,s.jsx)(i.A,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==M?void 0:M.map(e=>(0,s.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{S(e.name),k(!1)},onClick:()=>{S(e.name),k(!1)},children:[(0,s.jsx)("span",{children:e.name}),v===e.name&&(0,s.jsx)(i.A,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==w&&E&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.fx,{}),(0,s.jsx)(f.L$,{children:(0,s.jsxs)(f.h_,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{w(),k(!1)},onClick:()=>{w(),k(!1)},children:[(0,s.jsx)(l.A,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},86926:(e,t,n)=>{var s=n(35902),a=n(89527),r=n(22442),i=n(80544),l=n(61741),o=Math.max;e.exports=function(e,t,n,c){e=a(e)?e:l(e),n=n&&!c?i(n):0;var d=e.length;return n<0&&(n=o(d+n,0)),r(e)?n<=d&&e.indexOf(t,n)>-1:!!d&&s(e,t,n)>-1}},89092:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/database/functions",function(){return n(78555)}])},97344:(e,t,n)=>{var s=n(58381),a=n(51276),r=n(5689),i=n(33312),l=n(89527),o=n(79661),c=n(86458),d=n(63570),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(l(e)&&(i(e)||"string"==typeof e||"function"==typeof e.splice||o(e)||d(e)||r(e)))return!e.length;var t=a(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!s(e).length;for(var n in e)if(u.call(e,n))return!1;return!0}},98103:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]])},99940:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});let s=(0,n(86848).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])}},e=>{e.O(0,[60858,15599,16110,27764,36538,44033,26616,76984,72391,35035,40545,596,10508,48340,75187,29471,91312,63335,90636,46593,38792],()=>e(e.s=89092)),_N_E=e.O()}]);