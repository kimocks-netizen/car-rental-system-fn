try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="7c3c79de-fe6c-4903-afaf-8a91f3a8db00",e._sentryDebugIdIdentifier="sentry-dbid-7c3c79de-fe6c-4903-afaf-8a91f3a8db00")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61301],{2428:(e,n,t)=>{t.d(n,{LT:()=>C,MJ:()=>I,Q7:()=>k,Tt:()=>N});var a=t(80263),r=t(53434),i=t.n(r),s=t(74195),o=t(86510),l=t(74310),c=t(60858),d=t.n(c),u=t(52555),m=t.n(u),h=t(53239),x=t(29445),p=t(23729),g=t(37115),f=t(85039),y=t(36176),b=t(80100),v=t(21650),j=t(99779);let w=e=>{let{type:n,className:t}=e;switch(n){case"GitHub":return(0,a.jsx)(s.A,{strokeWidth:2,size:14});case"Vercel":return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"white",viewBox:"0 0 512 512",className:(0,b.cn)("w-3.5",t),children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M256,48,496,464H16Z"})});case"Supabase":return(0,a.jsx)("img",{src:"".concat(f.o2,"/img/supabase-logo.svg"),alt:"Supabase",className:"w-3.5"});default:return(0,a.jsx)(a.Fragment,{})}},_=e=>{let{src:n}=e;return(0,a.jsx)("div",{className:"relative border shadow-lg w-8 h-8 rounded-full overflow-hidden","data-sentry-component":"Avatar","data-sentry-source-file":"IntegrationPanels.tsx",children:(0,a.jsx)(d(),{src:n||"",width:30,height:30,layout:"fill",alt:"avatar",className:"relative","data-sentry-element":"Image","data-sentry-source-file":"IntegrationPanels.tsx"})})},N=(0,h.forwardRef)((e,n)=>{var t,r,s,l,c;let{integration:d,disabled:u,...h}=e;return(0,a.jsxs)("li",{ref:n,className:"bg-surface-100 border shadow-sm flex justify-between items-center px-8 py-4 rounded-lg",...h,children:[(0,a.jsxs)("div",{className:"flex gap-6 items-center",children:[(0,a.jsx)("div",{className:"flex gap-3 items-center",children:(0,a.jsxs)("div",{className:"flex -space-x-1",children:[(0,a.jsx)(()=>(0,a.jsx)("div",{className:"bg-black text-white w-8 h-8 rounded flex items-center justify-center","data-sentry-component":"IntegrationIconBlock","data-sentry-source-file":"IntegrationPanels.tsx",children:(0,a.jsx)(w,{type:d.integration.name,"data-sentry-element":"HandleIcon","data-sentry-source-file":"IntegrationPanels.tsx"})}),{}),(0,a.jsx)(_,{src:null==d||null==(t=d.metadata)?void 0:t.account.avatar})]})}),(0,a.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-foreground text-sm font-medium",children:(null==(r=d.metadata)?void 0:r.account.name)||void 0!==d.metadata&&"gitHubConnectionOwner"in d.metadata&&(null==(s=d.metadata)?void 0:s.gitHubConnectionOwner)}),(0,a.jsx)(v.E,{className:"capitalize",children:null==(l=d.metadata)?void 0:l.account.type})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Created ",i()(d.inserted_at).fromNow()]}),(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Added by ",null==d||null==(c=d.added_by)?void 0:c.primary_email]})]})]})]}),(0,a.jsx)(j.$,{asChild:!0,disabled:u,type:"default",iconRight:(0,a.jsx)(o.A,{}),children:u?(0,a.jsx)("p",{children:"Manage"}):(0,a.jsx)(m(),{href:(0,y.U)(d),target:"_blank",rel:"noopener noreferrer",children:"Manage"})})]},d.id)}),C=(0,h.forwardRef)((e,n)=>{var t,r,s,o,c;let{connection:d,type:u,actions:m,showNode:h=!0,orientation:x="horizontal",className:p,...y}=e,{data:v}=(0,g.wT)({ref:d.supabase_project_ref});return(0,a.jsxs)("li",{ref:n,...y,className:(0,b.cn)(h&&"pl-8 ml-6 border-l border-muted","relative"),children:[h&&(0,a.jsx)("div",{className:"absolute w-8 rounded-bl-full border-b border-l border-muted h-10 -left-px"}),(0,a.jsxs)("div",{className:(0,b.cn)("horizontal"===x?"flex items-center justify-between gap-2":"flex flex-col gap-3","bg-surface-100 border shadow-sm px-6 py-4 rounded-lg",p),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex-shrink-0 flex gap-x-2 items-center max-w-40 ",children:[(0,a.jsx)(w,{type:"Supabase"}),(0,a.jsx)("span",{title:null==v?void 0:v.name,className:"text-sm truncate",children:null==v?void 0:v.name})]}),(0,a.jsx)(l.A,{size:14,className:"flex-shrink-0 text-foreground-lighter",strokeWidth:1.5}),(0,a.jsxs)("div",{className:"flex-1 min-w-0 flex gap-2 items-center",children:[(null==d||null==(t=d.metadata)?void 0:t.framework)?(0,a.jsx)("img",{src:"".concat(f.o2,"/img/icons/frameworks/").concat(d.metadata.framework,".svg"),width:21,height:21,alt:"icon"}):(0,a.jsx)("div",{className:"bg-black text-white w-4 h-4 rounded flex items-center justify-center",children:(0,a.jsx)(w,{type:u,className:"!w-2.5"})}),"GitHub"===u?(0,a.jsx)("a",{title:d.metadata.name,href:"https://github.com/".concat(null==(r=d.metadata)?void 0:r.name),className:"text-sm truncate",target:"_blank",rel:"noreferrer",children:null==(s=d.metadata)?void 0:s.name}):(0,a.jsx)("span",{title:d.metadata.name,className:"text-sm truncate",children:null==(o=d.metadata)?void 0:o.name})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Connected ",i()(null==d?void 0:d.inserted_at).fromNow()]}),(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Added by ",null==d||null==(c=d.added_by)?void 0:c.primary_email]})]})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:m})]})]},d.id)}),S=(0,h.forwardRef)((e,n)=>{let{connection:t,type:r,...s}=e,{data:o}=(0,g.wT)({ref:t.supabase_project_ref});return(0,a.jsxs)("li",{ref:n,...s,className:(0,b.cn)("bg-surface-100 border shadow-sm flex justify-between items-center px-8 py-4 rounded-lg"),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)(w,{type:"Supabase"}),(0,a.jsx)("span",{className:"text-sm",children:null==o?void 0:o.name}),(0,a.jsx)(l.A,{size:14,className:"text-foreground-lighter",strokeWidth:1.5}),(0,a.jsx)(w,{type:r}),(0,a.jsx)("span",{className:"text-sm",children:t.metadata.name})]}),(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Connected ",i()(t.inserted_at).fromNow()]})]}),(0,a.jsx)(j.$,{type:"default",children:"Connect"})]},t.id)}),I=(0,h.forwardRef)((e,n)=>{let{className:t,showNode:r=!0,onClick:i,disabled:s,...o}=e;return(0,a.jsxs)("div",{ref:n,...o,className:(0,b.cn)(r&&"ml-6 pl-8 mt-4 border-l","relative pb-2","last:border-l-transparent",t),children:[r&&(0,a.jsx)("div",{className:"absolute w-8 rounded-bl-full border-b border-l border-muted h-14 -top-4 -left-px"}),(0,a.jsx)("div",{className:(0,b.cn)("w-full","border border-dashed bg-surface-100 border-overlay","flex h-20 px-10 rounded-lg justify-center items-center"),children:(0,a.jsx)(p.G,{type:"default",disabled:s,onClick:()=>i(),tooltip:{content:{side:"bottom",text:s?"Additional permissions required to add connection":void 0}},children:"Add new project connection"})})]})}),k=(0,h.forwardRef)((e,n)=>{let{className:t,markdown:r="",showNode:i=!0,...s}=e;return(0,a.jsxs)("div",{...s,ref:n,className:(0,b.cn)(i&&"border-l border-muted ml-6 pl-8","py-4 prose text-sm",t),children:[s.title&&(0,a.jsx)("h5",{className:"text-foreground",children:s.title}),(0,a.jsx)(x.o,{content:r})]})});N.displayName="IntegrationInstallation",C.displayName="IntegrationConnection",k.displayName="IntegrationConnectionHeader",I.displayName="EmptyIntegrationConnection",S.displayName="IntegrationConnectionOption"},9930:(e,n,t)=>{t.d(n,{m:()=>o});var a=t(67850),r=t(24523),i=t(63408);async function s(e){let{data:n,error:t}=await (0,r.Jt)("/platform/integrations/github/authorization",{signal:e});return t?null:n}let o=function(){let{enabled:e=!0,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,a.I)({queryKey:i.Z.githubAuthorization(),queryFn:e=>{let{signal:n}=e;return s(n)},enabled:e,staleTime:0,...n})}},19660:(e,n,t)=>{t.d(n,{A:()=>w});var a=t(80263),r=t(30075),i=t.n(r),s=t(53239),o=t(73969),l=t(22891),c=t(86561),d=t(65073),u=t(29445),m=t(12098),h=t(98690),x=t(47652),p=t(23979),g=t(84512),f=t(85039),y=t(36289),b=t(81802),v=t(79861);let j=(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"white",viewBox:"0 0 512 512",className:"w-6",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M256,48,496,464H16Z"})}),w=()=>{let{ref:e}=(0,l.g)(),{data:n}=(0,g.s)(),t=(0,b.bZ)(),r=t.vercelConnectionsIntegrationId,{data:w}=(0,h.$)({orgSlug:null==n?void 0:n.slug}),_=null==w?void 0:w.filter(e=>"Vercel"===e.integration.name),N=null==_?void 0:_.find(e=>e.id===r),{data:C}=(0,p.b)({organization_integration_id:r},{enabled:void 0!==r}),S=(0,s.useMemo)(()=>null!=C?C:y.Oj,[C]),I=(0,s.useMemo)(()=>i()(S,"id"),[S]),k=(0,s.useCallback)(e=>{let n=I[e.id];return(null==n?void 0:n.framework)?(0,a.jsx)("img",{src:"".concat(f.o2,"/img/icons/frameworks/").concat(n.framework,".svg"),width:21,height:21,alt:"icon"}):m.d},[I]),{mutate:P,isPending:V}=(0,x.T)({async onSuccess(e){let{env_sync_error:n}=e;n&&o.oR.error("Failed to sync environment variables: ".concat(n.message,". Please try re-syncing manually from settings.")),t.setVercelConnectionsOpen(!1)}}),F=(0,s.useCallback)(e=>{P({...e,connection:{...e.connection,metadata:{...e.connection.metadata,supabaseConfig:{projectEnvVars:{write:!0}}}}})},[P]);return(0,a.jsx)(v.Ay,{hideFooter:!0,size:"large",header:"Add new Vercel project connection",visible:t.vercelConnectionsOpen,onCancel:()=>t.setVercelConnectionsOpen(!1),"data-sentry-element":"SidePanel","data-sentry-component":"SidePanelVercelProjectLinker","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx",children:(0,a.jsxs)("div",{className:"py-6 flex flex-col gap-6 bg-studio h-full",children:[(0,a.jsx)(v.Ay.Content,{"data-sentry-element":"SidePanel.Content","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx",children:(0,a.jsx)(u.o,{content:"\n### Choose repository to connect to\n\nCheck the details below before proceeding\n          ","data-sentry-element":"Markdown","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx"})}),(0,a.jsxs)(v.Ay.Content,{className:"flex flex-col gap-2","data-sentry-element":"SidePanel.Content","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx",children:[(0,a.jsx)(d.A,{slug:null==n?void 0:n.slug,defaultSupabaseProjectRef:e,organizationIntegrationId:null==N?void 0:N.id,foreignProjects:S,onCreateConnections:F,installedConnections:null==N?void 0:N.connections,isLoading:V,integrationIcon:j,getForeignProjectIcon:k,choosePrompt:"Choose Vercel Project",mode:"Vercel","data-sentry-element":"ProjectLinker","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx"}),(0,a.jsx)(u.o,{content:"\nThe following environment variables will be added:\n\n".concat(c.O.map(e=>"\n - `".concat(e,"`")),"\n"),"data-sentry-element":"Markdown","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx"})]}),(0,a.jsx)(v.Ay.Content,{"data-sentry-element":"SidePanel.Content","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx",children:(0,a.jsx)("ul",{children:(0,a.jsx)("li",{className:"border px-10"})})})]})})}},32515:(e,n,t)=>{t.d(n,{S:()=>N});var a=t(80263),r=t(76174),i=t(73886),s=t(81672),o=t(33922),l=t(52555),c=t.n(l),d=t(80814),u=t(53239),m=t(73969),h=t(2428),x=t(23729),p=t(80210),g=t(24523);async function f(e){let{connectionId:n}=e,{data:t,error:a}=await (0,g.bE)("/platform/integrations/vercel/connections/{connection_id}/sync-envs",{params:{path:{connection_id:n}}});return a&&(0,g.H4)(a),t}let y=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,p.n)({mutationFn:e=>f(e),async onSuccess(n,t,a){await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?m.oR.error("Failed to sync environment variables: ".concat(e.message)):n(e,t,a)},...t})};var b=t(37115),v=t(84512),j=t(21162),w=t(99779),_=t(68421);let N=(0,u.forwardRef)((e,n)=>{let{disabled:t,onDeleteConnection:l,...p}=e,g=(0,d.useRouter)(),{data:f}=(0,v.s)(),{type:N,connection:C}=p,{data:S}=(0,b.wT)({ref:C.supabase_project_ref}),I=(null==S?void 0:S.is_branch_enabled)===!0,[k,P]=(0,u.useState)(!1),[V,F]=(0,u.useState)(!1),[A,z]=(0,u.useState)(!1),H=(0,u.useCallback)(async()=>{try{F(!0),await l(C)}catch(e){}finally{F(!1),P(!1)}},[C,l]),R=(0,u.useCallback)(()=>{P(!1)},[]),{mutate:G,isPending:M}=y({onSuccess:()=>{m.oR.success("Successfully synced environment variables"),z(!1)}}),L=(0,u.useCallback)(async()=>{G({connectionId:C.id})},[C,G]),E="/project/[ref]/settings/integrations";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.LT,{showNode:!1,actions:t?(0,a.jsx)(x.G,{disabled:!0,iconRight:(0,a.jsx)(r.A,{size:14}),type:"default",tooltip:{content:{side:"bottom",text:"You need additional permissions to manage this connection"}},children:"Manage"}):(0,a.jsxs)(j.rI,{open:A,onOpenChange:()=>z(!A),modal:!1,children:[(0,a.jsx)(j.ty,{asChild:!0,children:(0,a.jsx)(w.$,{iconRight:(0,a.jsx)(r.A,{size:14}),type:"default",children:(0,a.jsx)("span",{children:"Manage"})})}),(0,a.jsxs)(j.SQ,{side:"bottom",align:"end",children:[g.pathname!==E&&(0,a.jsx)(j._2,{asChild:!0,children:(0,a.jsx)(c(),{href:E.replace("[ref]",C.supabase_project_ref),children:"Configure connection"})}),"Vercel"===N&&(null==f?void 0:f.managed_by)!=="vercel-marketplace"&&(0,a.jsxs)(j._2,{className:"space-x-2",onSelect:e=>{e.preventDefault(),L()},disabled:M,children:[M?(0,a.jsx)(i.A,{className:"animate-spin",size:14}):(0,a.jsx)(s.A,{size:14}),(0,a.jsx)("p",{children:"Resync environment variables"})]}),("Vercel"===N&&(null==f?void 0:f.managed_by)!=="vercel-marketplace"||g.pathname!==E)&&(0,a.jsx)(j.mB,{}),(0,a.jsxs)(j._2,{className:"space-x-2",onSelect:()=>P(!0),children:[(0,a.jsx)(o.A,{size:14}),(0,a.jsx)("p",{children:"Delete connection"})]})]})]}),...p}),(0,a.jsx)(_.A,{variant:"destructive",size:"GitHub"===N&&I?"medium":"small",visible:k,title:"Confirm to delete ".concat(N," connection"),confirmLabel:"Delete connection",onCancel:R,onConfirm:H,loading:V,children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Deleting this GitHub connection will stop automatic creation and merging of preview branches. Existing preview branches will remain unchanged."})})]})});N.displayName="IntegrationConnectionItem"},36176:(e,n,t)=>{t.d(n,{I:()=>o,U:()=>l});var a=t(24523),r=t(5652);function i(e){return null!=e&&!(e instanceof r.o)&&("object"!=typeof e||!("error"in e)||!e.error)}async function s(e){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],t=await (0,a.x8)(e);if(!t.ok)return{error:new r.o(t.statusText,t.status)};try{return n?await t.json():await t.text()}catch(e){return{error:new r.o(e.message,500)}}}async function o(e){var n,t;if(!e)return null;let[,,,a,r,,o,...l]=null!=(t=null==e?void 0:e.split("/"))?t:[],c=l.join("/"),d="https://api.github.com/repos/".concat(a,"/").concat(r,"/contents/").concat(c),u="".concat(d,"/supabase?ref=").concat(o),m="".concat(d,"/").concat("supabase/migrations").concat(o?"?ref=".concat(o):""),[h,x]=await Promise.all([s(u),s(m)]);if(!i(h))return console.warn("Failed to fetch supabase files from GitHub: ".concat(h.error)),null;if(!i(x))return console.warn("Failed to fetch migration files from GitHub: ".concat(x.error)),null;let p=null==(n=h.find(e=>"seed.sql"===e.name))?void 0:n.download_url,g=x.sort((e,n)=>e.name<n.name?-1:+(e.name>n.name)),f=g.map(e=>s(e.download_url,!1)),[y,...b]=await Promise.all([p?s(p,!1):Promise.resolve(""),...f]),v=b.filter(e=>i(e)).join(";"),j=i(y)?y:"",w="\n    create schema if not exists supabase_migrations;\n    create table if not exists supabase_migrations.schema_migrations (\n      version text not null primary key,\n      statements text[],\n      name text\n    );\n    ".concat(g.map((e,n)=>{let t=b[n];if(!i(t))return"";let a=e.name.split("_")[0],r=JSON.stringify(t.split(";").map(e=>e.trim()).filter(Boolean));return"\n        insert into supabase_migrations.schema_migrations (version, statements, name)\n        select '".concat(a,"', array_agg(jsonb_statements)::text[], '").concat(e.name,"'\n        from jsonb_array_elements_text($statements$").concat(r,"$statements$::jsonb) as jsonb_statements;\n      ")}).join(""),"\n  ");return"".concat(v,";").concat(w,";").concat(j)}function l(e){var n,t,a,r,i,s,o,l;return"Vercel"===e.integration.name?(n=e,"https://vercel.com/dashboard/".concat((null==(t=n.metadata)?void 0:t.account.type)==="Team"?"".concat(null==(a=n.metadata)?void 0:a.account.team_slug,"/"):"","integrations/").concat(null==(r=n.metadata)?void 0:r.configuration_id)):"GitHub"===e.integration.name?(i=e,"https://github.com/".concat((null==(s=i.metadata)?void 0:s.account.type)==="Organization"?"organizations/".concat(null==(o=i.metadata)?void 0:o.account.name,"/"):"","settings/installations/").concat(null==(l=i.metadata)?void 0:l.installation_id)):""}t(85039),t(48621)},39624:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(80263),r=t(12123);let i=e=>{let{resourceText:n,isFullPage:t=!1}=e,i=()=>(0,a.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(r.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",n]}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return t?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("div",{className:"w-[550px]",children:(0,a.jsx)(i,{})})}):(0,a.jsx)(i,{})}},50795:(e,n,t)=>{t.d(n,{I:()=>i});var a=t(80263),r=t(99779);let i=e=>{let{form:n,hasChanges:t,handleReset:i,helper:s,disabled:o=!1,isSubmitting:l,submitText:c="Save"}=e,d=l||o||!t&&void 0!==t;return(0,a.jsxs)("div",{className:["flex w-full items-center gap-2",s?"justify-between":"justify-end"].join(" "),"data-sentry-component":"FormActions","data-sentry-source-file":"FormActions.tsx",children:[s&&(0,a.jsx)("span",{className:"text-sm text-foreground-lighter",children:s}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.$,{disabled:d,type:"default",htmlType:"reset",onClick:()=>i(),"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:"Cancel"}),(0,a.jsx)(r.$,{form:n,type:"primary",htmlType:"submit",disabled:d,loading:l,"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:c})]})]})}},60425:(e,n,t)=>{t.d(n,{A:()=>$});var a=t(80263),r=t(86510),i=t(52555),s=t.n(i),o=t(53239),l=t(73969),c=t(72112),d=t(32515),u=t(2428),m=t(29445),h=t(37873),x=t(39624),p=t(53931),g=t(98690),f=t(51355),y=t(80210),b=t(24523),v=t(63408);async function j(e,n){let{organization_integration_id:t,id:a}=e;if(!t)throw Error("organization_integration_id is required");let{data:r,error:i}=await (0,b.yH)("/platform/integrations/vercel/connections/{connection_id}",{params:{path:{connection_id:a}},signal:n});return i&&(0,b.H4)(i),r}let w=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,f.jE)();return(0,y.n)({mutationFn:e=>j(e),async onSuccess(n,t,r){await Promise.all([a.invalidateQueries({queryKey:v.Z.integrationsList()}),a.invalidateQueries({queryKey:v.Z.integrationsListWithOrg(t.orgSlug)}),a.invalidateQueries({queryKey:v.Z.vercelProjectList(t.organization_integration_id)}),a.invalidateQueries({queryKey:v.Z.vercelConnectionsList(t.organization_integration_id)})]),await (null==e?void 0:e(n,t,r))},async onError(e,t,a){void 0===n?l.oR.error("Failed to delete Vercel connection: ".concat(e.message)):n(e,t,a)},...t})};var _=t(23979),N=t(80090),C=t(84512),S=t(9620),I=t(6436),k=t(36176),P=t(81802),V=t(80100),F=t(99779),A=t(79506),z=t(32981),H=t(87494),R=t(10663),G=t(50795);async function M(e){let{id:n,envSyncTargets:t,publicEnvVarPrefix:a}=e,{data:r,error:i}=await (0,b.F6)("/platform/integrations/vercel/connections/{connection_id}",{params:{path:{connection_id:n}},body:{env_sync_targets:t,public_env_var_prefix:a}});return i&&(0,b.H4)(i),r}let L=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,f.jE)();return(0,y.n)({mutationFn:e=>M(e),async onSuccess(n,t,r){await a.invalidateQueries({queryKey:v.Z.vercelConnectionsList(t.organizationIntegrationId)}),await (null==e?void 0:e(n,t,r))},async onError(e,t,a){void 0===n?l.oR.error("Failed to update Vercel connection: ".concat(e.message)):n(e,t,a)},...t})};var E=t(85039),T=t(65887),B=t(20033),D=t(72608),O=t(27371);let q=e=>{var n;let{disabled:t,connection:r,integration:i}=e,{data:o}=(0,C.s)(),c=(null==o?void 0:o.managed_by)==="vercel-marketplace"?[]:null!=(n=r.env_sync_targets)?n:[],d=R.Ik({environmentVariablesProduction:R.zM().default(c.includes("production")),environmentVariablesPreview:R.zM().default(c.includes("preview")),environmentVariablesDevelopment:R.zM().default(c.includes("development")),publicEnvVarPrefix:R.Yj().optional()}),u=(0,H.mN)({resolver:(0,z.u)(d),defaultValues:{environmentVariablesProduction:c.includes("production"),environmentVariablesPreview:c.includes("preview"),environmentVariablesDevelopment:c.includes("development"),publicEnvVarPrefix:r.public_env_var_prefix}}),{mutate:m,isPending:h}=L({onSuccess:()=>{u.reset(u.getValues()),l.oR.success("Updated Vercel connection")}}),x="vercel-connection-form-".concat(r.id);return(0,a.jsx)(T.lV,{...u,"data-sentry-element":"Form_Shadcn_","data-sentry-component":"VercelIntegrationConnectionForm","data-sentry-source-file":"VercelIntegrationConnectionForm.tsx",children:(0,a.jsx)("form",{id:x,onSubmit:u.handleSubmit(function(e){var n;let{environmentVariablesProduction:t,environmentVariablesPreview:a,environmentVariablesDevelopment:s}=e,o=[];t&&o.push("production"),a&&o.push("preview"),s&&o.push("development"),m({id:r.id,envSyncTargets:o,publicEnvVarPrefix:null==(n=e.publicEnvVarPrefix)?void 0:n.trim(),organizationIntegrationId:i.id})}),className:"w-full space-y-6",children:(0,a.jsxs)("div",{className:"px-6 py-4 flex flex-col gap-y-4",children:[(0,a.jsx)("div",{className:"flex flex-col gap-4",children:(null==o?void 0:o.managed_by)==="vercel-marketplace"?(0,a.jsxs)(B.Fc,{children:[(0,a.jsx)(B.XL,{className:"text-sm",children:"Vercel Marketplace managed project"}),(0,a.jsxs)(B.TN,{className:"text-xs",children:["This project is managed via Vercel Marketplace. Environment variables are automatically synchronized for your connected Vercel projects. This integration purpose is synchronizing preview deployments environment variables with our"," ",(0,a.jsx)(s(),{target:"_blank",rel:"noreferrer",href:"".concat(E.aq,"/guides/platform/branching"),className:"underline",children:"Branching"})," ","feature."]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"text-foreground ",children:"Sync environment variables for selected target environments"}),(0,a.jsx)(T.zB,{control:u.control,name:"environmentVariablesProduction",render:e=>{let{field:n}=e;return(0,a.jsxs)(T.eI,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(T.MJ,{children:(0,a.jsx)(D.d,{disabled:t,className:"mt-1",checked:n.value,onCheckedChange:n.onChange})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(T.lR,{className:"!text",children:"Production"}),(0,a.jsxs)(T.Rr,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"production"})," environment."]})]})]})}}),(0,a.jsx)(T.zB,{control:u.control,name:"environmentVariablesPreview",render:e=>{let{field:n}=e;return(0,a.jsxs)(T.eI,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(T.MJ,{children:(0,a.jsx)(D.d,{disabled:t,className:"mt-1",checked:n.value,onCheckedChange:n.onChange})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(T.lR,{className:"!text",children:"Preview"}),(0,a.jsxs)(T.Rr,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"preview"})," environment."]})]})]})}}),(0,a.jsx)(T.zB,{control:u.control,name:"environmentVariablesDevelopment",render:e=>{let{field:n}=e;return(0,a.jsxs)(T.eI,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(T.MJ,{children:(0,a.jsx)(D.d,{disabled:t,className:"mt-1",checked:n.value,onCheckedChange:n.onChange})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(T.lR,{className:"!text",children:"Development"}),(0,a.jsxs)(T.Rr,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"development"})," environment."]})]})]})}})]})}),(0,a.jsx)("h5",{className:"mt-2 text-foreground",children:"Customize public environment variable prefix"}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:(0,a.jsx)(T.zB,{control:u.control,name:"publicEnvVarPrefix",render:e=>{let{field:n}=e;return(0,a.jsxs)(T.eI,{className:"grid gap-2 md:grid md:grid-cols-12 space-y-0",children:[(0,a.jsx)(T.lR,{className:"flex flex-col space-y-2 col-span-4 text-sm justify-center text-foreground-light",children:"Prefix"}),(0,a.jsx)(T.MJ,{className:"col-span-8",children:(0,a.jsx)(O.p,{...n,className:"w-full",disabled:t,placeholder:"An empty prefix will result in no public env vars"})}),(0,a.jsxs)(T.Rr,{className:"col-start-5 col-span-8 text-xs",children:["e.g."," ",(0,a.jsx)("code",{className:"cursor-pointer",role:"button",onClick:()=>{n.onChange("NEXT_PUBLIC_")},children:"NEXT_PUBLIC_"}),","," ",(0,a.jsx)("code",{className:"cursor-pointer",role:"button",onClick:()=>{n.onChange("VITE_PUBLIC_")},children:"VITE_PUBLIC_"}),","," ",(0,a.jsx)("code",{className:"cursor-pointer",role:"button",onClick:()=>{n.onChange("PUBLIC_")},children:"PUBLIC_"}),", etc."]}),(0,a.jsx)(T.C5,{className:"col-start-5 col-span-8"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"VercelIntegrationConnectionForm.tsx"})}),u.formState.isDirty?(0,a.jsxs)("p",{className:"mt-2 text-sm text-warning",children:["Note: Changing these settings will ",(0,a.jsx)("strong",{children:"not"})," trigger a resync of environment variables."]}):(0,a.jsx)("div",{className:"mt-2 h-5 w-full"}),(0,a.jsx)(G.I,{disabled:t,form:x,hasChanges:u.formState.isDirty,isSubmitting:h,handleReset:()=>u.reset(),"data-sentry-element":"FormActions","data-sentry-source-file":"VercelIntegrationConnectionForm.tsx"})]})})})},$=e=>{var n;let{isProjectScoped:t}=e,{data:i}=(0,S.YA)(),{data:f}=(0,C.s)(),{data:y}=(0,g.$)({orgSlug:null==f?void 0:f.slug}),b=(0,P.bZ)(),v=(null==i?void 0:i.parent_project_ref)!==void 0,{can:j,isLoading:z}=(0,N.Qp)(c.aG.READ,"integrations.vercel_connections"),{can:H}=(0,N.Qp)(c.aG.CREATE,"integrations.vercel_connections"),{can:R}=(0,N.Qp)(c.aG.UPDATE,"integrations.vercel_connections"),{mutate:G}=w({onSuccess:()=>{l.oR.success("Successfully deleted Vercel connection")}}),M=(0,o.useMemo)(()=>null==y?void 0:y.filter(e=>"Vercel"===e.integration.name).map(e=>{if(e.metadata&&"Vercel"===e.integration.name){let n=e.metadata.account.avatar||"Team"!==e.metadata.account.type?"https://vercel.com/api/www/avatar/".concat(e.metadata.account.avatar,"?s=48"):"https://vercel.com/api/www/avatar?teamId=".concat(e.metadata.account.team_id,"&s=48");e.metadata.account.avatar=n}return e}),[y]),L=null==M?void 0:M[0],{data:E}=(0,_.b)({organization_integration_id:null==L?void 0:L.id},{enabled:(null==L?void 0:L.id)!==void 0}),T=null!=(n=null==E?void 0:E.length)?n:0,B=(0,o.useCallback)(e=>{b.setVercelConnectionsIntegrationId(e),b.setVercelConnectionsOpen(!0)},[b]),D=(0,o.useCallback)(async e=>{G({id:e.id,organization_integration_id:e.organization_integration_id,orgSlug:null==f?void 0:f.slug})},[G,null==f?void 0:f.slug]),O=T>0&&void 0!==L?"\nYour Vercel connection has access to ".concat(T," Vercel Projects.\nYou can change the scope of the access for Supabase by configuring\n[here](").concat((0,k.U)(L),").\n"):"",$=(t?null==L?void 0:L.connections.filter(e=>e.supabase_project_ref===(null==i?void 0:i.ref)):null==L?void 0:L.connections)||[],Q="".concat($.length," project ").concat((0,I.td)($.length,"connection")," ");return(0,a.jsx)(h.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"VercelSection","data-sentry-source-file":"VercelSection.tsx",children:(0,a.jsxs)(h.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"VercelSection.tsx",children:[(0,a.jsxs)(h.xp,{title:"Vercel Integration","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"VercelSection.tsx",children:[(0,a.jsx)(m.o,{content:"\n\nConnect your Vercel teams to your Supabase organization.\n","data-sentry-element":"Markdown","data-sentry-source-file":"VercelSection.tsx"}),(0,a.jsx)(A.U,{title:"vercel","data-sentry-element":"IntegrationImageHandler","data-sentry-source-file":"VercelSection.tsx"})]}),(0,a.jsx)(h.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"VercelSection.tsx",children:z?(0,a.jsx)(p.yV,{}):j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.o,{content:"\n\n### How does the Vercel integration work?\n\nSupabase will keep your environment variables up to date in each of the projects you assign to a Supabase project.\nYou can also link multiple Vercel Projects to the same Supabase project.\n"}),L?(0,a.jsxs)("div",{children:[(0,a.jsx)(u.Tt,{title:"Vercel",integration:L}),$.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.Q7,{title:Q,markdown:"Repository connections for Vercel"}),(0,a.jsx)("ul",{className:"flex flex-col",children:$.map(e=>(0,a.jsxs)("div",{className:(0,V.cn)(t&&"relative flex flex-col -gap-[1px] [&>li]:pb-0"),children:[(0,a.jsx)(d.S,{connection:e,disabled:v||!R,type:"Vercel",onDeleteConnection:D,className:(0,V.cn)(t&&"!rounded-b-none !mb-0")}),t?(0,a.jsx)("div",{className:"relative pl-8 ml-6 border-l border-muted pb-6",children:(0,a.jsx)("div",{className:"border-b border-l border-r rounded-b-lg",children:(0,a.jsx)(q,{connection:e,integration:L,disabled:v||!R})})}):null]},e.id))})]}):(0,a.jsx)(u.Q7,{title:Q,className:"pb-0",markdown:"Repository connections for Vercel"}),(0,a.jsx)(u.MJ,{disabled:v||!H,onClick:()=>B(L.id),children:"Add new project connection"})]},L.id):(0,a.jsx)("div",{children:(0,a.jsx)(F.$,{icon:(0,a.jsx)(r.A,{}),asChild:!v,type:"default",disabled:v,children:v?(0,a.jsx)("p",{children:"Install Vercel Integration"}):(0,a.jsx)(s(),{href:"https://vercel.com/integrations/supabase",target:"_blank",rel:"noreferrer",children:"Install Vercel Integration"})})}),O&&(0,a.jsx)(m.o,{extLinks:!0,content:O,className:"text-foreground-lighter"})]}):(0,a.jsx)(x.A,{resourceText:"view this organization's Vercel connections"})})]})})}},71898:(e,n,t)=>{t.d(n,{L:()=>c});var a=t(51355),r=t(80210),i=t(73969),s=t(24523),o=t(63408);async function l(e,n){let{connectionId:t}=e,{data:a,error:r}=await (0,s.yH)("/platform/integrations/github/connections/{connection_id}",{params:{path:{connection_id:String(t)}},signal:n});return r&&(0,s.H4)(r),a}let c=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,a.jE)();return(0,r.n)({mutationFn:e=>l(e),async onSuccess(n,t,a){await Promise.all([s.invalidateQueries({queryKey:o.Z.githubConnectionsList(t.organizationId)})]),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?i.oR.error("Failed to delete GitHub connection: ".concat(e.message)):n(e,t,a)},...t})}},74195:(e,n,t)=>{t.d(n,{A:()=>a});let a=(0,t(86848).A)("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]])},74310:(e,n,t)=>{t.d(n,{A:()=>a});let a=(0,t(86848).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},79506:(e,n,t)=>{t.d(n,{U:()=>em,A:()=>eh});var a=t(80263),r=t(52555),i=t.n(r),s=t(19660),o=t(37873),l=t(37115),c=t(2657),d=t(9620),u=t(85039),m=t(20033),h=t(60793),x=t(72112),p=t(53239),g=t(22891),f=t(39624),y=t(8344),b=t(22158),v=t(80090),j=t(84512),w=t(80100),_=t(16488),N=t(32981),C=t(76174),S=t(90376),I=t(81672),k=t(73886),P=t(87494),V=t(73969),F=t(10663),A=t(63324),z=t(48004),H=t(14567),R=t(95140),G=t(9930),M=t(25958),L=t(51355),E=t(80210),T=t(24523),B=t(63408);async function D(e){let{connection:n}=e,{data:t,error:a}=await (0,T.bE)("/platform/integrations/github/connections",{body:n});return a&&(0,T.H4)(a),t}let O=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,L.jE)();return(0,E.n)({mutationFn:e=>D(e),async onSuccess(n,t,r){await Promise.all([a.invalidateQueries({queryKey:B.Z.githubConnectionsList(t.organizationId)})]),await (null==e?void 0:e(n,t,r))},async onError(e,t,a){void 0===n?V.oR.error("Failed to create GitHub connection: ".concat(e.message)):n(e,t,a)},...t})};var q=t(71898);async function $(e,n){let{connectionId:t,connection:a}=e,{data:r,error:i}=await (0,T.F6)("/platform/integrations/github/connections/{connection_id}",{params:{path:{connection_id:String(t)}},signal:n,body:a});return i&&(0,T.H4)(i),r}let Q=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,L.jE)();return(0,E.n)({mutationFn:e=>$(e),async onSuccess(n,t,r){await Promise.all([a.invalidateQueries({queryKey:B.Z.githubConnectionsList(t.organizationId)})]),await (null==e?void 0:e(n,t,r))},async onError(e,t,a){void 0===n?V.oR.error("Failed to update GitHub connection: ".concat(e.message)):n(e,t,a)},...t})};var J=t(67850);async function Z(e){let{data:n,error:t}=await (0,T.Jt)("/platform/integrations/github/repositories",{signal:e});return t&&(0,T.H4)(t),n}let U=function(){let{enabled:e=!0,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,J.I)({queryKey:B.Z.githubRepositoriesList(),queryFn:e=>{let{signal:n}=e;return Z(n)},enabled:e,staleTime:0,...n})};var Y=t(77192),K=t(36289),W=t(78039),X=t(99779),ee=t(65887),en=t(61548),et=t(29244),ea=t(27371),er=t(72608),ei=t(68421),es=t(44053);let eo=(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 98 96",className:"w-6",children:[(0,a.jsx)("title",{children:"GitHub icon"}),(0,a.jsx)("path",{fill:"#ffffff",fillRule:"evenodd",d:"M48.854 0C21.839 0 0 22 0 49.217c0 21.756 13.993 40.172 33.405 46.69 2.427.49 3.316-1.059 3.316-2.362 0-1.141-.08-5.052-.08-9.127-13.59 2.934-16.42-5.867-16.42-5.867-2.184-5.704-5.42-7.17-5.42-7.17-4.448-3.015.324-3.015.324-3.015 4.934.326 7.523 5.052 7.523 5.052 4.367 7.496 11.404 5.378 14.235 4.074.404-3.178 1.699-5.378 3.074-6.6-10.839-1.141-22.243-5.378-22.243-24.283 0-5.378 1.94-9.778 5.014-13.2-.485-1.222-2.184-6.275.486-13.038 0 0 4.125-1.304 13.426 5.052a46.97 46.97 0 0 1 12.214-1.63c4.125 0 8.33.571 12.213 1.63 9.302-6.356 13.427-5.052 13.427-5.052 2.67 6.763.97 11.816.485 13.038 3.155 3.422 5.015 7.822 5.015 13.2 0 18.905-11.404 23.06-22.324 24.283 1.78 1.548 3.316 4.481 3.316 9.126 0 6.6-.08 11.897-.08 13.526 0 1.304.89 2.853 3.316 2.364 19.412-6.52 33.405-24.935 33.405-46.691C97.707 22 75.788 0 48.854 0z",clipRule:"evenodd"})]}),el=e=>{var n;let{disabled:t=!1,connection:r}=e,{data:i}=(0,d.YA)(),{data:s}=(0,j.s)(),[o,l]=(0,p.useState)(!1),[c,u]=(0,p.useState)(!1),[m,h]=(0,p.useState)(!1),g=!(null==i?void 0:i.parent_project_ref),{can:f}=(0,v.Qp)(x.aG.UPDATE,"integrations.github_connections"),{can:y}=(0,v.Qp)(x.aG.CREATE,"integrations.github_connections"),{data:b,refetch:_}=(0,G.m)(),{data:L,isLoading:E,refetch:T}=U({enabled:!!b}),B=()=>{setTimeout(()=>{_(),T()},2e3)},{mutate:D}=(0,H.O)({onSuccess:()=>{V.oR.success("Production branch settings successfully updated")}}),{mutate:$}=(0,z.t)({onSuccess:()=>{V.oR.success("Production branch settings successfully updated")},onError:e=>{console.error("Failed to enable branching:",e)}}),{data:J}=(0,R.A)({projectRef:null==i?void 0:i.ref},{enabled:!!(null==i?void 0:i.ref)}),{mutateAsync:Z,isPending:el}=(0,M.v)({onError:()=>{}}),{mutate:ec,isPending:ed}=O({onSuccess:()=>{V.oR.success("GitHub integration successfully updated")}}),{mutateAsync:eu,isPending:em}=(0,q.L)({onSuccess:()=>{V.oR.success("Successfully removed GitHub integration")}}),{mutate:eh,isPending:ex}=Q(),ep=(0,p.useMemo)(()=>{var e,n;return null!=(n=null==L||null==(e=L.repositories)?void 0:e.map(e=>({id:e.id.toString(),name:e.name,installation_id:e.installation_id,default_branch:e.default_branch||"main"})))?n:K.Oj},[L]),eg=null!=(n=null==L?void 0:L.partial_response_due_to_sso)&&n,ef=null==J?void 0:J.find(e=>e.is_default),ey=F.Ik({repositoryId:F.Yj().min(1,"Please select a repository"),enableProductionSync:F.zM().default(!0),branchName:F.Yj().default("main"),new_branch_per_pr:F.zM().default(!0),supabaseDirectory:F.Yj().default("."),supabaseChangesOnly:F.zM().default(!0),branchLimit:F.Yj().default("50")}).superRefine(async(e,n)=>{if(e.enableProductionSync&&e.branchName&&e.branchName.length>0){let t=e.repositoryId||(null==r?void 0:r.repository.id.toString());if(t)try{await Z({repositoryId:Number(t),branchName:e.branchName})}catch(s){let a=ep.find(e=>e.id===t),i=(null==a?void 0:a.name)||(null==r?void 0:r.repository.name)||"selected repository";n.addIssue({code:A.eq.custom,message:'Branch "'.concat(e.branchName,'" not found in ').concat(i),path:["branchName"]})}}}),eb=(0,P.mN)({resolver:(0,N.u)(ey),mode:"onSubmit",reValidateMode:"onBlur",defaultValues:{repositoryId:(null==r?void 0:r.repository.id.toString())||"",enableProductionSync:!0,branchName:"main",new_branch_per_pr:!0,supabaseDirectory:".",supabaseChangesOnly:!0,branchLimit:"50"}}),ev=eb.watch("enableProductionSync"),ej=eb.watch("new_branch_per_pr"),ew=eb.watch("repositoryId"),e_=ep.find(e=>e.id===ew),eN=async e=>{if((null==i?void 0:i.ref)&&(null==s?void 0:s.id))try{if(r){if(r.repository.id.toString()!==e.repositoryId)return void u(!0);await eS(e,r)}else{let n=ep.find(n=>n.id===e.repositoryId);if(!n)return void V.oR.error("Please select a repository");await eC(e,n)}}catch(e){console.error("Error managing connection:",e)}},eC=async(e,n)=>{(null==i?void 0:i.ref)&&(null==s?void 0:s.id)&&(ec({organizationId:s.id,connection:{installation_id:n.installation_id,project_ref:i.ref,repository_id:Number(n.id),workdir:e.supabaseDirectory,supabase_changes_only:e.supabaseChangesOnly,branch_limit:Number(e.branchLimit),new_branch_per_pr:e.new_branch_per_pr}}),ef?D({branchRef:ef.project_ref,projectRef:i.ref,gitBranch:e.branchName}):$({projectRef:i.ref,branchName:"main",gitBranch:e.branchName,is_default:!0}))},eS=async(e,n)=>{if(!(null==i?void 0:i.ref)||!(null==s?void 0:s.id))return;let t=null==ef?void 0:ef.git_branch;if(t&&e.branchName!==t&&e.enableProductionSync)return void l(!0);await eI(e,n)},eI=async(e,n)=>{(null==i?void 0:i.ref)&&(null==s?void 0:s.id)&&(eh({connectionId:n.id,organizationId:s.id,connection:{workdir:e.supabaseDirectory,supabase_changes_only:e.supabaseChangesOnly,branch_limit:Number(e.branchLimit),new_branch_per_pr:e.new_branch_per_pr}}),ef&&D({branchRef:ef.project_ref,projectRef:i.ref,gitBranch:e.enableProductionSync?e.branchName:"",branchName:e.branchName||"main"}),l(!1))},ek=async()=>{r&&await eI(eb.getValues(),r)},eP=async()=>{if(r&&(null==s?void 0:s.id))try{await eu({organizationId:s.id,connectionId:r.id}),eb.reset({repositoryId:"",enableProductionSync:!0,branchName:"main",new_branch_per_pr:!0,supabaseDirectory:".",supabaseChangesOnly:!0,branchLimit:"50"})}catch(e){console.error("Error removing integration:",e),V.oR.error("Failed to remove integration")}},eV=async()=>{let e=eb.getValues(),n=ep.find(n=>n.id===e.repositoryId);if(n&&r&&(null==s?void 0:s.id))try{await eu({organizationId:s.id,connectionId:r.id}),await eC(e,n),u(!1)}catch(e){console.error("Error changing repository:",e),V.oR.error("Failed to change repository")}};if((0,p.useEffect)(()=>{if(r){var e;let n=!!(null==ef||null==(e=ef.git_branch)?void 0:e.trim());eb.reset({repositoryId:r.repository.id.toString(),enableProductionSync:n,branchName:(null==ef?void 0:ef.git_branch)||"main",new_branch_per_pr:r.new_branch_per_pr,supabaseDirectory:r.workdir||"",supabaseChangesOnly:r.supabase_changes_only,branchLimit:String(r.branch_limit)})}},[r,ef,eb]),(0,p.useEffect)(()=>{ev?ev&&!eb.getValues().branchName&&eb.setValue("branchName","main"):eb.setValue("branchName","")},[ev,eb]),null===b)return(0,a.jsx)(W.Zp,{children:(0,a.jsxs)(W.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,a.jsx)("p",{className:"text-sm text-center",children:"Authorize with GitHub"}),(0,a.jsx)("p",{className:"text-sm text-center text-foreground-light mb-4",children:"Connect your GitHub account to access and select repositories for integration."}),(0,a.jsx)(X.$,{onClick:()=>{(0,Y.Fd)("authorize",B)},children:"Authorize GitHub"})]})});let eF=ed||ex||em;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ee.lV,{...eb,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsx)("form",{onSubmit:eb.handleSubmit(eN),className:(0,w.cn)(!g&&"opacity-25 pointer-events-none"),children:(0,a.jsxs)(W.Zp,{"data-sentry-element":"Card","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:[(0,a.jsx)(W.Wu,{className:"space-y-6","data-sentry-element":"CardContent","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsx)(ee.zB,{control:eb.control,name:"repositoryId",render:e=>{let{field:n}=e;return(0,a.jsx)(es.M,{layout:"flex-row-reverse",label:"GitHub Repository",description:r?"Change the connected repository":"Select the repository to connect to your project",children:(0,a.jsxs)(en.AM,{open:m,onOpenChange:h,children:[(0,a.jsx)(en.Wv,{asChild:!0,children:(0,a.jsx)(ee.MJ,{children:(0,a.jsx)(X.$,{type:"default",className:"justify-start h-[34px] w-full",disabled:E,loading:E,icon:(0,a.jsx)("div",{className:"bg-black shadow rounded p-1 w-6 h-6 flex justify-center items-center",children:eo}),iconRight:(0,a.jsx)("span",{className:"grow flex justify-end",children:(0,a.jsx)(C.A,{})}),children:e_||r?(null==e_?void 0:e_.name)||(null==r?void 0:r.repository.name):"Choose GitHub Repository"})})}),(0,a.jsx)(en.hl,{portal:!0,className:"p-0 w-80",side:"bottom",align:"start",children:(0,a.jsxs)(et.uB,{children:[(0,a.jsx)(et.G7,{placeholder:"Search repositories..."}),(0,a.jsxs)(et.oI,{className:"!max-h-[200px]",children:[(0,a.jsx)(et.xL,{children:"No repositories found."}),ep.length>0?(0,a.jsx)(et.L$,{children:ep.map((e,t)=>(0,a.jsxs)(et.h_,{value:"".concat(e.name.replaceAll('"',""),"-").concat(t),className:"flex gap-2 items-center",onSelect:()=>{n.onChange(e.id),h(!1),eb.setValue("branchName",e.default_branch||"main")},children:[(0,a.jsx)("div",{className:"bg-black shadow rounded p-1 w-5 h-5 flex justify-center items-center",children:eo}),(0,a.jsx)("span",{className:"truncate",title:e.name,children:e.name})]},e.id))}):null,(0,a.jsx)(et.L$,{children:(0,a.jsxs)(et.h_,{className:"flex gap-2 items-center cursor-pointer",onSelect:()=>(0,Y.Fd)("install",B),children:[(0,a.jsx)(S.A,{size:16}),"Add GitHub Repositories"]})}),eg&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(et.fx,{}),(0,a.jsx)(et.L$,{children:(0,a.jsxs)(et.h_,{className:"flex gap-2 items-start cursor-pointer",onSelect:()=>{(0,Y.Fd)("authorize",B)},children:[(0,a.jsx)(I.A,{size:16,className:"mt-0.5 shrink-0"}),(0,a.jsx)("div",{className:"text-xs text-foreground-light",children:"Re-authorize GitHub with SSO to show all repositories"})]})})]})]})]})})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"})}),(0,a.jsx)(W.Wu,{className:(0,w.cn)(!ew&&"opacity-25 pointer-events-none"),"data-sentry-element":"CardContent","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsx)(ee.zB,{control:eb.control,name:"supabaseDirectory",render:e=>{let{field:n}=e;return(0,a.jsx)(es.M,{layout:"flex-row-reverse",label:"Supabase directory",description:"Relative path to your supabase folder",children:(0,a.jsx)(ee.MJ,{children:(0,a.jsx)(ea.p,{...n,placeholder:"supabase",autoComplete:"off",disabled:t||!f})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"})}),(0,a.jsx)(W.Wu,{className:(0,w.cn)(!ew&&"opacity-25 pointer-events-none"),"data-sentry-element":"CardContent","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(ee.zB,{control:eb.control,name:"enableProductionSync",render:e=>{let{field:n}=e;return(0,a.jsx)(es.M,{layout:"flex-row-reverse",label:"Deploy to production",description:"Deploy changes to production on push including PR merges",children:(0,a.jsx)(ee.MJ,{children:(0,a.jsx)(er.d,{checked:n.value,onCheckedChange:n.onChange,disabled:t||!f})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"}),(0,a.jsx)("div",{className:(0,w.cn)("space-y-4 pl-6 border-l",(!ev||t)&&"opacity-25 pointer-events-none"),children:(0,a.jsx)(ee.zB,{control:eb.control,name:"branchName",render:e=>{let{field:n}=e;return(0,a.jsx)(es.M,{layout:"flex-row-reverse",label:"Production branch name",description:"The GitHub branch to sync with your production database (e.g., main, master)",children:(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)(ee.MJ,{children:(0,a.jsx)(ea.p,{...n,autoComplete:"off",disabled:t||!f||!ev})}),(0,a.jsx)("div",{className:"absolute top-2.5 right-3 flex items-center gap-2",children:el&&(0,a.jsx)(k.A,{size:14,className:"animate-spin"})})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"})})]})}),(0,a.jsx)(W.Wu,{className:(0,w.cn)(!ew&&"opacity-25 pointer-events-none"),"data-sentry-element":"CardContent","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(ee.zB,{control:eb.control,name:"new_branch_per_pr",render:e=>{let{field:n}=e;return(0,a.jsx)(es.M,{layout:"flex-row-reverse",label:"Automatic branching",description:"Create preview branches for every pull request",children:(0,a.jsx)(ee.MJ,{children:(0,a.jsx)(er.d,{checked:n.value,onCheckedChange:n.onChange,disabled:t||!y})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"}),(0,a.jsxs)("div",{className:(0,w.cn)("space-y-4 pl-6 border-l",(!ej||t)&&"opacity-25 pointer-events-none"),children:[(0,a.jsx)(ee.zB,{control:eb.control,name:"branchLimit",render:e=>{let{field:n}=e;return(0,a.jsx)(es.M,{layout:"flex-row-reverse",label:"Branch limit",description:"Maximum number of preview branches",children:(0,a.jsx)(ee.MJ,{children:(0,a.jsx)(ea.p,{...n,type:"number",autoComplete:"off",disabled:!ej||t||!f})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"}),(0,a.jsx)(ee.zB,{control:eb.control,name:"supabaseChangesOnly",render:e=>{let{field:n}=e;return(0,a.jsx)(es.M,{layout:"flex-row-reverse",label:"Supabase changes only",description:"Only create branches when Supabase files change",children:(0,a.jsx)(ee.MJ,{children:(0,a.jsx)(er.d,{checked:n.value,onCheckedChange:e=>n.onChange(e),disabled:!ej||t||!f})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"})]})]})}),(0,a.jsxs)(W.wL,{className:"flex justify-between items-center","data-sentry-element":"CardFooter","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:[(0,a.jsx)("div",{children:r&&(0,a.jsx)(X.$,{type:"outline",onClick:eP,disabled:t||em,loading:em,children:"Disable integration"})}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[eb.formState.isDirty&&(0,a.jsx)(X.$,{type:"default",onClick:()=>{eb.reset()},disabled:t||!f,children:"Cancel"}),(0,a.jsx)(X.$,{type:"primary",htmlType:"submit",disabled:t||!r&&!y||r&&!f||el||eF||!r&&!eb.getValues().repositoryId||r&&!eb.formState.isDirty,loading:el||eF,"data-sentry-element":"Button","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:r?"Save changes":"Enable integration"})]})]})]})})}),(0,a.jsx)(ei.A,{variant:"warning",visible:o,title:"Changing production git branch",confirmLabel:"Confirm",size:"medium",onCancel:()=>l(!1),onConfirm:ek,loading:ex,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Open pull requests will only update your Supabase project on merge if the git base branch matches this new production git branch."})}),(0,a.jsx)(ei.A,{variant:"warning",visible:c,title:"Changing GitHub repository",confirmLabel:"Change repository",size:"medium",onCancel:()=>u(!1),onConfirm:eV,loading:eF,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"This will disconnect your current repository and create a new connection with the selected repository. All existing Supabase branches that are connected to the old repository will no longer be synced."})})})]})},ec=e=>{let{title:n}=e;return(0,a.jsx)("img",{className:"border rounded-lg shadow w-full sm:w-48 mt-6 border-body",src:"".concat(u.o2,"/img/integrations/covers/").concat(n,"-cover.png"),alt:"".concat(n," cover"),"data-sentry-component":"IntegrationImageHandler","data-sentry-source-file":"GithubSection.tsx"})},ed=()=>{var e;let{ref:n}=(0,g.g)(),{data:t}=(0,j.s)(),{can:r,isLoading:i}=(0,v.Qp)(x.aG.READ,"integrations.github_connections"),s=(null==t||null==(e=t.plan)?void 0:e.id)!=="free",l=u.pe&&!s,{data:c}=(0,b.O)({organizationId:null==t?void 0:t.id},{enabled:!!n&&!!(null==t?void 0:t.id)}),d=(0,p.useMemo)(()=>null==c?void 0:c.find(e=>e.project.ref===n),[c,n]);return(0,a.jsx)(o.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"GitHubSection","data-sentry-source-file":"GithubSection.tsx",children:(0,a.jsxs)(o.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"GithubSection.tsx",children:[(0,a.jsxs)(o.xp,{title:"GitHub Integration","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"GithubSection.tsx",children:[(0,a.jsx)("p",{children:"Connect any of your GitHub repositories to a project."}),(0,a.jsx)(ec,{title:"github","data-sentry-element":"IntegrationImageHandler","data-sentry-source-file":"GithubSection.tsx"})]}),(0,a.jsx)(o.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"GithubSection.tsx",children:i?(0,a.jsx)(_.yV,{}):r?(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"text-foreground mb-2",children:"How does the GitHub integration work?"}),(0,a.jsx)("p",{className:"text-foreground-light text-sm mb-6",children:"Connecting to GitHub allows you to sync preview branches with a chosen GitHub branch, keep your production branch in sync, and automatically create preview branches for every pull request."}),l&&(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(y.A,{primaryText:"Upgrade to unlock GitHub integration",secondaryText:"Connect your GitHub repository to automatically sync preview branches and deploy changes.",source:"github-integration"})}),(0,a.jsx)("div",{className:(0,w.cn)(l&&"opacity-25 pointer-events-none"),children:(0,a.jsx)(el,{connection:d})})]})}):(0,a.jsx)(f.A,{resourceText:"view this organization's GitHub connections"})})]})})};var eu=t(60425);let em=e=>{let{title:n}=e;return(0,a.jsx)("img",{className:"border rounded-lg shadow w-full sm:w-48 mt-6 border-body",src:"".concat(u.o2,"/img/integrations/covers/").concat(n,"-cover.png"),alt:"".concat(n," cover"),"data-sentry-component":"IntegrationImageHandler","data-sentry-source-file":"IntegrationsSettings.tsx"})},eh=()=>{let{data:e}=(0,d.YA)(),{data:n}=(0,l.wT)({ref:null==e?void 0:e.parent_project_ref}),t=(null==e?void 0:e.parent_project_ref)!==void 0,r=(0,c.x)("integrations:vercel");return(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsx)(o.eh,{children:(0,a.jsxs)(m.Fc,{variant:"default",className:"mt-6",children:[(0,a.jsx)(h.id,{}),(0,a.jsx)(m.XL,{children:"You are currently on a preview branch of your project"}),(0,a.jsxs)(m.TN,{children:["To adjust your project's integration settings, you may return to your"," ",(0,a.jsx)(i(),{href:"/project/".concat(null==n?void 0:n.ref,"/settings/general"),className:"text-brand",children:"main branch"}),"."]})]})}),(0,a.jsx)(ed,{"data-sentry-element":"GitHubSection","data-sentry-source-file":"IntegrationsSettings.tsx"}),r&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.cJ,{}),(0,a.jsx)(eu.A,{isProjectScoped:!0}),(0,a.jsx)(s.A,{})]})]})}},81672:(e,n,t)=>{t.d(n,{A:()=>a});let a=(0,t(86848).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},81802:(e,n,t)=>{t.d(n,{bZ:()=>s});var a=t(56028),r=t(12532);let i=(0,a.BX)({vercelConnectionsOpen:!1,setVercelConnectionsOpen:e=>{i.vercelConnectionsOpen=e},vercelConnectionsIntegrationId:void 0,setVercelConnectionsIntegrationId:e=>{i.vercelConnectionsIntegrationId=e}}),s=e=>(0,r.s)(i,e)}}]);