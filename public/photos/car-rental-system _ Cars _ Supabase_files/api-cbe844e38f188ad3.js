try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="b74e1fb9-95ac-410a-aa0f-d2034a22d26f",e._sentryDebugIdIdentifier="sentry-dbid-b74e1fb9-95ac-410a-aa0f-d2034a22d26f")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[60398],{1374:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]])},8848:(e,t,a)=>{var s=a(35902),n=a(80544),r=Math.max;e.exports=function(e,t,a){var l=null==e?0:e.length;if(!l)return -1;var i=null==a?0:n(a);return i<0&&(i=r(l+i,0)),s(e,t,i)}},13655:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]])},16771:(e,t,a)=>{"use strict";a.d(t,{c:()=>c});var s=a(51355),n=a(80210),r=a(73969),l=a(24523),i=a(30659);async function o(e){let{projectRef:t,dbSchema:a,maxRows:s,dbExtraSearchPath:n,dbPool:r}=e,i={db_schema:a,max_rows:s,db_extra_search_path:n};r&&(i.db_pool=r);let{data:o,error:c}=await (0,l.F6)("/platform/projects/{ref}/config/postgrest",{params:{path:{ref:t}},body:i});return c&&(0,l.H4)(c),o}let c=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,s.jE)();return(0,n.n)({mutationFn:e=>o(e),async onSuccess(t,a,s){let{projectRef:n}=a;l.invalidateQueries({queryKey:i.n.postgrest(n)}),await (null==e?void 0:e(t,a,s))},async onError(e,a,s){void 0===t?r.oR.error("Failed to update Postgrest config: ".concat(e.message)):t(e,a,s)},...a})}},21416:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(80263),n=a(52555),r=a.n(n),l=a(24487),i=a(21650),o=a(99779);let c=e=>{let{name:t="",isActive:a,isExternal:n,icon:c,rightIcon:d,url:u="",target:x="_self",onClick:h,textClassName:m="",hoverText:p="",label:y}=e,f=(0,s.jsx)(l.Ay.Item,{icon:c,rounded:!0,active:a,onClick:h,children:(0,s.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,s.jsxs)("div",{title:p||("string"==typeof t?t:""),className:"flex space-between items-center gap-2 truncate w-full "+m,children:[(0,s.jsx)("span",{className:"truncate flex-1",children:t}),void 0!==y&&(0,s.jsx)(i.E,{variant:"warning",size:"tiny",children:y})]}),d&&(0,s.jsx)("div",{children:d})]})});return u?n?(0,s.jsx)(o.$,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:c,children:(0,s.jsx)(r(),{href:u,target:"_blank",rel:"noreferrer",children:t})}):(0,s.jsx)(r(),{href:u,className:"block",target:x,children:f}):f}},22730:(e,t,a)=>{"use strict";a.d(t,{z:()=>d});var s=a(78510),n=a(67850),r=a(24523),l=a(9620),i=a(85039),o=a(87727);async function c(e,t,a){let{projectRef:n,connectionString:l}=e;if(!n)throw Error("projectRef is required");let i=new Headers(a);l&&i.set("x-connection-encrypted",l);let{data:o,error:c}=await (0,r.Jt)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":l,"x-pg-application-name":s.r},path:{ref:n}},headers:i,signal:t});return c&&(0,r.H4)(c),o}let d=function(e){let{projectRef:t,connectionString:a}=e,{enabled:s=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:d}=(0,l.YA)(),u=(null==d?void 0:d.status)===i.BU.ACTIVE_HEALTHY;return(0,n.I)({queryKey:o.I.list(t),queryFn:e=>{let{signal:s}=e;return c({projectRef:t,connectionString:a},s)},enabled:s&&void 0!==t&&u,...r})}},24487:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>x});var s=a(80263),n=a(53239),r=a(7981),l=a(80100);function i(e){let{children:t,className:a,tag:n="div",style:r}=e;return(0,s.jsx)("".concat(n),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}i.Title=function(e){let{className:t,level:a=1,children:n,style:r}=e;return(0,s.jsx)("h".concat(a),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:n})},i.Text=function(e){let{className:t,children:a,style:n,type:r,disabled:l,mark:i,code:o,keyboard:c,underline:d,strikethrough:u,strong:x,small:h}=e;return o?(0,s.jsx)("code",{style:n,children:a}):i?(0,s.jsx)("mark",{style:n,children:a}):c?(0,s.jsx)("kbd",{style:n,children:a}):x?(0,s.jsx)("strong",{style:n,children:a}):(0,s.jsx)("span",{style:n,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:a})},i.Link=function(e){let{children:t,target:a="_blank",href:n,className:r,onClick:l,style:i}=e;return(0,s.jsx)("a",{onClick:l,href:n,target:a,rel:"noopener noreferrer",style:i,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})};let o=(0,n.createContext)({type:"text"}),c=e=>{let{type:t}=e;return(0,s.jsx)(o.Provider,{value:{type:t},"data-sentry-element":"MenuContext.Provider","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},d=()=>{let e=(0,n.useContext)(o);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function u(e){let{children:t,className:a,ulClassName:n,style:r,type:l="text"}=e;return(0,s.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:a,style:r,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,s.jsx)(c,{type:l,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,s.jsx)("ul",{className:n,children:t})})})}u.Item=function(e){let{children:t,icon:a,active:n,rounded:i,onClick:o,doNotCloseOverlay:c=!1,showActiveBar:u=!1,style:x}=e,h=(0,r.A)("menu"),{type:m}=d(),p=[h.item.base];p.push(h.item.variants[m].base),n?p.push(h.item.variants[m].active):p.push(h.item.variants[m].normal);let y=[h.item.content.base];n?y.push(h.item.content.active):y.push(h.item.content.normal);let f=[h.item.icon.base];return n?f.push(h.item.icon.active):f.push(h.item.icon.normal),(0,s.jsxs)("li",{role:"menuitem",className:(0,l.cn)("outline-none",p),style:x,onClick:o,"aria-current":n?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[a&&(0,s.jsx)("div",{className:"".concat(f.join(" ")," min-w-fit"),children:a}),(0,s.jsx)("span",{className:y.join(" "),children:t})]})},u.Group=function(e){let{children:t,icon:a,title:n}=e,l=(0,r.A)("menu"),{type:i}=d();return(0,s.jsxs)("div",{className:[l.group.base,l.group.variants[i]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[a&&(0,s.jsx)("span",{className:l.group.icon,children:a}),(0,s.jsx)("span",{className:l.group.content,children:n}),t]})},u.Misc=function(e){let{children:t}=e;return(0,s.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,s.jsx)(i.Text,{"data-sentry-element":"Typography.Text","data-sentry-source-file":"Menu.tsx",children:(0,s.jsx)("span",{children:t})})})};let x=u},29948:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},31626:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},35026:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eg});var s=a(80263),n=a(12123),r=a(22891),l=a(37873),i=a(34016),o=a(24318),c=a(51068),d=a(63351),u=a(9620),x=a(85039),h=a(72341),m=a(20033),p=a(78039),y=a(21650),f=a(64758),g=a(55989),j=a(16488),b=a(32981),v=a(72112),A=a(8848),w=a.n(A),N=a(11743),P=a(52555),k=a.n(P),_=a(53239),S=a(87494),I=a(73969),C=a(10663),M=a(41273),D=a(50795),E=a(94636),T=a(16771),H=a(22730),z=a(32775),q=a(80090),R=a(99779),L=a(80100),F=a(65887),B=a(72608),V=a(75878),Y=a(60793),O=a(66755),G=a(73640),K=a(27371),U=a(44725),W=a(44053),$=a(49742),J=a(23892),X=a(76174),Q=a(23729),Z=a(57125),ee=a(51355),et=a(80210),ea=a(30659),es=a(32510),en=a(24523),er=a(59356);async function el(e){let{projectRef:t,connectionString:a,existingPostgrestConfig:s}=e;await (0,er.E)({projectRef:t,connectionString:a,sql:"\ncreate schema if not exists api;\ngrant usage on schema api to anon, authenticated;\n  ".trim()});let{db_extra_search_path:n,db_pool:r,db_schema:l,max_rows:i}=s,{error:o}=await (0,en.F6)("/platform/projects/{ref}/config/postgrest",{params:{path:{ref:t}},body:{db_pool:r,max_rows:i,db_extra_search_path:n,db_schema:"api, ".concat(l)}});return o&&(0,en.H4)(o),!0}let ei=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,ee.jE)();return(0,et.n)({mutationFn:e=>el(e),async onSuccess(t,a,n){let{projectRef:r}=a;await Promise.all([s.invalidateQueries({queryKey:es.c.schemas(r)}),s.invalidateQueries({queryKey:ea.n.postgrest(r)})]),await (null==e?void 0:e(t,a,n))},async onError(e,a,s){void 0===t?I.oR.error("Failed to create and expose API schema: ".concat(e.message)):t(e,a,s)},...a})};var eo=a(95137),ec=a(95052);let ed=e=>{var t;let{visible:a,onClose:n}=e,{data:r}=(0,u.YA)(),{data:l}=(0,z.w$)({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString}),{data:i}=(0,E.y)({projectRef:null==r?void 0:r.ref}),o=(null!=l?l:[]).find(e=>"api"===e.name),c=null!=(t=null==i?void 0:i.db_schema.split(",").map(e=>e.trim()))?t:[],d=c.includes("api"),h=c.includes("public"),{mutate:p,isPending:y}=ei({onSuccess:()=>{I.oR.success("Successfully created api schema and exposed via Data API")}}),{mutate:f,isPending:g}=(0,T.c)({onSuccess:()=>{I.oR.success("Success removed public schema from exposed schemas")}});return(0,s.jsx)(eo.lG,{open:a,onOpenChange:n,"data-sentry-element":"Dialog","data-sentry-component":"HardenAPIModal","data-sentry-source-file":"HardenAPIModal.tsx",children:(0,s.jsxs)(eo.Cf,{size:"large","data-sentry-element":"DialogContent","data-sentry-source-file":"HardenAPIModal.tsx",children:[(0,s.jsxs)(eo.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"HardenAPIModal.tsx",children:[(0,s.jsx)(eo.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"HardenAPIModal.tsx",children:"Switch the default API schema"}),(0,s.jsxs)(eo.rr,{"data-sentry-element":"DialogDescription","data-sentry-source-file":"HardenAPIModal.tsx",children:["Expose a custom schema instead of the"," ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"public"})," schema"]})]}),(0,s.jsx)(eo.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"HardenAPIModal.tsx"}),(0,s.jsxs)(eo.OO,{className:"text-sm text-foreground-light","data-sentry-element":"DialogSection","data-sentry-source-file":"HardenAPIModal.tsx",children:[(0,s.jsxs)("p",{children:["By default, the ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"public"})," schema is used to generate API routes. In some cases, it's better to use a custom schema. This is important if you use tools that generate tables in the"," ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"public"})," schema to"," ",(0,s.jsx)("span",{className:"text-brand",children:"prevent accidental exposure of data"}),"."]}),(0,s.jsx)(M.A,{abbrev:!1,className:"w-min mt-4",href:"".concat(x.aq,"/guides/database/hardening-data-api"),"data-sentry-element":"DocsButton","data-sentry-source-file":"HardenAPIModal.tsx"})]}),(0,s.jsx)(eo.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"HardenAPIModal.tsx"}),(0,s.jsxs)(O.Nt,{"data-sentry-element":"Collapsible_Shadcn_","data-sentry-source-file":"HardenAPIModal.tsx",children:[(0,s.jsxs)(O.R6,{className:"py-4 px-5 w-full flex items-center justify-between text-sm","data-sentry-element":"CollapsibleTrigger_Shadcn_","data-sentry-source-file":"HardenAPIModal.tsx",children:[(0,s.jsxs)("p",{children:["1. Create a custom ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"api"})," schema and expose it"]}),o&&d?(0,s.jsx)(J.A,{size:16,className:"text-brand"}):(0,s.jsx)(X.A,{size:16,className:"transition data-open-parent:rotate-180 data-closed-parent:rotate-0"})]}),(0,s.jsxs)(O.Ke,{className:"text-sm text-foreground-light flex flex-col gap-y-4","data-sentry-element":"CollapsibleContent_Shadcn_","data-sentry-source-file":"HardenAPIModal.tsx",children:[(0,s.jsxs)("p",{className:"mx-5",children:["Click the button below to create a new schema named"," ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"api"})," and grant the"," ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"anon"})," and"," ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"authenticated"})," roles usage privileges on this schema. This schema will thereafter also be exposed to the Data API."]}),(0,s.jsx)("div",{className:"px-5",children:(0,s.jsx)(Z.A,{title:"How is the schema created?",description:(0,s.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,s.jsxs)("p",{children:["The following query will be run to create the"," ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"api"})," schema , as well as to grant the necessary privileges to the respective roles"]}),(0,s.jsx)(ec.N,{language:"sql",className:"p-1 language-bash prose dark:prose-dark max-w-[68.3ch]",children:"create schema if not exists api;\ngrant usage on schema api to anon, authenticated;"})]}),"data-sentry-element":"InformationBox","data-sentry-source-file":"HardenAPIModal.tsx"})}),(0,s.jsx)(Q.G,{type:"primary",className:"w-min mx-5",onClick:()=>void 0===r?console.error("Project is required"):void 0===i?console.error("Postgrest config is required"):void p({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString,existingPostgrestConfig:{max_rows:i.max_rows,db_pool:i.db_pool,db_schema:i.db_schema,db_extra_search_path:null==i?void 0:i.db_extra_search_path}}),disabled:o&&d,loading:y,tooltip:{content:{side:"right",text:o&&d?"Schema has already been created and exposed":void 0}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"HardenAPIModal.tsx",children:"Create and expose schema to Data API"}),(0,s.jsxs)("div",{className:"flex flex-col gap-y-4 px-5 pb-4",children:[(0,s.jsxs)("p",{children:["Under these new settings, the ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"anon"})," ","and ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"authenticated"})," roles can execute functions defined in the ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"api"})," ","schema, but they have no automatic permissions on any tables. On a table-by-table basis, you can grant them permissions by running the following command:"]}),(0,s.jsx)(ec.N,{language:"sql",className:"p-1 language-bash prose dark:prose-dark max-w-[68.3ch]","data-sentry-element":"CodeBlock","data-sentry-source-file":"HardenAPIModal.tsx",children:"grant select on table api.<your_table> to anon;\ngrant select, insert, update, delete on table api.<your_table> to authenticated;"})]})]})]}),(0,s.jsx)(eo.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"HardenAPIModal.tsx"}),(0,s.jsxs)(O.Nt,{"data-sentry-element":"Collapsible_Shadcn_","data-sentry-source-file":"HardenAPIModal.tsx",children:[(0,s.jsxs)(O.R6,{className:"py-4 px-5 w-full flex items-center justify-between text-sm","data-sentry-element":"CollapsibleTrigger_Shadcn_","data-sentry-source-file":"HardenAPIModal.tsx",children:[(0,s.jsxs)("p",{children:["2. Remove the ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"public"})," schema from the exposed schemas"]}),h?(0,s.jsx)(X.A,{size:16,className:"transition data-open-parent:rotate-180 data-closed-parent:rotate-0"}):(0,s.jsx)(J.A,{size:16,className:"text-brand"})]}),(0,s.jsx)(O.Ke,{className:"text-sm text-foreground-light","data-sentry-element":"CollapsibleContent_Shadcn_","data-sentry-source-file":"HardenAPIModal.tsx",children:(0,s.jsxs)("div",{className:"px-5 pb-4 flex flex-col gap-y-4",children:[(0,s.jsxs)(m.Fc,{variant:"warning","data-sentry-element":"Alert_Shadcn_","data-sentry-source-file":"HardenAPIModal.tsx",children:[(0,s.jsx)(Y.id,{"data-sentry-element":"WarningIcon","data-sentry-source-file":"HardenAPIModal.tsx"}),(0,s.jsxs)(m.XL,{className:"text-foreground","data-sentry-element":"AlertTitle_Shadcn_","data-sentry-source-file":"HardenAPIModal.tsx",children:["Ensure that your app is no longer using the"," ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"public"})," schema"]}),(0,s.jsxs)(m.TN,{"data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"HardenAPIModal.tsx",children:["The ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"public"})," schema will not be accessible via the API once its not exposed. You should be using the"," ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"api"})," schema instead."]})]}),(0,s.jsxs)("p",{children:["Click the button below to remove the"," ",(0,s.jsx)("code",{className:"text-xs text-foreground",children:"public"})," schema from both Exposed schemas and Extra search path in your API configuration."]}),(0,s.jsx)(Q.G,{type:"primary",className:"w-min",disabled:!h,loading:g,tooltip:{content:{side:"right",text:h?void 0:"Public schema no longer exposed"}},onClick:()=>{if(void 0===r)return console.error("Project is required");if(void 0===i)return console.error("Postgrest config is required");let e=i.db_extra_search_path.split(",").map(e=>e.trim()).filter(e=>"public"!==e).join(", "),t=i.db_schema.split(",").map(e=>e.trim()).filter(e=>"public"!==e).join(", ");f({projectRef:r.ref,maxRows:i.max_rows,dbPool:i.db_pool,dbSchema:t,dbExtraSearchPath:e})},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"HardenAPIModal.tsx",children:"Remove public schema from exposed schemas"})]})})]})]})})},eu=C.Ik({dbSchema:C.YO(C.Yj()),dbExtraSearchPath:C.YO(C.Yj()),maxRows:C.ai().max(1e6,"Can't be more than 1,000,000"),dbPool:C.ai().min(0,"Must be more than 0").max(1e3,"Can't be more than 1000").optional().nullable(),enableDataApi:C.zM()}).refine(e=>!e.enableDataApi||0!==e.dbSchema.length,{message:"Must have at least one schema if Data API is enabled",path:["dbSchema"]}),ex=()=>{var e,t,a;let{ref:n}=(0,r.g)(),{data:l}=(0,u.YA)(),[i,o]=(0,_.useState)(!1),{data:c,isError:d,isLoading:h}=(0,E.y)({projectRef:n}),{data:y}=(0,H.z)({projectRef:null==l?void 0:l.ref,connectionString:null==l?void 0:l.connectionString}),{data:f=[],isLoading:g,isSuccess:A}=(0,z.w$)({projectRef:null==l?void 0:l.ref,connectionString:null==l?void 0:l.connectionString}),P=h||g,{mutate:C,isPending:J}=(0,T.c)({onSuccess:()=>{I.oR.success("Successfully saved settings")}}),X="project-postgres-config",Q=["auth","pgbouncer","hooks","extensions"],{can:Z,isSuccess:ee}=(0,q.Qp)(v.aG.UPDATE,"custom_config_postgrest"),et=(null==(e=(null!=y?y:[]).find(e=>"pg_graphql"===e.name))?void 0:e.installed_version)!==null,ea=(null==c?void 0:c.db_schema)?null==c?void 0:c.db_schema.replace(/ /g,"").split(","):[],es={dbSchema:ea,maxRows:null==c?void 0:c.max_rows,dbExtraSearchPath:(null!=(t=null==c?void 0:c.db_extra_search_path)?t:"").split(",").map(e=>e.trim()).filter(e=>e.length>0&&f.find(t=>t.name===e)),dbPool:null==c?void 0:c.db_pool},en=(0,S.mN)({resolver:(0,b.u)(eu),mode:"onChange",defaultValues:es}),er=null!=(a=f.filter(e=>{if(0>w()(Q,e.name))return e}).map(e=>({id:e.id,value:e.name,name:e.name,disabled:!1})))?a:[];function el(){let e=null!=c&&!!c.db_schema;en.reset({...es,enableDataApi:e})}let ei=async e=>{if(!n)return console.error("Project ref is required");C({projectRef:n,dbSchema:e.dbSchema.join(", "),maxRows:e.maxRows,dbExtraSearchPath:e.dbExtraSearchPath.join(","),dbPool:e.dbPool?e.dbPool:null})};(0,_.useEffect)(()=>{c&&A&&el()},[c,A]);let eo=en.getValues("enableDataApi");return(0,s.jsxs)(p.Zp,{id:"postgrest-config","data-sentry-element":"Card","data-sentry-component":"PostgrestConfig","data-sentry-source-file":"PostgrestConfig.tsx",children:[(0,s.jsxs)(p.aR,{className:"flex-row items-center justify-between","data-sentry-element":"CardHeader","data-sentry-source-file":"PostgrestConfig.tsx",children:["Data API Settings",(0,s.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,s.jsx)(M.A,{href:"".concat(x.aq,"/guides/database/connecting-to-postgres#data-apis"),"data-sentry-element":"DocsButton","data-sentry-source-file":"PostgrestConfig.tsx"}),(0,s.jsx)(R.$,{type:"default",icon:(0,s.jsx)(N.A,{}),onClick:()=>o(!0),"data-sentry-element":"Button","data-sentry-source-file":"PostgrestConfig.tsx",children:"Harden Data API"})]})]}),(0,s.jsx)(p.Wu,{className:(0,L.cn)(P?"":"p-0"),"data-sentry-element":"CardContent","data-sentry-source-file":"PostgrestConfig.tsx",children:(0,s.jsx)(F.lV,{...en,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"PostgrestConfig.tsx",children:(0,s.jsx)("form",{id:X,onSubmit:en.handleSubmit(ei),children:P?(0,s.jsx)(j.yV,{}):d?(0,s.jsx)(U.Z,{type:"destructive",title:"Failed to retrieve API settings"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(F.zB,{control:en.control,name:"enableDataApi",render:e=>{let{field:t}=e;return(0,s.jsxs)(F.eI,{className:"w-full",children:[(0,s.jsx)(W.M,{className:"w-full px-8 py-8",layout:"flex",label:"Enable Data API",description:"When enabled you will be able to use any Supabase client library and PostgREST endpoints with any schema configured below.",children:(0,s.jsx)(F.MJ,{children:(0,s.jsx)(B.d,{size:"large",disabled:!Z,checked:t.value,onCheckedChange:e=>{t.onChange(e),e?(en.setValue("enableDataApi",!0),en.setValue("dbSchema",ea)):(en.setValue("enableDataApi",!1),en.setValue("dbSchema",[]))}})})}),!t.value&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(V.w,{}),(0,s.jsxs)(m.Fc,{variant:"warning",className:"mb-0 border-none rounded-none",children:[(0,s.jsx)(Y.id,{className:"!left-[2rem]"}),(0,s.jsx)(m.XL,{className:"!pl-[3.5rem] !left-[6rem]",children:"No schemas can be queried"}),(0,s.jsxs)(m.TN,{className:"!pl-[3.5rem]",children:[(0,s.jsx)("p",{children:"With this setting disabled, you will not be able to query any schemas via the Data API."}),(0,s.jsxs)("p",{children:["You will see errors from the Postgrest endpoint",(0,s.jsx)("code",{className:"text-xs",children:"/rest/v1/"}),"."]})]})]})]})]})}}),(0,s.jsx)(O.Nt,{open:en.getValues("enableDataApi"),children:(0,s.jsxs)(O.Ke,{className:"border-t divide-y transition-all data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down",children:[(0,s.jsx)(F.zB,{control:en.control,name:"dbSchema",render:e=>{let{field:t}=e;return(0,s.jsx)(F.eI,{className:"w-full",children:(0,s.jsxs)(W.M,{label:"Exposed schemas",description:"The schemas to expose in your API. Tables, views and stored procedures in these schemas will get API endpoints.",layout:"horizontal",className:"px-8 py-8",children:[g?(0,s.jsx)("div",{className:"col-span-12 flex flex-col gap-2 lg:col-span-7",children:(0,s.jsx)(G.E,{className:"w-full h-[38px]"})}):(0,s.jsxs)($.xf,{onValuesChange:t.onChange,values:t.value,size:"small",disabled:!Z||!eo,children:[(0,s.jsx)($.hw,{mode:"inline-combobox",label:"Select schemas for Data API...",badgeLimit:"wrap",showIcon:!1,deletableBadge:!0}),(0,s.jsx)($.sD,{children:(0,s.jsx)($.DG,{children:er.length<=0?(0,s.jsx)($.Oe,{value:"no",children:"no"},"empty"):er.map(e=>(0,s.jsx)($.Oe,{value:e.name,children:e.name},e.id+"-"+e.name))})})]}),!t.value.includes("public")&&t.value.length>0&&(0,s.jsx)(U.Z,{type:"default",title:"The public schema for this project is not exposed",className:"mt-2",description:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"prose text-sm",children:["You will not be able to query tables and views in the"," ",(0,s.jsx)("code",{className:"text-xs",children:"public"})," schema via supabase-js or HTTP clients."]}),et&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("p",{className:"prose text-sm mt-2",children:["Tables in the ",(0,s.jsx)("code",{className:"text-xs",children:"public"})," ","schema are still exposed over our GraphQL endpoints."]}),(0,s.jsx)(R.$,{asChild:!0,type:"default",className:"mt-2",children:(0,s.jsx)(k(),{href:"/project/".concat(n,"/database/extensions"),children:"Disable the pg_graphql extension"})})]})]})})]})})}}),(0,s.jsx)(F.zB,{control:en.control,name:"dbExtraSearchPath",render:e=>{let{field:t}=e;return(0,s.jsx)(F.eI,{className:"w-full",children:(0,s.jsx)(W.M,{className:"w-full px-8 py-8",layout:"horizontal",label:"Extra search path",description:"Extra schemas to add to the search path of every request.",children:g?(0,s.jsx)("div",{className:"col-span-12 flex flex-col gap-2 lg:col-span-7",children:(0,s.jsx)(G.E,{className:"w-full h-[38px]"})}):(0,s.jsxs)($.xf,{onValuesChange:t.onChange,values:t.value,size:"small",disabled:!Z||!eo,children:[(0,s.jsx)($.hw,{mode:"inline-combobox",label:"Select schemas to add to search path...",badgeLimit:"wrap",showIcon:!1,deletableBadge:!0}),(0,s.jsx)($.sD,{children:(0,s.jsx)($.DG,{children:f.length<=0?(0,s.jsx)($.Oe,{value:"no",children:"no"},"empty"):f.map(e=>(0,s.jsx)($.Oe,{value:e.name,children:e.name},e.id+"-"+e.name))})})]})})})}}),(0,s.jsx)(F.zB,{control:en.control,name:"maxRows",render:e=>{let{field:t}=e;return(0,s.jsx)(F.eI,{className:"w-full",children:(0,s.jsx)(W.M,{className:"w-full px-8 py-8",layout:"horizontal",label:"Max rows",description:"The maximum number of rows returned from a view, table, or stored procedure. Limits payload size for accidental or malicious requests.",children:(0,s.jsx)(F.MJ,{children:(0,s.jsx)(K.p,{size:"small",disabled:!Z||!eo,...t,type:"number",...en.register("maxRows",{valueAsNumber:!0})})})})})}}),(0,s.jsx)(F.zB,{control:en.control,name:"dbPool",render:e=>{let{field:t}=e;return(0,s.jsx)(F.eI,{className:"w-full",children:(0,s.jsx)(W.M,{className:"w-full px-8 py-8",layout:"horizontal",label:"Pool size",description:"Number of maximum connections to keep open in the Data API server's database pool. Unset to let it be configured automatically based on compute size.",children:(0,s.jsx)(F.MJ,{children:(0,s.jsx)(K.p,{size:"small",disabled:!Z||!eo,...t,type:"number",placeholder:"Configured automatically based on compute size",onChange:e=>t.onChange(""===e.target.value?null:Number(e.target.value)),value:null===t.value?"":t.value})})})})}})]})})]})})})}),(0,s.jsx)(p.wL,{"data-sentry-element":"CardFooter","data-sentry-source-file":"PostgrestConfig.tsx",children:(0,s.jsx)(D.I,{form:X,isSubmitting:J,hasChanges:en.formState.isDirty,handleReset:el,disabled:!Z,helper:ee&&!Z?"You need additional permissions to update your project's API settings":void 0,"data-sentry-element":"FormActions","data-sentry-source-file":"PostgrestConfig.tsx"})}),(0,s.jsx)(ed,{visible:i,onClose:()=>o(!1),"data-sentry-element":"HardenAPIModal","data-sentry-source-file":"PostgrestConfig.tsx"})]})},eh=()=>{var e,t;let{data:a,isLoading:b}=(0,u.YA)(),{ref:v}=(0,r.g)(),A=(0,h.RE)(),{data:w}=(0,o.A)({projectRef:v}),{data:N,isError:P,isLoading:k}=(0,d.Vh)({projectRef:v}),{data:_}=(0,c.z)({projectRef:v}),S=(null==w||null==(e=w.customDomain)?void 0:e.status)==="active",I=null==N?void 0:N.find(e=>e.identifier===A.selectedDatabaseId),C="load-balancer"===A.selectedDatabaseId,M=(null==I?void 0:I.identifier)!==v,D=S&&A.selectedDatabaseId===v?"https://".concat(w.customDomain.hostname):C?null!=(t=null==_?void 0:_[0].endpoint)?t:"":null==I?void 0:I.restUrl;return(0,s.jsx)(l.gu,{isFullWidth:!0,id:"api-settings",className:"gap-6","data-sentry-element":"ScaffoldSection","data-sentry-component":"ServiceList","data-sentry-source-file":"ServiceList.tsx",children:b||(null==a?void 0:a.status)===x.BU.ACTIVE_HEALTHY?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(p.Zp,{children:[(0,s.jsxs)(p.aR,{className:"flex flex-row items-center justify-between",children:["Project URL",(0,s.jsx)(i.A,{additionalOptions:(null!=_?_:[]).length>0?[{id:"load-balancer",name:"API Load Balancer"}]:[]})]}),(0,s.jsx)(p.Wu,{children:b||k?(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(j.Ay,{className:"py-3.5"}),(0,s.jsx)(j.Ay,{className:"py-3.5 w-3/4",delayIndex:1})]}):P?(0,s.jsxs)(m.Fc,{variant:"destructive",children:[(0,s.jsx)(n.A,{size:16}),(0,s.jsx)(m.XL,{children:"Failed to retrieve project URL"})]}):(0,s.jsx)(g.H,{layout:"horizontal",label:S?(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("p",{children:"URL"}),(0,s.jsx)(y.E,{children:"Custom domain active"})]}):"URL",description:C?"RESTful endpoint for querying and managing your databases through your load balancer":M?"RESTful endpoint for querying your read replica":"RESTful endpoint for querying and managing your database",children:(0,s.jsx)(f.p,{copy:!0,readOnly:!0,className:"font-mono",value:D})})})]}),(0,s.jsx)(ex,{})]}):(0,s.jsxs)(m.Fc,{variant:"destructive",children:[(0,s.jsx)(n.A,{size:16}),(0,s.jsx)(m.XL,{children:"API settings are unavailable as the project is not active"})]})})};var em=a(10508),ep=a(8750),ey=a(43479);let ef=()=>(0,s.jsx)(l.eh,{bottomPadding:!0,"data-sentry-element":"ScaffoldContainer","data-sentry-component":"ApiSettings","data-sentry-source-file":"api.tsx",children:(0,s.jsx)(eh,{"data-sentry-element":"ServiceList","data-sentry-source-file":"api.tsx"})});ef.getLayout=e=>(0,s.jsx)(em.A,{children:(0,s.jsx)(ey.A,{title:"API Settings",children:(0,s.jsx)(ep.M,{title:"API Settings",children:e})})});let eg=ef},43479:(e,t,a)=>{"use strict";a.d(t,{A:()=>h});var s=a(80263),n=a(80814),r=a(22891),l=a(93873),i=a(2657),o=a(84512),c=a(9620),d=a(9497),u=a(29471),x=a(25433);let h=(0,d.r)(e=>{let{title:t,children:a}=e,d=(0,n.useRouter)(),{ref:h}=(0,r.g)(),{data:m}=(0,c.YA)(),{data:p}=(0,o.s)(),y=d.pathname.includes("billing")?d.pathname.split("/")[5]:d.pathname.split("/")[4],{projectAuthAll:f,authenticationShowProviders:g,projectEdgeFunctionAll:j,projectStorageAll:b,billingInvoices:v,projectSettingsLegacyJwtKeys:A,projectSettingsLogDrains:w,billingAll:N}=(0,i.x)(["project_auth:all","authentication:show_providers","project_edge_function:all","project_storage:all","billing:invoices","project_settings:legacy_jwt_keys","project_settings:log_drains","billing:all"]),P=(0,x.M)(h,m,p,{auth:f,authProviders:g,edgeFunctions:j,storage:b,invoices:v,legacyJwtKeys:A,logDrains:w,billing:N});return(0,s.jsx)(u.k,{isBlocking:!1,title:t||"Settings",product:"Settings",productMenu:(0,s.jsx)(l.l,{page:y,menu:P}),"data-sentry-element":"ProjectLayout","data-sentry-component":"SettingsLayout","data-sentry-source-file":"SettingsLayout.tsx",children:a})})},50642:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/settings/api",function(){return a(35026)}])},50795:(e,t,a)=>{"use strict";a.d(t,{I:()=>r});var s=a(80263),n=a(99779);let r=e=>{let{form:t,hasChanges:a,handleReset:r,helper:l,disabled:i=!1,isSubmitting:o,submitText:c="Save"}=e,d=o||i||!a&&void 0!==a;return(0,s.jsxs)("div",{className:["flex w-full items-center gap-2",l?"justify-between":"justify-end"].join(" "),"data-sentry-component":"FormActions","data-sentry-source-file":"FormActions.tsx",children:[l&&(0,s.jsx)("span",{className:"text-sm text-foreground-lighter",children:l}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n.$,{disabled:d,type:"default",htmlType:"reset",onClick:()=>r(),"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:"Cancel"}),(0,s.jsx)(n.$,{form:t,type:"primary",htmlType:"submit",disabled:d,loading:o,"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:c})]})]})}},51068:(e,t,a)=>{"use strict";a.d(t,{z:()=>o});var s=a(67850),n=a(24523),r=a(85039),l=a(49467);async function i(e,t){let{projectRef:a}=e;if(!a)throw Error("Project ref is required");let{data:s,error:r}=await (0,n.Jt)("/platform/projects/{ref}/load-balancers",{params:{path:{ref:a}},signal:t});return r&&(0,n.H4)(r),s}let o=function(e){let{projectRef:t}=e,{enabled:a=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)({queryKey:l.p.loadBalancers(t),queryFn:e=>{let{signal:a}=e;return i({projectRef:t},a)},enabled:a&&void 0!==t&&r.pe,...n})}},53407:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]])},54831:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]])},57125:(e,t,a)=>{"use strict";a.d(t,{A:()=>x});var s=a(80263),n=a(98103),r=a(61113),l=a(86510),i=a(52555),o=a.n(i),c=a(53239),d=a(99779);let u=(0,c.forwardRef)((e,t)=>{let{icon:a,title:i,description:u,url:x,urlLabel:h="Read more",defaultVisibility:m=!1,hideCollapse:p=!1,button:y,className:f="",block:g=!1}=e,[j,b]=(0,c.useState)(m);return(0,s.jsx)("div",{ref:t,role:"alert",className:"".concat(g?"block w-full":"","\n      block w-full rounded-md border bg-surface-300/25 py-3 ").concat(f),children:(0,s.jsxs)("div",{className:"flex flex-col px-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex w-full space-x-3 items-center",children:[a&&(0,s.jsx)("span",{className:"text-foreground-lighter",children:a}),(0,s.jsx)("div",{className:"flex-grow",children:(0,s.jsx)("h5",{className:"text-foreground",children:i})})]}),u&&!p?(0,s.jsx)("div",{className:"cursor-pointer text-foreground-lighter",onClick:()=>b(!j),children:j?(0,s.jsx)(n.A,{size:14,strokeWidth:1.5}):(0,s.jsx)(r.A,{size:14,strokeWidth:1.5})}):null]}),(u||x||y)&&(0,s.jsxs)("div",{className:"flex flex-col space-y-3 overflow-hidden transition-all ".concat(j?"mt-3":""),style:{maxHeight:500*!!j},children:[(0,s.jsx)("div",{className:"text-foreground-light text-sm",children:u}),x&&(0,s.jsx)("div",{children:(0,s.jsx)(d.$,{asChild:!0,type:"default",icon:(0,s.jsx)(l.A,{}),children:(0,s.jsx)(o(),{href:x,target:"_blank",rel:"noreferrer",children:h})})}),y&&(0,s.jsx)("div",{children:y})]})]})})});u.displayName="InformationBox";let x=u},66959:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("DatabaseZap",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 15 21.84",key:"14ibmq"}],["path",{d:"M21 5V8",key:"1marbg"}],["path",{d:"M21 12L18 17H22L19 22",key:"zafso"}],["path",{d:"M3 12A9 3 0 0 0 14.59 14.87",key:"1y4wr8"}]])},69988:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]])},74195:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]])},74310:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},77444:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},93873:(e,t,a)=>{"use strict";a.d(t,{l:()=>i});var s=a(80263),n=a(24487),r=a(21650),l=a(21416);let i=e=>{let{page:t,menu:a}=e;return(0,s.jsx)("div",{className:"flex flex-col space-y-8","data-sentry-component":"ProductMenu","data-sentry-source-file":"index.tsx",children:(0,s.jsx)(n.Ay,{type:"pills","data-sentry-element":"Menu","data-sentry-source-file":"index.tsx",children:a.map((e,i)=>(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"my-6 space-y-8",children:(0,s.jsxs)("div",{className:"mx-3",children:[(0,s.jsx)(n.Ay.Group,{title:e.title?(0,s.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,s.jsx)("span",{children:e.title}),e.isPreview&&(0,s.jsx)(r.E,{variant:"warning",children:"Not production ready"})]}):null}),(0,s.jsx)("div",{children:e.items.map(e=>{let a=e.pages?e.pages.includes(null!=t?t:""):t===e.key;return(0,s.jsx)(l.A,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:a,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key)})})]})}),i!==a.length-1&&(0,s.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},98103:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]])},99940:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(86848).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])}},e=>{e.O(0,[60858,15599,16110,27764,36538,44033,76984,72391,35035,40545,596,10508,48340,75187,29471,8750,90636,46593,38792],()=>e(e.s=50642)),_N_E=e.O()}]);