try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="8294f5a6-8ee0-430b-9b6a-826426802bab",e._sentryDebugIdIdentifier="sentry-dbid-8294f5a6-8ee0-430b-9b6a-826426802bab")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[33024],{23074:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eK});var a=s(80263),r=s(86510),n=s(72112),l=s(22891),i=s(85372),o=s(78039),d=s(78511),c=s(75878),u=s(27695),y=s(51355),x=s(23169),p=s(93901),m=s(53239),h=s(73969),f=s(27371),g=s(27519),j=s(67850),b=s(24523),A=s(93284);async function I(e,t){let{projectRef:s,id:a,reveal:r}=e;if(void 0===s)throw Error("projectRef is required");if(void 0===a)throw Error("Content ID is required");let{data:n,error:l}=await (0,b.Jt)("/v1/projects/{ref}/api-keys/{id}",{params:{path:{ref:s,id:a},query:{reveal:r}},signal:t});return l&&(0,b.H4)(l),n}let v=function(e){let{projectRef:t,id:s,reveal:a}=e,{enabled:r=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,j.I)({queryKey:A.f.single(t,s),queryFn:e=>{let{signal:r}=e;return I({projectRef:t,id:s,reveal:a},r)},enabled:r&&void 0!==t&&void 0!==s,...n})};var w=s(80090),k=s(80100),P=s(30404),N=s(99779);function K(e){let{apiKey:t}=e,s=(0,y.jE)(),{ref:r}=(0,l.g)(),[i,o]=(0,m.useState)(!1),d="secret"===t.type,{can:c,isLoading:u}=(0,w.Qp)(n.aG.READ,"service_api_keys"),{data:j,error:b,isLoading:I,refetch:K}=v({projectRef:r,id:t.id,reveal:!0},{enabled:i,staleTime:0,cacheTime:0});async function C(){(!d||c)&&(u||o(!i))}async function D(){var e,a;if(null==j?void 0:j.api_key)return null!=(e=null==j?void 0:j.api_key)?e:"";try{let e=await K();if(s.removeQueries({queryKey:A.f.single(r,t.id),exact:!0}),e.isSuccess)return null!=(a=e.data.api_key)?a:"";if(b)return h.oR.error("Failed to copy secret API key"),""}catch(e){return console.error("Failed to fetch API key:",e),""}return t.api_key}(0,m.useEffect)(()=>{if(i&&(null==j?void 0:j.api_key)){let e=setTimeout(()=>{o(!1),s.removeQueries({queryKey:A.f.single(r,t.id),exact:!0})},1e4);return()=>clearTimeout(e)}},[i,null==j?void 0:j.api_key,r,s,t.id]);let S=d&&!c;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:(0,k.cn)((0,f.L)({size:"tiny"}),"w-[100px] sm:w-[140px] md:w-[180px] lg:w-[340px] gap-0 font-mono rounded-full",d?"overflow-hidden":"",i?"ring-1 ring-foreground-lighter ring-opacity-50":"ring-0 ring-opacity-0","transition-all cursor-text relative"),style:{userSelect:"all"},children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{children:null==t?void 0:t.api_key.slice(0,15)}),(0,a.jsx)("span",{children:i&&(null==j?void 0:j.api_key)?null==j?void 0:j.api_key.slice(15):"••••••••••••••••"})]}):(0,a.jsx)("span",{children:null==t?void 0:t.api_key})}),d&&(0,a.jsxs)(P.m_,{children:[(0,a.jsx)(P.k$,{asChild:!0,children:(0,a.jsx)(N.$,{type:"outline",className:"rounded-full px-2 pointer-events-auto",loading:i&&I,icon:i?(0,a.jsx)(x.A,{strokeWidth:2}):(0,a.jsx)(p.A,{strokeWidth:2}),onClick:C,disabled:S})}),(0,a.jsx)(P.ZI,{side:"bottom",children:S?"You need additional permissions to reveal secret API keys":u?"Loading permissions...":i?"Hide API key":"Reveal API key"})]}),(0,a.jsxs)(P.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"ApiKeyPill.tsx",children:[(0,a.jsx)(P.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"ApiKeyPill.tsx",children:(0,a.jsx)(g.A,{type:"default",asyncText:D,iconOnly:!0,className:"rounded-full px-2 pointer-events-auto",disabled:S||u,"data-sentry-element":"CopyButton","data-sentry-source-file":"ApiKeyPill.tsx"})}),(0,a.jsx)(P.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"ApiKeyPill.tsx",children:S?"You need additional permissions to copy secret API keys":u?"Loading permissions...":"Copy API key"})]})]})}var C=s(80210);async function D(e){if(!e.projectRef)throw Error("projectRef is required");let{data:t,error:s}=await (0,b.bE)("/v1/projects/{ref}/api-keys",{params:{path:{ref:e.projectRef},query:{reveal:!1}},body:{..."secret"===e.type?{secret_jwt_template:{role:"service_role"}}:name,type:e.type,name:e.name,description:e.description||null}});return s&&(0,b.H4)(s),t}let S=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,y.jE)();return(0,C.n)({mutationFn:e=>D(e),async onSuccess(t,s,r){let{projectRef:n}=s;await a.invalidateQueries({queryKey:A.f.list(n)}),await (null==e?void 0:e(t,s,r))},async onError(e,s,a){void 0===t?h.oR.error("Failed to create API key: ".concat(e.message)):t(e,s,a)},...s})};var _=s(22806);let T=()=>{let{ref:e}=(0,l.g)(),[t,s]=(0,m.useState)(!1),[r,n]=(0,m.useState)(!1),{mutate:i}=S(),o=async()=>{if(e){n(!0);try{await i({projectRef:e,type:"publishable",name:"default"}),await i({projectRef:e,type:"secret",name:"default"}),s(!1)}catch(e){console.error("Failed to create API keys:",e)}finally{n(!1)}}};return(0,a.jsxs)(_.Lt,{open:t,onOpenChange:s,"data-sentry-element":"AlertDialog","data-sentry-component":"CreateNewAPIKeysButton","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:[(0,a.jsx)(N.$,{onClick:()=>s(!0),"data-sentry-element":"Button","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:"Create new API keys"}),(0,a.jsxs)(_.EO,{"data-sentry-element":"AlertDialogContent","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:[(0,a.jsxs)(_.wd,{"data-sentry-element":"AlertDialogHeader","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:[(0,a.jsx)(_.r7,{"data-sentry-element":"AlertDialogTitle","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:"Create new API keys"}),(0,a.jsxs)(_.$v,{"data-sentry-element":"AlertDialogDescription","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:["This will create a default publishable key and a default secret key named"," ",(0,a.jsx)("code",{children:"default"}),". These keys are required to connect your application to your Supabase project."]})]}),(0,a.jsxs)(_.ck,{"data-sentry-element":"AlertDialogFooter","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:[(0,a.jsx)(_.Zr,{"data-sentry-element":"AlertDialogCancel","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:"Cancel"}),(0,a.jsx)(_.Rx,{onClick:o,disabled:r,"data-sentry-element":"AlertDialogAction","data-sentry-source-file":"CreateNewAPIKeysButton.tsx",children:r?"Creating...":"Create keys"})]})]})]})};var R=s(25580);let E=[{id:"mock-id-2",type:"publishable",api_key:"sb_publishable_ltaNA7nnVozoSCOcZIjg",name:"web"},{id:"mock-id-3",type:"publishable",api_key:"sb_publishable_YpotEpinEWsC2dI7FIKI",name:"mobile"},{id:"mock-id-1",type:"secret",api_key:"sb_secret_8I4Se•••••••••••••",name:"backend_api"}],F=()=>(0,a.jsx)(o.Zp,{className:"w-full overflow-hidden opacity-60 pointer-events-none bg-surface-100","data-sentry-element":"Card","data-sentry-component":"ApiKeysTableIllustration","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:(0,a.jsx)(o.Wu,{className:"p-0","data-sentry-element":"CardContent","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:(0,a.jsxs)(d.XI,{className:"p-5","data-sentry-element":"Table","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:[(0,a.jsx)(d.A0,{"data-sentry-element":"TableHeader","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:(0,a.jsxs)(d.Hj,{className:"bg-200","data-sentry-element":"TableRow","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:[(0,a.jsx)(d.nd,{className:"text-left font-mono uppercase text-xs text-foreground-lighter h-auto py-2 overflow-hidden w-[180px]","data-sentry-element":"TableHead","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:"Name"},""),(0,a.jsx)(d.nd,{className:"text-left font-mono uppercase text-xs text-foreground-lighter h-auto py-2 pr-0","data-sentry-element":"TableHead","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:"API Key"}),(0,a.jsx)(d.nd,{className:"text-right font-mono uppercase text-xs text-foreground-lighter h-auto py-2","data-sentry-element":"TableHead","data-sentry-source-file":"ApiKeysIllustrations.tsx"},"actions")]})}),(0,a.jsx)(d.BF,{"data-sentry-element":"TableBody","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:E.map(e=>(0,a.jsxs)(d.Hj,{children:[(0,a.jsx)(d.nA,{className:"py-2 w-[180px]",children:e.name}),(0,a.jsx)(d.nA,{className:"py-2",children:(0,a.jsx)("div",{className:"flex flex-row gap-2",children:(0,a.jsx)(K,{apiKey:e})})}),(0,a.jsx)(d.nA,{})]},e.id))})]})})}),B=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"absolute inset-x-0 bottom-0 h-1/2 xl:h-full xl:inset-x-auto xl:-right-16 xl:top-3 w-full xl:w-2/3 bg-gradient-to-t xl:bg-gradient-to-l from-background-alternative via-background-alternative/90 via-[5%] to-transparent z-[3] pointer-events-none xl:max-w-[500px]"}),(0,a.jsx)("div",{className:"absolute scale-100 left-10 -bottom-14 w-[720px] xl:w-[500px] xl:left-auto xl:-right-[200px] 2xl:-right-16 xl:top-[21px] xl:scale-75",children:(0,a.jsx)(F,{"data-sentry-element":"ApiKeysTableIllustration","data-sentry-source-file":"ApiKeysIllustrations.tsx"})})]}),L=()=>{let{canInitApiKeys:e}=(0,R.u)();return e?(0,a.jsx)(i.T,{illustration:(0,a.jsx)(B,{}),bgAlt:!0,"data-sentry-element":"FeatureBanner","data-sentry-component":"ApiKeysCreateCallout","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:(0,a.jsxs)("div",{className:"flex flex-col gap-0 z-[2]",children:[(0,a.jsx)("p",{className:"text-sm text-foreground",children:"Create API keys"}),(0,a.jsx)("p",{className:"text-sm text-foreground-lighter lg:max-w-sm 2xl:max-w-none",children:"Use keys to authenticate requests to your app"}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(T,{"data-sentry-element":"CreateNewAPIKeysButton","data-sentry-source-file":"ApiKeysIllustrations.tsx"})})]})}):null},M=()=>{let{hasApiKeys:e}=(0,R.u)();return e?(0,a.jsxs)(i.T,{storageKey:l.rS.API_KEYS_FEEDBACK_DISMISSED,className:"!p-0 flex flex-col gap-0",dismissable:!0,"data-sentry-element":"FeatureBanner","data-sentry-component":"ApiKeysFeedbackBanner","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:[(0,a.jsxs)("div",{className:"p-5",children:[(0,a.jsx)("p",{className:"text-sm text-foreground",children:"Your new API keys are here"}),(0,a.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["We've updated our API keys to better support your application needs."," ",(0,a.jsxs)("a",{href:"https://github.com/orgs/supabase/discussions/29260",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1 text-foreground",children:["Join the discussion on GitHub ",(0,a.jsx)(r.A,{size:14,strokeWidth:1.5,"data-sentry-element":"ExternalLink","data-sentry-source-file":"ApiKeysIllustrations.tsx"})]})]})]}),(0,a.jsx)(c.w,{className:"w-full","data-sentry-element":"Separator","data-sentry-source-file":"ApiKeysIllustrations.tsx"}),(0,a.jsx)("div",{className:"px-5 py-2 bg-surface-200/30",children:(0,a.jsxs)("p",{className:"text-sm text-foreground-lighter",children:["Having trouble with the new API keys?"," ",(0,a.jsx)(u.Y,{className:"underline",queryParams:{category:n.S.PROBLEM,subject:"Help with API keys",message:"I'm experiencing problems with the new API keys feature. Please describe your specific issue here."},"data-sentry-element":"SupportLink","data-sentry-source-file":"ApiKeysIllustrations.tsx",children:"Contact support"})]})})]}):null};var H=s(91205),q=s(76750),z=s(60793),O=s(73640);let Y=()=>{let{ref:e}=(0,l.g)(),{canReadAPIKeys:t,isLoading:s}=(0,R.u)(),{data:r,isLoading:n,error:i}=(0,q.I)({projectRef:e,reveal:!1},{enabled:t}),o=(0,m.useMemo)(()=>{var e;return null!=(e=null==r?void 0:r.filter(e=>{let{type:t}=e;return"publishable"===t}))?e:[]},[r])[0];return(0,a.jsxs)("div",{"data-sentry-component":"PublishableAPIKeys","data-sentry-source-file":"PublishableAPIKeys.tsx",children:[(0,a.jsx)(H.M,{title:"Publishable key",description:"This key is safe to use in a browser if you have enabled Row Level Security (RLS) for your tables and configured policies.","data-sentry-element":"FormHeader","data-sentry-source-file":"PublishableAPIKeys.tsx"}),(0,a.jsx)("div",{className:"flex flex-col gap-8",children:(0,a.jsxs)("div",{className:"-space-y-px w-full lg:w-content lg:w-fit",children:[(0,a.jsxs)("div",{className:"bg-surface-100 px-5 py-2 flex items-center gap-5 first:rounded-t-md border",children:[(0,a.jsx)("span",{className:"text-sm",children:"Publishable key"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)($,{"data-sentry-element":"ApiKeyInput","data-sentry-source-file":"PublishableAPIKeys.tsx"}),(0,a.jsxs)(P.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"PublishableAPIKeys.tsx",children:[(0,a.jsx)(P.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"PublishableAPIKeys.tsx",children:(0,a.jsx)(g.A,{iconOnly:!0,size:"tiny",type:"default",className:"px-2 rounded-full",disabled:s||n||!t,text:null==o?void 0:o.api_key,"data-sentry-element":"CopyButton","data-sentry-source-file":"PublishableAPIKeys.tsx"})}),(0,a.jsx)(P.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"PublishableAPIKeys.tsx",children:t?n?"Loading permissions...":"Copy publishable key":"You need additional permissions to copy publishable keys"})]})]})]}),i&&t?(0,a.jsx)("div",{className:"text-xs bg-warning-200 last:rounded-b-md border border-warning-400 px-5 text-foreground-lighter py-1",children:(0,a.jsxs)("div",{className:"text-warning",children:["Failed to load publishable key: ",null==i?void 0:i.message]})}):(0,a.jsx)("div",{className:"text-xs bg-200 last:rounded-b-md border px-5 text-foreground-lighter py-1",children:"The publishable key can be safely shared publicly"})]})})]})},$=()=>{let{ref:e}=(0,l.g)(),{canReadAPIKeys:t,isLoading:s}=(0,R.u)(),{data:r,isLoading:n,error:i}=(0,q.I)({projectRef:e,reveal:!1},{enabled:t}),o=(0,m.useMemo)(()=>{var e;return null!=(e=null==r?void 0:r.filter(e=>{let{type:t}=e;return"publishable"===t}))?e:[]},[r])[0],d="flex-1 grow gap-1 rounded-full min-w-0 max-w-[200px] sm:max-w-[300px] md:max-w-[400px] lg:min-w-[24rem]",c="tiny";return t||s?n||s?(0,a.jsx)("div",{className:(0,k.cn)((0,f.L)({size:c}),d,"items-center"),children:(0,a.jsx)(O.E,{className:"h-2 w-48 rounded-full bg-foreground-muted"})}):i?(0,a.jsxs)("div",{className:(0,k.cn)((0,f.L)({size:c}),d,"items-center gap-2 font-normal"),children:[(0,a.jsx)(z.id,{}),"Failed to load publishable key"]}):(0,a.jsx)(f.p,{size:c,className:(0,k.cn)(d,"font-mono"),value:null==o?void 0:o.api_key,"data-sentry-element":"Input_Shadcn_","data-sentry-component":"ApiKeyInput","data-sentry-source-file":"PublishableAPIKeys.tsx"},null==o?void 0:o.id):(0,a.jsxs)("div",{className:(0,k.cn)((0,f.L)({size:c}),d,"items-center gap-2 font-normal"),children:[(0,a.jsx)(z.aR,{}),"You do not have permission to read API Key"]})};var U=s(53434),W=s.n(U),Z=s(44168);async function Q(e){if(!e.projectRef)throw Error("projectRef is required");let{data:t,error:s}=await (0,b.yH)("/v1/projects/{ref}/api-keys/{id}",{params:{path:{ref:e.projectRef,id:e.id},query:{reveal:!1}}});return s&&(0,b.H4)(s),t}let V=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,y.jE)();return(0,C.n)({mutationFn:e=>Q(e),async onSuccess(t,s,r){let{projectRef:n}=s;await a.invalidateQueries({queryKey:A.f.list(n)}),await (null==e?void 0:e(t,s,r))},async onError(e,s,a){void 0===t?h.oR.error("Failed to delete API key: ".concat(e.message)):t(e,s,a)},...s})};var G=s(68224),X=s(46087),J=s(16488),ee=s(97507),et=s(77444),es=s(21162),ea=s(94335),er=s(91313),en=s(13916);let el=e=>{let{apiKey:t,setKeyToDelete:s}=e,{can:r}=(0,w.Qp)(n.aG.TENANT_SQL_ADMIN_WRITE,"*");return(0,a.jsxs)(en.x,{className:"flex gap-2",onClick:()=>{r&&s(t.id)},disabled:!r,tooltip:{content:{side:"left",text:r?void 0:"You need additional permissions to delete API keys"}},"data-sentry-element":"DropdownMenuItemTooltip","data-sentry-component":"APIKeyDeleteDialog","data-sentry-source-file":"APIKeyDeleteDialog.tsx",children:[(0,a.jsx)(er.A,{size:14,strokeWidth:1.5,"data-sentry-element":"Trash2","data-sentry-source-file":"APIKeyDeleteDialog.tsx"})," Delete API key"]})},ei=e=>{var t;let{apiKey:s,lastSeen:r,isDeleting:n,onDelete:l,setKeyToDelete:i,isDeleteModalOpen:o}=e,c=ee.P.create(d.Hj);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(c,{layout:!0,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{type:"spring",stiffness:500,damping:50,mass:1},"data-sentry-element":"MotionTableRow","data-sentry-source-file":"APIKeyRow.tsx",children:[(0,a.jsx)(d.nA,{className:"py-2","data-sentry-element":"TableCell","data-sentry-source-file":"APIKeyRow.tsx",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-medium",children:s.name}),(0,a.jsx)("div",{className:"text-sm text-foreground-lighter",children:s.description||(0,a.jsx)("span",{className:"text-foreground-muted",children:"No description"})})]})}),(0,a.jsx)(d.nA,{className:"py-2","data-sentry-element":"TableCell","data-sentry-source-file":"APIKeyRow.tsx",children:(0,a.jsx)("div",{className:"flex flex-row gap-2",children:(0,a.jsx)(K,{apiKey:s,"data-sentry-element":"ApiKeyPill","data-sentry-source-file":"APIKeyRow.tsx"})})}),(0,a.jsx)(d.nA,{className:"py-2 min-w-0 whitespace-nowrap hidden lg:table-cell","data-sentry-element":"TableCell","data-sentry-source-file":"APIKeyRow.tsx",children:(0,a.jsx)("div",{className:"truncate",title:(null==r?void 0:r.timestamp)||"Never used",children:null!=(t=null==r?void 0:r.timestamp)?t:(0,a.jsx)("span",{className:"text-foreground-lighter",children:"Never used"})})}),(0,a.jsx)(d.nA,{className:"py-2","data-sentry-element":"TableCell","data-sentry-source-file":"APIKeyRow.tsx",children:(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)(es.rI,{"data-sentry-element":"DropdownMenu","data-sentry-source-file":"APIKeyRow.tsx",children:[(0,a.jsx)(es.ty,{className:"px-1 focus-visible:outline-none",asChild:!0,"data-sentry-element":"DropdownMenuTrigger","data-sentry-source-file":"APIKeyRow.tsx",children:(0,a.jsx)(N.$,{type:"text",size:"tiny",icon:(0,a.jsx)(et.A,{size:"14",className:"text-foreground-light hover:text-foreground"}),"data-sentry-element":"Button","data-sentry-source-file":"APIKeyRow.tsx"})}),(0,a.jsx)(es.SQ,{className:"max-w-40",align:"end","data-sentry-element":"DropdownMenuContent","data-sentry-source-file":"APIKeyRow.tsx",children:(0,a.jsx)(el,{apiKey:s,setKeyToDelete:i,"data-sentry-element":"APIKeyDeleteDialog","data-sentry-source-file":"APIKeyRow.tsx"})})]})})})]}),(0,a.jsx)(ea.A,{visible:o,onCancel:()=>i(null),onConfirm:l,title:"Delete ".concat(s.type," API key: ").concat(s.name),confirmString:s.name,confirmLabel:"Yes, irreversibly delete this API key",confirmPlaceholder:"Type the name of the API key to confirm",loading:n,variant:"destructive",alert:{title:"This cannot be undone",description:r?"This API key was used ".concat(r.timestamp,". Make sure all backend components using it have been updated. Deletion will cause them to receive HTTP 401 Unauthorized status codes on all Supabase APIs."):"This API key has not been used in the past 24 hours. Make sure you've updated all backend components using it before deletion."},"data-sentry-element":"TextConfirmModal","data-sentry-source-file":"APIKeyRow.tsx"})]})};var eo=s(32981),ed=s(23850),ec=s(87494),eu=s(95137),ey=s(65887),ex=s(20033),ep=s(44053),em=s(10663),eh=s(90376);let ef=(0,s(86848).A)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),eg=em.Yj().min(4,"Name must be at least 4 characters").max(64,"Name can't be more than 64 characters long").regex(/^[a-z0-9_]+$/,"Name can only contain lowercased letters, digits and underscore").refine(e=>!e.match(/^[0-9].+$/),"Name must not start with a digit").refine(e=>"anon"!==e&&"service_role"!==e,'Using "anon" or "service_role" for API key name is not possible'),ej="create-secret-api-key",eb=em.Ik({name:eg,description:em.Yj().max(256,"Description shouldn't be too long").trim()}),eA=()=>{let{ref:e}=(0,l.g)(),[t,s]=(0,ed.ZA)("new",ed.cr.withDefault(!1).withOptions({history:"push",clearOnDefault:!0})),r=e=>{s(e)},n=(0,ec.mN)({resolver:(0,eo.u)(eb),defaultValues:{name:"",description:""}}),{mutate:i,isPending:o}=S(),d=async t=>{i({projectRef:e,type:"secret",name:t.name,description:t.description},{onSuccess:e=>{h.oR.success("Your secret API key ".concat(e.prefix,"... is ready.")),r(!1)}})};return(0,a.jsxs)(eu.lG,{open:t,onOpenChange:r,"data-sentry-element":"Dialog","data-sentry-component":"CreateSecretAPIKeyDialog","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:[(0,a.jsx)(eu.zM,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:(0,a.jsx)(N.$,{type:"default",className:"mt-2",icon:(0,a.jsx)(eh.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:"New secret key"})}),(0,a.jsxs)(eu.Cf,{"data-sentry-element":"DialogContent","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:[(0,a.jsxs)(eu.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:[(0,a.jsx)(eu.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:"Create new secret API key"}),(0,a.jsx)(eu.rr,{className:"grid gap-y-2","data-sentry-element":"DialogDescription","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:(0,a.jsx)("p",{children:"Secret API keys allow elevated access to your project's data, bypassing Row-Level security."})})]}),(0,a.jsx)(eu.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx"}),(0,a.jsxs)(eu.OO,{className:"flex flex-col gap-4","data-sentry-element":"DialogSection","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:[(0,a.jsx)(ey.lV,{...n,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:(0,a.jsxs)("form",{className:"flex flex-col gap-4",id:ej,onSubmit:n.handleSubmit(d),children:[(0,a.jsx)(ey.zB,{name:"name",control:n.control,render:e=>{let{field:t}=e;return(0,a.jsx)(ep.M,{label:"Name",description:"A short, unique name of lowercased letters, digits and underscore",children:(0,a.jsx)(ey.MJ,{children:(0,a.jsx)(f.p,{...t,placeholder:"Example: my_super_secret_key_123"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx"},"name"),(0,a.jsx)(ey.zB,{name:"description",control:n.control,render:e=>{let{field:t}=e;return(0,a.jsx)(ep.M,{label:"Description",labelOptional:"Optional",children:(0,a.jsx)(ey.MJ,{children:(0,a.jsx)(f.p,{...t,placeholder:"Short notes on how or where this key will be used"})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx"},"description")]})}),(0,a.jsxs)(ex.Fc,{variant:"warning","data-sentry-element":"Alert_Shadcn_","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:[(0,a.jsx)(ef,{"data-sentry-element":"ShieldCheck","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx"}),(0,a.jsx)(ex.XL,{"data-sentry-element":"AlertTitle_Shadcn_","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:"Securing your API key"}),(0,a.jsx)(ex.TN,{className:"","data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:(0,a.jsxs)("ul",{className:"list-disc",children:[(0,a.jsx)("li",{children:"Keep this key secret."}),(0,a.jsx)("li",{children:"Do not use on the web, in mobile or desktop apps."}),(0,a.jsx)("li",{children:"Don't post it publicly or commit in source control."}),(0,a.jsx)("li",{children:"This key provides elevated access to your data, bypassing Row-Level Security."}),(0,a.jsx)("li",{children:"If it leaks or is revealed, swap it with a new secret API key and then delete it."}),(0,a.jsx)("li",{children:"If used in a browser, it will always return HTTP 401 Unauthorized. Delete immediately."})]})})]})]}),(0,a.jsx)(eu.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:(0,a.jsx)(N.$,{form:ej,htmlType:"submit",loading:o,"data-sentry-element":"Button","data-sentry-source-file":"CreateSecretAPIKeyDialog.tsx",children:"Create API key"})})]})]})},eI=()=>{let{ref:e}=(0,l.g)(),{canReadAPIKeys:t,isLoading:s}=(0,R.u)(),{data:r,error:n,isLoading:i,isError:c}=(0,q.I)({projectRef:e,reveal:!1},{enabled:t}),u=function(e){let t=(0,m.useRef)(new Date).current,s=(0,G.A)(e,{iso_timestamp_start:new Date(t.getTime()-864e5).toISOString(),iso_timestamp_end:t.toISOString(),sql:"-- last-used-secret-api-keys\nSELECT unix_millis(max(timestamp)) as timestamp, apikey.`hash` FROM edge_logs cross join unnest(metadata) as m cross join unnest(m.request) as request cross join unnest(request.sb) as sb cross join unnest(sb.apikey) as sbapikey cross join unnest(sbapikey.apikey) as apikey WHERE apikey.error is null and apikey.`hash` is not null and apikey.prefix like 'sb_secret_%' GROUP BY apikey.`hash`"});return(0,m.useMemo)(()=>{if(s.isLoading||!s.logData)return{};let e=W()();return s.logData.reduce((t,s)=>(t[s.hash]={timestamp:"".concat(W().duration(e.diff(W()(s.timestamp))).humanize(!1)," ago")},t),{})},[s])}(null!=e?e:""),y=(0,m.useMemo)(()=>{var e;return null!=(e=null==r?void 0:r.filter(e=>"secret"===e.type))?e:[]},[r]),x=(null==y?void 0:y.length)===0&&!i&&!s,p=(0,m.useRef)(null),{setValue:f,value:g}=(0,X.s)({urlKey:"delete",select:e=>e?null==y?void 0:y.find(t=>t.id===e):void 0,enabled:!!(null==y?void 0:y.length),onError:(e,t)=>(0,X.$)(p,t,"API Key not found")}),{mutate:j,isPending:b}=V({onSuccess:()=>{h.oR.success("Successfully deleted API key"),f(null)},onError:()=>{p.current=null}});return(0,a.jsxs)("div",{className:"pb-30","data-sentry-component":"SecretAPIKeys","data-sentry-source-file":"SecretAPIKeys.tsx",children:[(0,a.jsx)(H.M,{title:"Secret keys",description:"These API keys allow privileged access to your project's APIs. Use in servers, functions, workers or other backend components of your application.",actions:(0,a.jsx)(eA,{}),"data-sentry-element":"FormHeader","data-sentry-source-file":"SecretAPIKeys.tsx"}),t||s?i||s?(0,a.jsx)(J.yV,{}):c?(0,a.jsx)(Z.A,{error:n,subject:"Failed to load secret API keys"}):x?(0,a.jsx)(o.Zp,{children:(0,a.jsxs)("div",{className:"!rounded-b-md overflow-hidden py-12 flex flex-col gap-1 items-center justify-center",children:[(0,a.jsx)("p",{className:"text-sm text-foreground",children:"No secret API keys found"}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Your project is not accessible via secret keys—there are no active secret keys created."})]})}):(0,a.jsx)(o.Zp,{className:"bg-surface-100",children:(0,a.jsxs)(d.XI,{children:[(0,a.jsx)(d.A0,{children:(0,a.jsxs)(d.Hj,{className:"bg-200",children:[(0,a.jsx)(d.nd,{children:"Name"}),(0,a.jsx)(d.nd,{children:"API Key"}),(0,a.jsx)(d.nd,{className:"hidden lg:table-cell",children:"Last Seen"}),(0,a.jsx)(d.nd,{})]})}),(0,a.jsx)(d.BF,{children:y.map(t=>(0,a.jsx)(ei,{apiKey:t,lastSeen:u[t.hash],isDeleting:(null==g?void 0:g.id)===t.id&&b,onDelete:()=>(t=>e?t.id?void(p.current=t.id,j({projectRef:e,id:t.id})):console.error("API key ID is required"):console.error("Project ref is required"))(t),setKeyToDelete:f,isDeleteModalOpen:(null==g?void 0:g.id)===t.id},t.id))})]})}):(0,a.jsx)(o.Zp,{children:(0,a.jsxs)("div",{className:"!rounded-b-md overflow-hidden py-12 flex flex-col gap-1 items-center justify-center",children:[(0,a.jsx)(z.aR,{}),(0,a.jsx)("p",{className:"text-sm text-foreground",children:"You do not have permission to read API Secret Keys"}),(0,a.jsx)("p",{className:"text-foreground-light",children:"Contact your organization owner/admin to request access."})]})})]})};var ev=s(26750),ew=s(10508),ek=s(43479);let eP=(0,m.forwardRef)((e,t)=>{let{disabled:s,style:r,className:n,...l}=e;return(0,a.jsx)("div",{ref:t,...l,className:(0,k.cn)(s&&"opacity-50 pointer-events-none",n),style:{...s&&{userSelect:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none"},...r}})});eP.displayName="DisableInteraction";let eN=()=>{let{shouldDisableUI:e,canInitApiKeys:t}=(0,R.u)();return(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsx)(L,{}),(0,a.jsx)(M,{"data-sentry-element":"ApiKeysFeedbackBanner","data-sentry-source-file":"new.tsx"}),(0,a.jsxs)(eP,{disabled:e,className:"flex flex-col gap-8","data-sentry-element":"DisableInteraction","data-sentry-source-file":"new.tsx",children:[(0,a.jsx)(Y,{"data-sentry-element":"PublishableAPIKeys","data-sentry-source-file":"new.tsx"}),(0,a.jsx)(c.w,{"data-sentry-element":"Separator","data-sentry-source-file":"new.tsx"}),(0,a.jsx)(eI,{"data-sentry-element":"SecretAPIKeys","data-sentry-source-file":"new.tsx"})]})]})};eN.getLayout=e=>(0,a.jsx)(ew.A,{children:(0,a.jsx)(ek.A,{children:(0,a.jsx)(ev.A,{children:e})})});let eK=eN},46087:(e,t,s)=>{"use strict";s.d(t,{$:()=>i,s:()=>l});var a=s(53239),r=s(23850),n=s(73969);function l(e){let{enabled:t,urlKey:s,select:n,onError:l}=e,[i,o]=(0,r.ZA)(s,r.tU.withOptions({history:"push",clearOnDefault:!0})),d=(0,a.useMemo)(()=>i?n(i):void 0,[i,n]);return(0,a.useEffect)(()=>{t&&i&&!d&&(l(Error("not found"),i),o(null))},[t,l,i,o,d]),{value:d,setValue:o}}let i=(e,t,s)=>{t!==e.current?n.oR.error(s):e.current=null}},85353:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/settings/api-keys/new",function(){return s(23074)}])},85372:(e,t,s)=>{"use strict";s.d(t,{T:()=>c});var a=s(80263),r=s(68152),n=s(97507),l=s(10741),i=s(28202),o=s(80100),d=s(99779);let c=e=>{let{storageKey:t,children:s,className:c,dismissClassName:u,defaultDismissed:y=!1,illustration:x,dismissable:p=!1,bgAlt:m=!1,...h}=e,{ref:f}=(0,l.g)(),g=t&&"function"==typeof t?t(null!=f?f:""):t,[j,b]=(0,i.U)(g||"feature-banner-dismissed",y);return p&&t&&j?null:(0,a.jsxs)(n.P.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:500,damping:30,mass:1},...h,className:(0,o.cn)("pb-36 pt-10 relative w-full border xl:py-10 px-10 rounded-md overflow-hidden",m&&"bg-background-alternative",c),"data-sentry-element":"motion.div","data-sentry-component":"FeatureBanner","data-sentry-source-file":"FeatureBanner.tsx",children:[s,x,p&&t&&(0,a.jsx)("div",{className:(0,o.cn)("absolute top-3 right-3",u),children:(0,a.jsx)(d.$,{type:"text",size:"tiny",icon:(0,a.jsx)(r.A,{size:16,strokeWidth:1.5}),onClick:()=>b(!0),className:"opacity-75 px-1","aria-label":"Dismiss notification"})})]})}},91205:(e,t,s)=>{"use strict";s.d(t,{M:()=>l});var a=s(80263),r=s(80100),n=s(41273);let l=e=>{let{title:t,description:s,docsUrl:l,actions:i,className:o}=e;return(0,a.jsxs)("div",{className:(0,r.cn)("w-full mb-6 flex flex-col sm:flex-row md:items-center justify-between gap-4 ".concat(o)),"data-sentry-component":"FormHeader","data-sentry-source-file":"FormHeader.tsx",children:[(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("h3",{className:"text-foreground text-xl prose",children:t}),s&&(0,a.jsx)("p",{className:"prose text-sm max-w-2xl",children:s})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row md:items-center gap-x-2",children:[void 0!==l&&(0,a.jsx)(n.A,{href:l}),i]})]})}}},e=>{e.O(0,[60858,15599,16110,27764,36538,44033,76984,72391,35035,40545,596,10508,48340,75187,29471,8750,72544,90636,46593,38792],()=>e(e.s=85353)),_N_E=e.O()}]);