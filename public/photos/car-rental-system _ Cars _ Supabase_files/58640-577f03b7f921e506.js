try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="52739920-9256-4fd7-8f92-ee4c4f14a10f",e._sentryDebugIdIdentifier="sentry-dbid-52739920-9256-4fd7-8f92-ee4c4f14a10f")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[58640],{3897:(e,t,n)=>{n.d(t,{A:()=>a});let a=(0,n(86848).A)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]])},5448:(e,t,n)=>{n.d(t,{A:()=>a});let a=(0,n(86848).A)("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]])},7652:(e,t,n)=>{n.d(t,{AF:()=>d,GS:()=>l,J6:()=>r,UC:()=>c,Yx:()=>i,jU:()=>o});var a=n(85039),s=n(28750);let r=/^(?:[0-9a-f]{1,8}|[0-9a-f]{8}-|[0-9a-f]{8}-[0-9a-f]{1,4}|[0-9a-f]{8}-[0-9a-f]{4}-|[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{0,3}|[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-|[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{0,3}|[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-|[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{0,12})$/i,i=/^[+]?[0-9]{0,15}$/,o="px-5 py-5",l=20,c=s.S5.map(e=>({name:e.title,value:"key"in e?e.key:e.title.toLowerCase(),icon:"".concat(a.o2,"/img/icons/").concat(e.misc.iconKey,".svg"),iconClass:"GitHub"===e.title?"dark:invert":""})).concat(s.ns.properties.SMS_PROVIDER.enum.map(e=>({name:e.label,value:e.value,icon:"".concat(a.o2,"/img/icons/").concat(e.icon),iconClass:""}))),d=[{id:"img",name:"",minWidth:95,width:95,resizable:!1},{id:"id",name:"UID",width:280},{id:"name",name:"Display name",minWidth:0,width:150},{id:"email",name:"Email",width:300},{id:"phone",name:"Phone"},{id:"providers",name:"Providers",minWidth:150},{id:"provider_type",name:"Provider type",minWidth:150},{id:"created_at",name:"Created at",width:260},{id:"last_sign_in_at",name:"Last sign in at",width:260}]},27983:(e,t,n)=>{n.d(t,{i:()=>l});var a=n(80263),s=n(22891),r=n(73969),i=n(52520),o=n(68421);let l=e=>{var t,n;let{visible:l,selectedUser:c,onClose:d,onDeleteSuccess:u}=e,{ref:m}=(0,s.g)(),{mutate:f,isPending:x}=(0,i.X)({onSuccess:()=>{r.oR.success("Successfully deleted ".concat(null==c?void 0:c.email)),null==u||u()}}),h=async()=>m?(null==c?void 0:c.id)===void 0?r.oR.error("Failed to delete user: User ID not found"):void f({projectRef:m,userId:c.id}):console.error("Project ref is required");return(0,a.jsx)(o.A,{visible:l,variant:"destructive",title:"Confirm to delete user",loading:x,confirmLabel:"Delete",onCancel:()=>d(),onConfirm:()=>h(),alert:{title:"Deleting a user is irreversible",description:"This will remove the selected the user from the project and all associated data."},"data-sentry-element":"ConfirmationModal","data-sentry-component":"DeleteUserModal","data-sentry-source-file":"DeleteUserModal.tsx",children:(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["This is permanent! Are you sure you want to delete the user"," ",null!=(n=null!=(t=null==c?void 0:c.email)?t:null==c?void 0:c.phone)?n:"this user","?"]})})}},28370:(e,t,n)=>{n.d(t,{dS:()=>ec,$U:()=>el,nz:()=>eo});var a=n(80263),s=n(72112),r=n(53434),i=n.n(r),o=n(23892),l=n(93427),c=n(77869),d=n(3897),u=n(33922),m=n(68152),f=n(9753),x=n(52555),h=n.n(x),p=n(53239),v=n(73969),y=n(22891),g=n(23729),j=n(27519),b=n(37631),w=n(80210),_=n(24523);async function k(e){let{projectRef:t,userId:n}=e,{data:a,error:s}=await (0,_.yH)("/platform/auth/{ref}/users/{id}/factors",{params:{path:{ref:t,id:n}}});return s&&(0,_.H4)(s),a}let N=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.n)({mutationFn:e=>k(e),async onSuccess(t,n,a){await (null==e?void 0:e(t,n,a))},async onError(e,n,a){void 0===t?v.oR.error("Failed to delete the user's MFA factors: ".concat(e.message)):t(e,n,a)},...n})};async function A(e){let{projectRef:t,user:n}=e,{data:a,error:s}=await (0,_.bE)("/platform/auth/{ref}/recover",{params:{path:{ref:t}},body:{email:n.email}});return s&&(0,_.H4)(s),a}let S=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.n)({mutationFn:e=>A(e),async onSuccess(t,n,a){await (null==e?void 0:e(t,n,a))},async onError(e,n,a){void 0===t?v.oR.error("Failed to reset user password: ".concat(e.message)):t(e,n,a)},...n})};async function C(e){let{projectRef:t,user:n}=e,{data:a,error:s}=await (0,_.bE)("/platform/auth/{ref}/magiclink",{params:{path:{ref:t}},body:{email:n.email}});return s&&(0,_.H4)(s),a}let U=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.n)({mutationFn:e=>C(e),async onSuccess(t,n,a){await (null==e?void 0:e(t,n,a))},async onError(e,n,a){void 0===t?v.oR.error("Failed to send magic link: ".concat(e.message)):t(e,n,a)},...n})};async function M(e){let{projectRef:t,user:n}=e,{data:a,error:s}=await (0,_.bE)("/platform/auth/{ref}/otp",{params:{path:{ref:t}},body:{phone:n.phone}});return s&&(0,_.H4)(s),a}let D=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,w.n)({mutationFn:e=>M(e),async onSuccess(t,n,a){await (null==e?void 0:e(t,n,a))},async onError(e,n,a){void 0===t?v.oR.error("Failed to send magic link: ".concat(e.message)):t(e,n,a)},...n})};var O=n(51355),R=n(31907);async function E(e){let{projectRef:t,userId:n,banDuration:a}=e,{data:s,error:r}=await (0,_.F6)("/platform/auth/{ref}/users/{id}",{params:{path:{ref:t,id:n}},body:{ban_duration:"number"==typeof a?"".concat(a,"h"):a}});return r&&(0,_.H4)(r),s}let F=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,O.jE)();return(0,w.n)({mutationFn:e=>E(e),async onSuccess(t,n,s){let{projectRef:r}=n;await a.invalidateQueries({queryKey:R.Z.usersInfinite(r)}),await (null==e?void 0:e(t,n,s))},async onError(e,n,a){void 0===t?v.oR.error("Failed to update user: ".concat(e.message)):t(e,n,a)},...n})};var L=n(80090),T=n(2657),P=n(85039),I=n(6436),H=n(80100),z=n(75878),B=n(99779),W=n(44725),Y=n(68421),G=n(28750),Q=n(32981),q=n(87494),Z=n(10663),$=n(6217),V=n(65887),X=n(27371),J=n(66329),K=n(44053);let ee=e=>{let{visible:t,user:n,onClose:s}=e,{ref:r}=(0,y.g)(),{mutate:o,isPending:l}=F({onSuccess:(e,t)=>{let n=i()().add(Number(t.banDuration),"hours").format("DD MMM YYYY HH:mm (ZZ)");v.oR.success("User banned successfully until ".concat(n)),s()}}),c=Z.Ik({value:Z.Yj().min(1,{message:"Please provide a duration"}),unit:Z.k5(["hours","days"])}),d={value:"24",unit:"hours"},u=(0,q.mN)({mode:"onBlur",reValidateMode:"onChange",resolver:(0,Q.u)(c),defaultValues:d}),{value:m,unit:f}=u.watch(),x=i()().add(Number(m),f).format("DD MMM YYYY HH:mm (ZZ)");return(0,p.useEffect)(()=>{t&&u.reset(d)},[t]),(0,a.jsx)($.A,{hideFooter:!0,visible:t,size:"small",header:"Confirm to ban user",onCancel:()=>s(),"data-sentry-element":"Modal","data-sentry-component":"BanUserModal","data-sentry-source-file":"BanUserModal.tsx",children:(0,a.jsx)(V.lV,{...u,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"BanUserModal.tsx",children:(0,a.jsxs)("form",{onSubmit:u.handleSubmit(e=>{if(void 0===r)return console.error("Project ref is required");if(void 0===n.id)return v.oR.error("Failed to ban user: User ID not found");let t="hours"===e.unit?Number(e.value):24*Number(e.value);o({projectRef:r,userId:n.id,banDuration:t})}),children:[(0,a.jsxs)($.A.Content,{className:"flex flex-col gap-y-3","data-sentry-element":"Modal.Content","data-sentry-source-file":"BanUserModal.tsx",children:[(0,a.jsx)("p",{className:"text-sm",children:"This will revoke the user's access to your project and prevent them from logging in for a specified duration."}),(0,a.jsxs)("div",{className:"flex items-start gap-x-2 [&>div:first-child]:flex-grow",children:[(0,a.jsx)(V.zB,{control:u.control,name:"value",render:e=>{let{field:t}=e;return(0,a.jsx)(K.M,{className:"[&>div>div]:mt-0",label:"Set a ban duration",children:(0,a.jsx)(V.MJ,{children:(0,a.jsx)(X.p,{...t})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"BanUserModal.tsx"}),(0,a.jsx)(V.zB,{control:u.control,name:"unit",render:e=>{let{field:t}=e;return(0,a.jsx)(K.M,{className:"[&>div>div]:mt-0 mt-[33px]",children:(0,a.jsx)(V.MJ,{children:(0,a.jsxs)(J.l6,{...t,value:t.value,onValueChange:e=>u.setValue("unit",e),children:[(0,a.jsx)(J.bq,{className:"capitalize w-24",children:t.value}),(0,a.jsxs)(J.gC,{children:[(0,a.jsx)(J.eb,{value:"hours",children:"Hours"}),(0,a.jsx)(J.eb,{value:"days",children:"Days"})]})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"BanUserModal.tsx"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-foreground-lighter",children:"This user will not be able to log in until:"}),(0,a.jsx)("p",{className:(0,H.cn)("text-sm",!m&&"text-foreground-light"),children:m?x:"Invalid duration set"})]})]}),(0,a.jsx)(z.w,{"data-sentry-element":"Separator","data-sentry-source-file":"BanUserModal.tsx"}),(0,a.jsxs)($.A.Content,{className:"flex justify-end gap-2","data-sentry-element":"Modal.Content","data-sentry-source-file":"BanUserModal.tsx",children:[(0,a.jsx)(B.$,{type:"default",disabled:l,onClick:()=>s(),"data-sentry-element":"Button","data-sentry-source-file":"BanUserModal.tsx",children:"Cancel"}),(0,a.jsx)(B.$,{type:"warning",htmlType:"submit",loading:l,"data-sentry-element":"Button","data-sentry-source-file":"BanUserModal.tsx",children:"Confirm ban"})]})]})})})};var et=n(27983),en=n(51638),ea=n(7652),es=n(38531);let er="DD MMM, YYYY HH:mm",ei=(0,H.cn)("bg-surface-100 border-default text-foreground flex items-center justify-between","gap-x-4 border px-5 py-4 text-sm first:rounded-tr first:rounded-tl last:rounded-br last:rounded-bl"),eo=e=>{var t,n,r,m,f;let{user:x,onDeleteSuccess:g}=e,{ref:j}=(0,y.g)(),w=null!==x.email,_=null!==x.phone,k=null!==x.banned_until,A=null!=x.confirmed_at,{authenticationSignInProviders:C}=(0,T.x)(["authentication:sign_in_providers"]),M=(null!=(n=null==(t=x.raw_app_meta_data)?void 0:t.providers)?n:[]).map(e=>({name:e.startsWith("sso")?"SAML":e,icon:"email"===e?"".concat(P.o2,"/img/icons/email-icon2.svg"):es.FI[e]?"".concat(P.o2,"/img/icons/").concat(es.FI[e],".svg"):void 0})),{can:O}=(0,L.Qp)(s.aG.AUTH_EXECUTE,"*"),{can:R}=(0,L.Qp)(s.aG.AUTH_EXECUTE,"send_magic_link"),{can:E}=(0,L.Qp)(s.aG.AUTH_EXECUTE,"send_recovery"),{can:Q}=(0,L.Qp)(s.aG.AUTH_EXECUTE,"send_otp"),{can:q}=(0,L.Qp)(s.aG.TENANT_SQL_DELETE,"auth.users"),{can:Z}=(0,L.Qp)(s.aG.TENANT_SQL_DELETE,"auth.mfa_factors"),[$,V]=(0,p.useState)(),[X,J]=(0,p.useState)(!1),[K,eo]=(0,p.useState)(!1),[ed,eu]=(0,p.useState)(!1),[em,ef]=(0,p.useState)(!1),{data:ex}=(0,b.op)({projectRef:j}),eh=null!=(r=null==ex?void 0:ex.MAILER_OTP_EXP)?r:0,ep=Math.floor(eh/60),ev=Math.floor(eh%60),ey="".concat(eh>60?"".concat(ep," minute").concat(ep>1?"s":""," ").concat(ev>0?"and":""," "):"").concat(ev>0?"".concat(ev," second").concat(ev>1?"s":""):""),{mutate:eg,isPending:ej}=S({onSuccess:(e,t)=>{V("send_recovery"),v.oR.success("Sent password recovery to ".concat(t.user.email))},onError:e=>{v.oR.error("Failed to send password recovery: ".concat(e.message))}}),{mutate:eb,isPending:ew}=U({onSuccess:(e,t)=>{V("send_magic_link"),v.oR.success(A?"Sent magic link to ".concat(t.user.email):"Sent confirmation email to ".concat(t.user.email))},onError:e=>{v.oR.error(A?"Failed to send magic link: ".concat(e.message):"Failed to send confirmation email: ".concat(e.message))}}),{mutate:e_,isPending:ek}=D({onSuccess:(e,t)=>{V("send_otp"),v.oR.success("Sent OTP to ".concat(t.user.phone))},onError:e=>{v.oR.error("Failed to send OTP: ".concat(e.message))}}),{mutate:eN}=N({onSuccess:()=>{v.oR.success("Successfully deleted the user's factors"),ef(!1)}}),{mutate:eA,isPending:eS}=F({onSuccess:()=>{v.oR.success("Successfully unbanned user"),eo(!1)}}),eC=async()=>{if(await (0,I.wR)(200),!j)return console.error("Project ref is required");eN({projectRef:j,userId:x.id})};return(0,p.useEffect)(()=>{if(void 0!==$){let e=setTimeout(()=>V(void 0),5e3);return()=>clearTimeout(e)}},[$]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(en.x,{user:x,"data-sentry-element":"UserHeader","data-sentry-source-file":"UserOverview.tsx"}),k?(0,a.jsx)(W.Z,{type:"warning",label:"User banned until ".concat(i()(x.banned_until).format(er)),className:"border-r-0 border-l-0 rounded-none -mt-px [&_svg]:ml-0.5 mb-0"}):(0,a.jsx)(z.w,{}),(0,a.jsxs)("div",{className:(0,H.cn)("flex flex-col gap-y-1",ea.jU),children:[(0,a.jsx)(el,{property:"User UID",value:x.id,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsx)(el,{property:"Created at",value:x.created_at?i()(x.created_at).format(er):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsx)(el,{property:"Updated at",value:x.updated_at?i()(x.updated_at).format(er):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsx)(el,{property:"Invited at",value:x.invited_at,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsx)(el,{property:"Confirmation sent at",value:x.confirmation_sent_at,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsx)(el,{property:"Confirmed at",value:x.confirmed_at?i()(x.confirmed_at).format(er):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsx)(el,{property:"Last signed in",value:x.last_sign_in_at?i()(x.last_sign_in_at).format(er):void 0,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsx)(el,{property:"SSO",value:x.is_sso_user,"data-sentry-element":"RowData","data-sentry-source-file":"UserOverview.tsx"})]}),(0,a.jsxs)("div",{className:(0,H.cn)("flex flex-col !pt-0",ea.jU),children:[(0,a.jsx)("p",{children:"Provider Information"}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"The user has the following providers"})]}),(0,a.jsx)("div",{className:(0,H.cn)("flex flex-col -space-y-1 !pt-0",ea.jU),children:M.map(e=>{var t,n,s;let r=G.S5.find(t=>"key"in t&&t.key===e.name||t.title.toLowerCase()===e.name),i=Object.keys(null!=(t=null==r?void 0:r.properties)?t:{}).find(e=>e.toLowerCase().endsWith("_enabled")),l="email"===e.name?e.name.toLowerCase():null!=(n=null==r?void 0:r.title)?n:e.name,c=null!=(s=null==ex?void 0:ex[i])&&s;return(0,a.jsxs)("div",{className:(0,H.cn)(ei,"items-start justify-start"),children:[e.icon&&(0,a.jsx)("img",{width:16,src:e.icon,alt:"".concat(e.name," auth icon"),className:(0,H.cn)("mt-1.5","github"===e.name?"dark:invert":"")}),(0,a.jsxs)("div",{className:"flex-grow mt-0.5",children:[(0,a.jsx)("p",{className:"capitalize",children:l}),(0,a.jsxs)("p",{className:"text-xs text-foreground-light",children:["Signed in with a ",l," account via"," ","SAML"===l?"SSO":"OAuth"]}),C&&(0,a.jsx)(B.$,{asChild:!0,type:"default",className:"mt-2",children:(0,a.jsxs)(h(),{href:"/project/".concat(j,"/auth/providers?provider=").concat("SAML"===e.name?"SAML 2.0":e.name),children:["Configure ",l," provider"]})})]}),c?(0,a.jsxs)("div",{className:"flex items-center gap-1 rounded-full border border-brand-400 bg-brand-200 py-1 px-1 text-xs text-brand",children:[(0,a.jsx)("span",{className:"rounded-full bg-brand p-0.5 text-xs text-brand-200",children:(0,a.jsx)(o.A,{strokeWidth:2,size:12})}),(0,a.jsx)("span",{className:"px-1",children:"Enabled"})]}):(0,a.jsx)("div",{className:"rounded-md border border-strong bg-surface-100 py-1 px-3 text-xs text-foreground-lighter",children:"Disabled"})]},e.name)})}),(0,a.jsx)(z.w,{"data-sentry-element":"Separator","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsxs)("div",{className:(0,H.cn)("flex flex-col -space-y-1",ea.jU),children:[w&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ec,{title:"Reset password",description:"Send a password recovery email to the user",button:{icon:(0,a.jsx)(l.A,{}),text:"Send password recovery",isLoading:ej,disabled:!E,onClick:()=>{j&&eg({projectRef:j,user:x})}},success:"send_recovery"===$?{title:"Password recovery sent",description:"The link in the email is valid for ".concat(ey)}:void 0}),(0,a.jsx)(ec,{title:A?"Send Magic Link":"Send confirmation email",description:A?"Passwordless login via email for the user":"Send a confirmation email to the user",button:{icon:(0,a.jsx)(l.A,{}),text:A?"Send magic link":"Send confirmation email",isLoading:ew,disabled:!R,onClick:()=>{j&&eb({projectRef:j,user:x})}},success:"send_magic_link"===$?{title:A?"Magic link sent":"Confirmation email sent",description:A?"The link in the email is valid for ".concat(ey):"The confirmation email has been sent to the user"}:void 0})]}),_&&(0,a.jsx)(ec,{title:"Send OTP",description:"Passwordless login via phone for the user",button:{icon:(0,a.jsx)(l.A,{}),text:"Send OTP",isLoading:ek,disabled:!Q,onClick:()=>{j&&e_({projectRef:j,user:x})}},success:"send_otp"===$?{title:"OTP sent",description:"The link in the OTP SMS is valid for ".concat(ey)}:void 0})]}),(0,a.jsx)(z.w,{"data-sentry-element":"Separator","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsxs)("div",{className:(0,H.cn)("flex flex-col",ea.jU),children:[(0,a.jsx)("p",{children:"Danger zone"}),(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Be wary of the following features as they cannot be undone."})]}),(0,a.jsxs)("div",{className:(0,H.cn)("flex flex-col -space-y-1 !pt-0",ea.jU),children:[(0,a.jsx)(ec,{title:"Remove MFA factors",description:"Removes all MFA factors associated with the user",button:{icon:(0,a.jsx)(c.A,{}),text:"Remove MFA factors",disabled:!Z,onClick:()=>ef(!0)},className:"!bg border-destructive-400","data-sentry-element":"RowAction","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsx)(ec,{title:k?"User is banned until ".concat(i()(x.banned_until).format(er)):"Ban user",description:k?"User has no access to the project until after this date":"Revoke access to the project for a set duration",button:{icon:(0,a.jsx)(d.A,{}),text:k?"Unban user":"Ban user",disabled:!O,onClick:()=>{k?eo(!0):J(!0)}},className:"!bg border-destructive-400","data-sentry-element":"RowAction","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsx)(ec,{title:"Delete user",description:"User will no longer have access to the project",button:{icon:(0,a.jsx)(u.A,{}),type:"danger",text:"Delete user",disabled:!q,onClick:()=>eu(!0)},className:"!bg border-destructive-400","data-sentry-element":"RowAction","data-sentry-source-file":"UserOverview.tsx"})]})]}),(0,a.jsx)(et.i,{visible:ed,selectedUser:x,onClose:()=>eu(!1),onDeleteSuccess:()=>{eu(!1),g()},"data-sentry-element":"DeleteUserModal","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsx)(Y.A,{visible:em,variant:"warning",title:"Confirm to remove MFA factors",confirmLabel:"Remove factors",confirmLabelLoading:"Removing",onCancel:()=>ef(!1),onConfirm:()=>eC(),alert:{base:{variant:"warning"},title:"Removing MFA factors will drop the user's authentication assurance level (AAL) to AAL1",description:"Note that this does not sign the user out"},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"UserOverview.tsx",children:(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to remove the MFA factors for the user"," ",(0,a.jsx)("span",{className:"text-foreground",children:null!=(f=null!=(m=x.email)?m:x.phone)?f:"this user"}),"?"]})}),(0,a.jsx)(ee,{visible:X,user:x,onClose:()=>J(!1),"data-sentry-element":"BanUserModal","data-sentry-source-file":"UserOverview.tsx"}),(0,a.jsx)(Y.A,{variant:"warning",visible:K,title:"Confirm to unban user",loading:eS,confirmLabel:"Unban user",confirmLabelLoading:"Unbanning",onCancel:()=>eo(!1),onConfirm:()=>void 0===j?console.error("Project ref is required"):void 0===x.id?v.oR.error("Failed to ban user: User ID not found"):void eA({projectRef:j,userId:x.id,banDuration:"none"}),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"UserOverview.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"The user will have access to your project again once unbanned. Are you sure you want to unban this user?"})})]})},el=e=>{let{property:t,value:n}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-x-2 group justify-between",children:[(0,a.jsx)("p",{className:" text-foreground-lighter text-xs",children:t}),"boolean"==typeof n?(0,a.jsx)("div",{className:"h-[26px] flex items-center justify-center min-w-[70px]",children:n?(0,a.jsx)("div",{className:"rounded-full w-4 h-4 dark:bg-white bg-black flex items-center justify-center",children:(0,a.jsx)(o.A,{size:10,className:"text-contrast",strokeWidth:4})}):(0,a.jsx)("div",{className:"rounded-full w-4 h-4 dark:bg-white bg-black flex items-center justify-center",children:(0,a.jsx)(m.A,{size:10,className:"text-contrast",strokeWidth:4})})}):(0,a.jsxs)("div",{className:"flex items-center gap-x-2 h-[26px] font-mono min-w-[40px]",children:[(0,a.jsx)("p",{className:"text-xs",children:n||"-"}),!!n&&(0,a.jsx)(j.A,{iconOnly:!0,type:"text",icon:(0,a.jsx)(f.A,{}),className:"transition opacity-0 group-hover:opacity-100 px-1",text:n})]})]}),(0,a.jsx)(z.w,{"data-sentry-element":"Separator","data-sentry-source-file":"UserOverview.tsx"})]})},ec=e=>{var t,n,s;let{title:r,description:i,button:l,success:c,className:d}=e,u=null!=(t=null==l?void 0:l.disabled)&&t;return(0,a.jsxs)("div",{className:(0,H.cn)(ei,d),"data-sentry-component":"RowAction","data-sentry-source-file":"UserOverview.tsx",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{children:c?c.title:r}),(0,a.jsx)("p",{className:"text-xs text-foreground-light",children:c?c.description:i})]}),(0,a.jsx)(g.G,{type:null!=(n=null==l?void 0:l.type)?n:"default",icon:c?(0,a.jsx)(o.A,{className:"text-brand"}):l.icon,loading:null!=(s=l.isLoading)&&s,onClick:l.onClick,disabled:u,tooltip:{content:{side:"bottom",text:u?"You need additional permissions to ".concat(l.text.toLowerCase()):void 0}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"UserOverview.tsx",children:l.text})]})}},38531:(e,t,n)=>{n.d(t,{yA:()=>R,uJ:()=>N,TW:()=>O,Mn:()=>D,FI:()=>S});var a=n(80263),s=n(53434),r=n.n(s),i=n(13031),o=n(9753),l=n(33922),c=n(24560),d=n(85039),u=n(48156),m=n(80100),f=n(111),x=n(38904),h=n(28750),p=n(76174),v=n(5448),y=n(39241),g=n(53239),j=n(21162),b=n(99779);let w=e=>{let{col:t,specificFilterColumn:n,setSortByValue:s}=e,r=(0,g.useRef)(0),[i,o]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{r.current=Number(new Date)},[i]),(0,a.jsxs)("div",{className:"flex items-center justify-between font-normal text-xs w-full","data-sentry-component":"HeaderCell","data-sentry-source-file":"UsersGridComponents.tsx",children:[(0,a.jsx)("div",{className:"flex items-center gap-x-2",children:(0,a.jsx)("p",{className:"!text-foreground",children:t.name})}),"freeform"===n&&["created_at","email","phone"].includes(t.id)&&(0,a.jsxs)(j.rI,{open:i,onOpenChange:e=>{!1===e&&Number(new Date)-r.current>100&&o(e)},children:[(0,a.jsx)(j.ty,{asChild:!0,children:(0,a.jsx)(b.$,{type:"text",icon:(0,a.jsx)(p.A,{}),className:"p-0 h-5 w-5",onClick:()=>o(!i)})}),(0,a.jsxs)(j.SQ,{className:"w-36",children:[(0,a.jsxs)(j._2,{className:"flex items-center gap-x-2",onClick:()=>{o(!1),s("".concat(t.id,":desc"))},children:[(0,a.jsx)(v.A,{size:14}),"Sort descending"]}),(0,a.jsxs)(j._2,{className:"flex items-center gap-x-2",onClick:()=>{o(!1),s("".concat(t.id,":asc"))},children:[(0,a.jsx)(y.A,{size:14}),"Sort ascending"]})]})]})]})},_="https://avatars.githubusercontent.com",k=[_,"https://lh3.googleusercontent.com"],N=e=>e.map(e=>{var t,n;let a=null!=(n=null==(t=e.raw_app_meta_data)?void 0:t.provider)?n:"",s=e.providers.map(e=>e.startsWith("sso")?"SAML":e);return{id:e.id,email:e.email,phone:e.phone,created_at:e.created_at,last_sign_in_at:e.last_sign_in_at,providers:e.is_anonymous?"-":s,provider_icons:s.map(e=>"email"===e?"".concat(d.o2,"/img/icons/email-icon2.svg"):"SAML"===e?"".concat(d.o2,"/img/icons/saml-icon.svg"):S[e]?"".concat(d.o2,"/img/icons/").concat(S[e],".svg"):void 0).filter(Boolean),provider_type:e.is_anonymous?"Anonymous":"email"===a?"-":C.includes(a)?"Social":U.includes(a)?"Phone":"-",img:O(e),name:D(e)}}),A={social:[{email:"email-icon2"},{apple:"apple-icon"},{azure:"microsoft-icon"},{bitbucket:"bitbucket-icon"},{discord:"discord-icon"},{facebook:"facebook-icon"},{figma:"figma-icon"},{github:"github-icon"},{gitlab:"gitlab-icon"},{google:"google-icon"},{kakao:"kakao-icon"},{keycloak:"keycloak-icon"},{linkedin_oidc:"linkedin-icon"},{notion:"notion-icon"},{twitch:"twitch-icon"},{twitter:"twitter-icon"},{slack_oidc:"slack-icon"},{slack:"slack-icon"},{spotify:"spotify-icon"},{workos:"workos-icon"},{zoom:"zoom-icon"}],phone:[{twilio:"twilio-icon"},{messagebird:"messagebird-icon"},{textlocal:"messagebird-icon"},{vonage:"messagebird-icon"},{twilioverify:"twilio-verify-icon"}]},S=Object.values([...A.social,...A.phone]).reduce((e,t)=>{let[[n,a]]=Object.entries(t);return{...e,[n]:a}},{}),C=A.social.map(e=>{let[t]=Object.keys(e);return t}),U=A.phone.map(e=>{let[t]=Object.keys(e);return t});function M(e){if(e){if("string"==typeof e)return e;if(Array.isArray(e))return e.map(e=>M(e)).join(" ");try{return JSON.stringify(e)}catch(e){}}}function D(e){var t;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",{custom_claims:a,displayName:s,display_name:r,fullName:i,full_name:o,familyName:l,family_name:c,givenName:d,given_name:u,surname:m,lastName:f,last_name:x,firstName:h,first_name:p}=null!=(t=e.raw_user_meta_data)?t:{},{displayName:v,display_name:y,fullName:g,full_name:j,familyName:b,family_name:w,givenName:_,given_name:k,surname:N,lastName:A,last_name:S,firstName:C,first_name:U}=null!=a?a:{},D=M(l||c||m||f||x||b||w||N||A||S),O=M(d||u||h||p||_||k||C||U);return M(s||r||v||y||i||o||g||j||O&&D&&"".concat(O," ").concat(D)||D||O)||n}function O(e){var t;let{avatarUrl:n,avatarURL:a,avatar_url:s,profileUrl:r,profileURL:i,profile_url:o,profileImage:l,profile_image:c,profileImageUrl:d,profileImageURL:u,profile_image_url:m}=null!=(t=e.raw_user_meta_data)?t:{},f=n||a||s||l||c||r||i||o||d||u||m||"";if("string"!=typeof f)return;let x=k.some(e=>f.startsWith(e));try{let e=new URL(f);return e.searchParams.set("s","24"),x?f.startsWith(_)?e.href:f:void 0}catch(e){return x?f:void 0}}let R=e=>{var t;let{specificFilterColumn:n,columns:s,config:d,users:p,visibleColumns:v=[],setSortByValue:y,onSelectDeleteUser:g}=e,j=null!=(t=d.map(e=>e.id))?t:s.map(e=>e.id),b=s.map(e=>{var t,s,v;let j=d.find(t=>t.id===e.id);return{key:e.id,name:e.name,resizable:null==(t=e.resizable)||t,sortable:!1,draggable:!0,width:null!=(s=null==j?void 0:j.width)?s:e.width,minWidth:null!=(v=e.minWidth)?v:120,headerCellClass:"z-50 outline-none !shadow-none",renderHeaderCell:()=>{if("img"!==e.id)return(0,a.jsx)(w,{col:e,specificFilterColumn:n,setSortByValue:y})},renderCell:t=>{let{row:n}=t,[s,d]=(0,c.Uk)(),v=null==n?void 0:n[e.id],y=null==p?void 0:p.find(e=>e.id===n.id),j=null!==v&&["created_at","last_sign_in_at"].includes(e.id)?r()(v).format("ddd DD MMM YYYY HH:mm:ss [GMT]ZZ"):Array.isArray(v)?"providers"===e.id?v.map(e=>{let t=h.S5.find(t=>"key"in t&&t.key===e||t.title.toLowerCase()===e);return null==t?void 0:t.title}).join(", "):v.join(", "):v,b=!!(null==y?void 0:y.confirmed_at);return"img"===e.id?(0,a.jsxs)("div",{className:"flex items-center justify-center gap-x-2",children:[(0,a.jsx)(u.S,{checked:s,onClick:e=>{e.stopPropagation(),d({row:n,type:"ROW",checked:!s,isShiftClick:e.shiftKey})}}),(0,a.jsx)("div",{className:(0,m.cn)("flex items-center justify-center w-6 h-6 rounded-full bg-center bg-cover bg-no-repeat",n.img?"border":"bg-selection"),style:{backgroundImage:n.img?"url('".concat(n.img,"')"):"none"},children:!n.img&&(0,a.jsx)(i.A,{size:12})})]}):(0,a.jsxs)(f.tz,{children:[(0,a.jsx)(f.Rc,{asChild:!0,children:(0,a.jsxs)("div",{className:(0,m.cn)("w-full flex items-center text-xs",e.id.includes("provider")?"capitalize":""),children:["providers"===e.id&&n.provider_icons.map((e,t)=>{let s=n.providers[t];return(0,a.jsx)("div",{className:"min-w-6 min-h-6 rounded-full border flex items-center justify-center bg-surface-75",style:{marginLeft:0===t?0:"-8px",zIndex:n.provider_icons.length-t},children:(0,a.jsx)("img",{width:16,src:e,alt:"".concat(s," auth icon"),className:(0,m.cn)("github"===s&&"dark:invert")},"".concat(null==y?void 0:y.id,"-").concat(s))})}),"last_sign_in_at"!==e.id||b?(0,a.jsx)("p",{className:(0,m.cn)("providers"===e.id&&"ml-1"),children:null===j?"-":j}):(0,a.jsx)("p",{className:"text-foreground-lighter",children:"Waiting for verification"})]})}),(0,a.jsxs)(f.Ip,{onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)(f.kt,{className:"gap-x-2",onFocusCapture:e=>e.stopPropagation(),onSelect:()=>{let t="providers"===e.id?n.providers.join(", "):j;(0,x.l)(t)},children:[(0,a.jsx)(o.A,{size:12}),(0,a.jsxs)("span",{children:["Copy ","id"===e.id?e.name:e.name.toLowerCase()]})]}),(0,a.jsx)(f.K5,{}),(0,a.jsxs)(f.kt,{className:"gap-x-2",onFocusCapture:e=>e.stopPropagation(),onSelect:()=>{y&&g(y)},children:[(0,a.jsx)(l.A,{size:12}),(0,a.jsx)("span",{children:"Delete user"})]})]})]})}}}),_=b.find(e=>"img"===e.key);return j.length>0&&(b=b.filter(e=>j.includes(e.key)).sort((e,t)=>j.indexOf(e.key)-j.indexOf(t.key))),0===v.length?b:[_].concat(b.filter(e=>v.includes(e.key)))}},39241:(e,t,n)=>{n.d(t,{A:()=>a});let a=(0,n(86848).A)("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]])},41645:(e,t,n)=>{n.d(t,{$:()=>r});var a=n(80263),s=n(80100);let r=e=>{let{loading:t}=e;return(0,a.jsx)("div",{className:"relative overflow-hidden w-full h-px bg-border m-auto","data-sentry-component":"LoadingLine","data-sentry-source-file":"LoadingLine.tsx",children:(0,a.jsx)("span",{className:(0,s.cn)("absolute w-[80px] h-px ml-auto mr-auto left-0 right-0 text-center block top-0","transition-all","line-loading-bg-light dark:line-loading-bg",t&&"animate-line-loading-slower opacity-100",t?"opacity-100":"opacity-0")})})}},51638:(e,t,n)=>{n.d(t,{x:()=>c});var a=n(80263),s=n(9753),r=n(27519),i=n(80100),o=n(7652),l=n(38531);let c=e=>{var t,n,c;let{user:d}=e,u=(0,l.Mn)(d),m="-"!==u,f=null!==d.phone,x=d.is_anonymous;return(0,a.jsx)("div",{className:(0,i.cn)(o.jU),"data-sentry-component":"UserHeader","data-sentry-source-file":"UserHeader.tsx",children:f?(0,a.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,a.jsx)("p",{children:d.phone}),(0,a.jsx)(r.A,{iconOnly:!0,type:"text",icon:(0,a.jsx)(s.A,{}),className:"px-1",text:null!=(t=null==d?void 0:d.phone)?t:""})]}):x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{children:"Anonymous user"}),(0,a.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,a.jsx)("p",{className:"text-foreground-light text-sm",children:d.id}),(0,a.jsx)(r.A,{iconOnly:!0,type:"text",icon:(0,a.jsx)(s.A,{}),className:"px-1",text:null!=(n=null==d?void 0:d.id)?n:""})]})]}):(0,a.jsxs)(a.Fragment,{children:[m&&(0,a.jsx)("p",{children:u}),(0,a.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,a.jsx)("p",{className:(0,i.cn)(m?"text-foreground-light text-sm":"text-foreground"),children:d.email}),(0,a.jsx)(r.A,{iconOnly:!0,type:"text",icon:(0,a.jsx)(s.A,{}),className:"px-1",text:null!=(c=null==d?void 0:d.email)?c:""})]})]})})}},52520:(e,t,n)=>{n.d(t,{X:()=>c});var a=n(51355),s=n(80210),r=n(73969),i=n(24523),o=n(31907);async function l(e){let{projectRef:t,userId:n}=e,{data:a,error:s}=await (0,i.yH)("/platform/auth/{ref}/users/{id}",{params:{path:{ref:t,id:n}}});return s&&(0,i.H4)(s),a}let c=function(){let{onSuccess:e,onError:t,...n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.jE)();return(0,s.n)({mutationFn:e=>l(e),async onSuccess(t,n,a){let{projectRef:s,skipInvalidation:r=!1}=n;r||await Promise.all([i.invalidateQueries({queryKey:o.Z.usersInfinite(s)})]),await (null==e?void 0:e(t,n,a))},async onError(e,n,a){void 0===t?r.oR.error("Failed to delete user: ".concat(e.message)):t(e,n,a)},...n})}},77869:(e,t,n)=>{n.d(t,{A:()=>a});let a=(0,n(86848).A)("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]])}}]);